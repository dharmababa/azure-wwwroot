!function(){var e={},t={};window.require=function(n){if(!t[n]){var i={},r={},o=e[n];t[n]={},o(i,r),t[n]=i.exports||r}return t[n]},window.require.define=function(t,n){e[t]=n}}(),require.define("blend/features",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L=[].slice;b=window,u=document.createElement("div"),l=function(e,t){return null==t&&(t=u),void 0!==t.style[e]?e:void 0},t.test=function(){return l(prop)},t.touch="ontouchstart"in window,t.pointer=navigator.pointerEnabled||navigator.msPointerEnabled,t.ie=/Trident/i.test(navigator.userAgent),t.webkit=/WebKit/i.test(navigator.userAgent),t.moz=/Firefox/i.test(navigator.userAgent),t.safari=/Safari/i.test(navigator.userAgent),t.chrome=/Chrome/i.test(navigator.userAgent),t.android=/Android/i.test(navigator.userAgent),t.iphone=/iP(hone|od)/i.test(navigator.userAgent),v="",t.ie&&(v="ie"),t.moz&&(v="moz"),t.safari&&(v="safari"),t.chrome&&(v="chrome"),t.android&&(v="android"),t.iphone&&(v="iphone"),t.ua=v,"onmspointerdown"in window?(t.pointerDown="MSPointerDown",t.pointerMove="MSPointerMove",t.pointerUp="MSPointerUp"):navigator.pointerEnabled&&(t.pointerDown="pointerdown",t.pointerMove="pointermove",t.pointerUp="pointerup"),d=l("webkitTransform"),null==d&&(d=l("mozTransform")),null==d&&(d=l("msTransform")),null==d&&(d=l("transform")),t.transform=d,o=l("webkitPerspective"),null==o&&(o=l("mozPerspective")),null==o&&(o=l("msPerspective")),null==o&&(o=l("perspective")),t.perspective=o,f=l("WebkitTransition")?"webkitTransitionEnd":void 0,null==f&&(f=l("MozTransition")?"transitionend":void 0),null==f&&(f=l("transition")?"transitionend":void 0),t.transitionEnd=f,t.transitions=void 0!==f,g=l("webkitTransitionProperty"),null==g&&(g=l("mozTransitionProperty")),null==g&&(g=l("msTransitionProperty")),null==g&&(g=l("transitionProperty")),t.transitionProperty=g,h=l("webkitTransitionDuration"),null==h&&(h=l("mozTransitionDuration")),null==h&&(h=l("msTransitionDuration")),null==h&&(h=l("transitionDuration")),t.transitionDuration=h,p=l("webkitTransitionDelay"),null==p&&(p=l("mozTransitionDelay")),null==p&&(p=l("msTransitionDelay")),null==p&&(p=l("transitionDelay")),t.transitionDelay=p,m=l("webkitTransitionTimingFunction"),null==m&&(m=l("mozTransitionTimingFunction")),null==m&&(m=l("msTransitionTimingFunction")),null==m&&(m=l("transitionTimingFunction")),t.transitionTimingFunction=m,c=l("webkitTransition"),null==c&&(c=l("mozTransition")),null==c&&(c=l("msTransition")),null==c&&(c=l("transition")),t.transition=c,n=l("webkitAnimation"),null==n&&(n=l("mozAnimation")),null==n&&(n=l("animation")),i=l("WebkitAnimation")?"webkitAnimationEnd":void 0,null==i&&(i=l("MozAnimation")?"animationend":void 0),null==i&&(i=l("animation")?"animationend":void 0),t.animation=n,t.animationEnd=i,t.animations=void 0!==n,r=l("WebkitAnimation")?"-webkit-keyframes":void 0,null==r&&(r=l("MozAnimation")?"-moz-keyframes":void 0),null==r&&(r=l("animation")?"keyframes":void 0),t.keyframesCSS=r,t.forceAnimSetupLayout=t.ie||t.moz,y=l("webkitUserSelect"),null==y&&(y=l("mozUserSelect")),null==y&&(y=l("msUserSelect")),null==y&&(y=l("userSelect")),t.userSelect=y,t.jsToCss=function(e){var t,n,i,r;for(t="",n=i=0,r=e.length;r>=0?r>i:i>r;n=r>=0?++i:--i)t+=e[n]===e[n].toUpperCase()?"-"+e[n].toLowerCase():e[n];return t=t.replace(/^webkit\-/,"-webkit-"),t=t.replace(/^moz\-/,"-moz-"),t=t.replace(/^ms\-/,"-ms-")},t.cssToJs=function(e){var t;return t="","-"===e[0]&&(e=e.substr(1)),t=e.replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},null==(w=(x=Function.prototype).bind)&&(x.bind=function(){var e,t,n=this;return e=arguments[0],t=2<=arguments.length?L.call(arguments,1):[],null==e&&(e=this),function(){var i;return i=1<=arguments.length?L.call(arguments,0):[],n.apply(e,t.concat(i))}}),a=0,s=null,null==(_=b.requestAnimationFrame)&&(b.requestAnimationFrame=b.webkitRequestAnimationFrame),null==(q=b.requestAnimationFrame)&&(b.requestAnimationFrame=b.mozRequestAnimationFrame),null==(I=b.requestAnimationFrame)&&(b.requestAnimationFrame=function(e){var t,n;return t=Date.now(),n=Math.max(0,1e3/60-(t-a)),s=setTimeout(function(){return e(t+n)},n),a=t+n,s}),null==(k=b.cancelAnimationFrame)&&(b.cancelAnimationFrame=b.webkitCancelAnimationFrame),null==(P=b.cancelAnimationFrame)&&(b.cancelAnimationFrame=b.mozCancelAnimationFrame),null==(C=b.cancelAnimationFrame)&&(b.cancelAnimationFrame=function(e){return clearTimeout(e)}),null==(S=console.error)&&(console.error=function(){return console.log.apply(console,arguments)}),null==(E=console.debug)&&(console.debug=function(){return console.log.apply(console,arguments)}),null==(N=console.profile)&&(console.profile=function(){}),null==(T=console.profileEnd)&&(console.profileEnd=function(){})}),require.define("blend/dom",function(e,t){var n,i,r,o=[].slice;i=require("blend/features"),n=document,t.create=function(e){var n;return n=document.createElement("div"),t.setInnerHTML(n,e),1===n.children.length?n.children[0]:n},t.one=function(e,t){return null==t&&(t=n),"object"==typeof e?e:t.querySelector(e)},t.all=function(e,t){return null==t&&(t=n),Array.prototype.slice.apply(t.querySelectorAll(e))},t.createCSSRule=function(e){var t,n,i,r;return n=document.styleSheets[document.styleSheets.length-1],null==n.cssRules&&(r=document.createElement("style"),document.head.appendChild(r),n=document.styleSheets[document.styleSheets.length-1]),n.insertRule(e,n.cssRules.length),i=n.cssRules[n.cssRules.length-1],t=function(){var e,t,r;for(e=t=r=n.cssRules.length-1;t>=0;e=t+=-1)if(n.cssRules[e]===i)return n.deleteRule(e),void 0},{rule:i,destroy:t}},t.setInnerHTML=function(e,t){return"undefined"!=typeof toStaticHTML&&(t=toStaticHTML(t)),null!=e?e.innerHTML=t:void 0},t.ancestor=function(e,i){return i(e)?e:e===n.body?void 0:e?t.ancestor(e.parentNode,i):void 0},t.ancestorByClassName=function(e,n){var i;return i=function(e){return e.classList.contains(n)},t.ancestor(e,i)},t.ancestorByTagName=function(e,n){var i;return i=function(e){var t;return(null!=e?null!=(t=e.tagName)?t.toLowerCase():void 0:void 0)===n.toLowerCase()},t.ancestor(e,i)},t.append=function(e,t){return null==t&&(t=n.body),e=r(e),t.appendChild(e)},t.prepend=function(e,t){return null==t&&(t=n.body),e=r(e),null!=t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},t.remove=function(e){var t;return e=r(e),null!=e?null!=(t=e.parentNode)?t.removeChild(e):void 0:void 0},r=function(e){return"string"==typeof e?t.one(e):e},"classList"in document.documentElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){var e,t,n=this;return e=function(){return n.className.split(/\s+/)},t={add:function(){var t,i,r,s,a;for(i=1<=arguments.length?o.call(arguments,0):[],r=e(),s=0,a=i.length;a>s;s++)t=i[s],n.classList.contains(t)||r.push(t);return n.className=r.join(" ")},remove:function(t){return n.className=e().filter(function(e){return e!==t}).join(" ")},toggle:function(e){return n.classList.contains(e)?n.classList.add(e):n.classList.remove(e)},contains:function(t){return-1!==e().indexOf(t)},item:function(t){var n;return n=e(),n.length>t?n[t]:null}},Object.defineProperty(t,"length",{get:function(){return e().length}}),t}}),t.parseDataNode=function(e){var n,i,r;return i=t.one("#"+e),(null!=i?i.innerHTML:void 0)?(n=null!=(r=i.innerText)?r:i.innerHTML,JSON.parse(n)):{}},t.setTextSelectable=function(e,t){return t?(e.style[i.userSelect]="",e.onselectstart=""):(e.style[i.userSelect]="none",e.onselectstart="return false;")}}),require.define("blend/lang",function(e,t){t.mixin=function(e,t){var n,i,r,o;for(n in t)i=t[n],e[n]=i;r=t.prototype,o=[];for(n in r)i=r[n],e.prototype?o.push(e.prototype[n]=i):o.push(e[n]=i);return o},t.deepCopy=function(e){var t,n;t=void 0;try{t=JSON.parse(JSON.stringify(e))}catch(i){n=i,console.log("Error parsing object",e)}return t},t.merge=function(e,t){var n,i;if("object"==typeof e&&"object"==typeof t){for(n in t)i=t[n],t.hasOwnProperty(n)&&(void 0===e[n]||null===e[n])&&(e[n]=i);return e}},t.arrayCopy=function(e){return Array.prototype.slice.apply(e)},t.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},t.throttled=function(e,t){var n,i;return i=null,n=function(){return i&&clearTimeout(i),i=setTimeout(e,t)}},t.htmlEncode=function(e){var t;return e?(t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},e.toString().replace(/[&<>"'\/]/g,function(e){return t[e]||""})):e}}),require.define("blend/events",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m;c=require("blend/lang"),n=function(){function e(){}return e.prototype.handles=null,e.prototype.on=function(e,t,n){var i,r,o,s,a=this;return null==n&&(n=t),null==(o=this.handles)&&(this.handles={}),null==(s=(r=this.handles)[e])&&(r[e]=[]),this.handles[e].push({handle:t,scope:n}),i={detach:function(){return a.off(e,t,n)}}},e.prototype.off=function(e,t,n){var i,r,o,s,a,l,u,d;if("*"===e)return this.handles={},void 0;for(null==n&&(n=t),null==(a=this.handles)&&(this.handles={}),u=null!=(l=this.handles[e])?l:[],d=[],r=o=0,s=u.length;s>o;r=++o){if(i=u[r],i.handle===t&&i.scope===n){this.handles[e].splice(r,1);break}d.push(void 0)}return d},e.prototype.once=function(e,t,n){var i,r,o=this;return null==n&&(n=t),null==(r=this.handles)&&(this.handles={}),i=function(r){return t(r),o.off(e,i,n)},this.on(e,i,n)},e.prototype.emit=function(e,t){var n,i,r,o,s,a,l,u,d,p,h,f,g;for(null==t&&(t={}),null==(l=t.target)&&(t.target=this),n=!1,o=!1,null==(u=t.preventDefault)&&(t.preventDefault=function(){return n=!0}),null==(d=t.stopPropagation)&&(t.stopPropagation=function(){return o=!0}),null==(p=t.halted)&&(t.halted=function(){return n}),r=c.arrayCopy(null!=(h=null!=(f=this.handles)?f[e]:void 0)?h:[]),r=r.reverse(),g=[],s=0,a=r.length;a>s;s++)i=r[s],o?g.push(void 0):g.push(i.handle.call(i.scope,t));return g},e}(),i=function(e,t,n,i){var r;return null==i&&(i=!1),"string"==typeof e&&(e=document.querySelector(e)),s[t]?(s[t][0](e,t,n,i),r=function(){return s[t][1](e,t,n,i)}):(null!=e&&e.addEventListener(t,n,i),r=function(){return e.removeEventListener(t,n,i)}),{detach:r}},u=function(e,t,n,i){return null==i&&(i=!1),"string"==typeof e&&(e=document.querySelector(e)),e.removeEventListener(t,n,i)},r=function(e,t,n,r){var o,s;return null==r&&(r=!1),"string"==typeof e&&(e=document.querySelector(e)),s=function(e){return n(e),o.detach()},o=i(e,t,s,r)},l=[],d=function(e,t){var n,i,r;for(i=0,r=l.length;r>i;i++)if(n=l[i],n.node===e&&n.type===t)return n;return void 0},a=function(e,t,n,r){var o,s,a,u;return"string"==typeof e&&(e=document.querySelector(e)),s=document.documentElement,o=d(s,n),o||(o={node:s,type:n,handles:{},event:void 0},l.push(o),a=function(t){var n,i,r,s,a,l,u,d;for(n=t.target,l=!1,d=[];n&&e.contains(n)&&!l;){u=o.handles;for(s in u)i=u[s],"function"==typeof i&&p.call(n,s)&&(a=t.stopPropagation,t.stopPropagation=function(){return l=!0,a.call(t)},t.relatedTarget=n,r=i(t),l||(l=r===!1));if(l)break;d.push(n=n.parentNode)}return d},o.event=i(s,n,a,!0)),o.handles[t]=r,u={detach:function(){var e;return delete o.handles[t],0===Object.keys(o.handles).length?(o.event.detach(),e=l.indexOf(o),l.splice(e,1)):void 0}}},p=null!=(f=null!=(g=null!=(m=Element.prototype.matches)?m:Element.prototype.webkitMatchesSelector)?g:Element.prototype.mozMatchesSelector)?f:Element.prototype.msMatchesSelector,s={},o=function(e,t){var n,i,r;null==t&&(t={}),n=void 0,"click"===e?(n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null)):(n=document.createEvent("Event"),n.initEvent(e,!0,!0,window));for(i in t)r=t[i],n[i]=r;return n},h=function(e,t,n){return s[e]&&console.warn("Overwriting existing "+e+" event registration."),s[e]=[t,n]},t.Emitter=n,t.on=i,t.off=u,t.once=r,t.delegate=a,t.create=o,t.register=h}),require.define("blend/tick",function(e){var t,n,i,r;i=function(e){return setTimeout(e,0)},"function"==typeof("undefined"!=typeof process&&null!==process?process.nextTick:void 0)?n=process.nextTick:"function"==typeof setImmediate?n=setImmediate:"function"==typeof MessageChannel?(r=[],t=new MessageChannel,t.port1.onmessage=function(){var e,t;for(t=null,e=0;t=r[e++];)t();return r=[]},n=function(e){return r.push(e),t.port2.postMessage()}):n=i,e.exports=n}),require.define("blend/async",function(e,t){var n,i,r,o,s,a,l;s=require("blend/tick"),i=function(){var e,t,r,o,a,l,u;return u=null,o=[],t=[],l="pending",e=function(e,n){var i;if(void 0!==o)return i=o,o=void 0,u=e,l=n?"rejected":"fulfilled",s(function(){var e,n,r;for(n=0,r=i.length;r>n;n++)e=i[n],e();return t=void 0})},r=function(e){return void 0!==o&&void 0!==t?s(function(){var n,i,r,o;for(o=[],i=0,r=t.length;r>i;i++)n=t[i],o.push(n(e));return o}):void 0},a=function(e){return void 0!==t&&"function"==typeof e?t.push(e):void 0},{resolve:function(t){return e(t,!1)},reject:function(t){return e(t,!0)},notify:function(e){return r(e)},promise:{then:function(e,t,r){var d,c;return d=i(),c=function(){var i,r,o,s,a;if(s="rejected"===l,i=s?t:e,"function"!=typeof i)return s?d.reject(u):d.resolve(u);o=void 0;try{return a=i.call(void 0,u)}catch(c){return r=c,o=r,d.reject(o)}finally{void 0===o&&n(d,a)}},a(r),void 0===o?s(c):o.push(c),d.promise},progress:function(e){return a(e),this}}}},n=function(e,t){var i,s,a,l,u,d;if(o(t))return t.then(function(t){return e.resolve(t)},function(t){return e.reject(t)});if(!r(t))return e.resolve(t);i=void 0,a=void 0;try{return i=t.then}catch(c){return s=c,a=s,e.reject(a)}finally{if(!a)if("function"==typeof i){d=!1,u=function(t){return d?void 0:(d=!0,n(e,t))},l=function(t){return d?void 0:(d=!0,e.reject(t))};try{i.call(t,u,l)}catch(c){s=c,d||e.reject(s)}}else e.resolve(t)}},l=function(e){var t,n;return n=i(),l=n.resolve,t=n.promise,l(e),t},a=function(e){var t,n;return n=i(),a=n.reject,t=n.promise,a(e),t},r=function(e){return"function"==typeof e||"object"==typeof e&&null!==e},o=function(e){return"function"==typeof(null!=e?e.then:void 0)},t.defer=i,t.resolve=l,t.reject=a}),require.define("blend/i18n",function(e,t){var n,i,r=[].slice;n=require("blend/dom"),i={},t.load=function(){return i=n.parseDataNode("i18n-data")},t.t=function(){var e,t,n,o,s,a;return e=1<=arguments.length?r.call(arguments,0):[],o=e.shift(),o=null!=(s=i[o])?s:o,0===e.length?o:("object"==typeof o&&(n=parseInt(e[0]),o=1===n?null!=(a=o.one)?a:o.other:o.other),t=0,o.replace(/%[ds0-9]/g,function(){return t<e.length?e[t++]:""}))},t.n=function(e,n,i){return 1===i?t.t(e,i):t.t(n,i)}}),require.define("blend/http",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x;n=require("blend/async"),p=require("blend/lang"),o=null,s={},l=function(e){return y("GET",e)},v=function(e){return y("POST",e)},y=function(e,t){var i,o,s,l,u,d,c,g;i=n.defer(),t=a(t),u={},d=m(t),g=new XMLHttpRequest;try{g.open(e,d.href,!0),s=t.headers,s=p.merge(s,r(d));for(l in s)c=s[l],g.setRequestHeader(l,c);g.onreadystatechange=function(){return 4===g.readyState?h(t,g,i):3===g.readyState&&t.streaming?f(t,g,u,i):void 0},"POST"===e?g.send(JSON.stringify(t.params)):g.send()}catch(v){o=v,i.reject(o)}return i.promise},g=function(e){var t;return t={},null!=e&&e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,i){return t[n]=i}),t},x=function(e){var t,n,i,r,o,s,a;null==e&&(e={}),i="",n=0;for(t in e)for(o=e[t],o=Array.isArray(o)?o:[o],s=0,a=o.length;a>s;s++){switch(r=o[s],r=encodeURIComponent(r),n){case 0:i+="?"+t+"="+r;break;default:i+="&"+t+"="+r}n++}return i},c=["host","hostname","port","protocol","search","pathname","href"],i=function(e,t){var n,i;return i=""+e+":"+t,n=window.btoa(i),"Basic "+n},a=function(e){var t,n,i,r,o,s;return null==e&&(e={}),null==(n=e.path)&&(e.path="/"),null==(i=e.params)&&(e.params={}),null==(r=e.headers)&&(e.headers={}),null==(o=e.streaming)&&(e.streaming=!1),"undefined"==typeof(null!=(s=e.params)?s.lang:void 0)&&("undefined"!=typeof window&&null!==window?window.location:void 0)&&(t=g(window.location.search).lang,t&&(e.params.lang=t)),e},r=function(e){var t;return t={},e.host===window.location.host&&(t["X-Requested-With"]="XMLHttpRequest"),e.host===(null!=o?o.host:void 0)&&null!=(null!=s?s.user:void 0)&&null!=(null!=s?s.password:void 0)&&(t.Authorization=i(s.user,s.password)),t},u=function(e){var t,n,i,r;n={},t=document.createElement("a"),t.href=e;for(i in t)r=t[i],c.indexOf(i)>-1&&(n[i]=r);return n},m=function(e){var t,n,i,r,s,a,l,d;return n=null!=o?o:window.location,t="string"==typeof e?e:e.url,(null!=t?t.length:void 0)>0?i=u(t):(i={},i.host=null!=(r=e.host)?r:n.host,i.hostname=null!=(s=e.hostname)?s:n.hostname,i.port=null!=(a=e.port)?a:n.port,i.protocol=null!=(l=e.protocol)?l:n.protocol,i.search=x(e.params),i.pathname=null!=(d=e.path)?d:"/","/"!==i.pathname[0]&&(i.pathname="/"+i.pathname),i.href=""+i.protocol+"//"+i.host+i.pathname+i.search),i},b=function(e,t){return null==t&&(t={}),(null!=e?e.length:void 0)>0?(o=u(e),s=t):void 0},h=function(e,t,n){var i,r;if(200===t.status){if(r=t.responseText,d(t))try{r=JSON.parse(r)}catch(o){i=o,n.reject(i)}return n.resolve(r)}return n.reject(t.status)},f=function(e,t,n,i){var r,o,s,a,l,u;for(null==(a=n.currentPosition)&&(n.currentPosition=0),null==(l=n.buffer)&&(n.buffer=""),n.buffer=t.responseText.substr(n.currentPosition),s=n.buffer.indexOf("\n"),u=[];-1!==s;){o=n.buffer.slice(0,s),n.currentPosition+=s+1;try{o=JSON.parse(o)}catch(d){r=d,i.reject(r)}i.notify(o),n.buffer=t.responseText.substr(n.currentPosition),u.push(s=n.buffer.indexOf("\n"))}return u},d=function(e){var t;return t=e.getResponseHeader("Content-Type"),/application\/json/.test(t)},t.get=l,t.post=v,t.parseQuery=g,t.stringifyQuery=x,t.setDefaultLocation=b}),require.define("ui/lightBox",function(e){var t,n,i,r,o,s=function(e,t){return function(){return e.apply(t,arguments)}};n=require("blend/dom"),i=require("blend/events"),o=require("blend/lang"),r=require("blend/features"),t=function(){function e(e,t){var i,r,a,l;if(this.contentNode=e,null==t&&(t={}),this.close=s(this.close,this),"string"==typeof e&&(e=n.one(e)),!e)return console.warn("node doesn't exist."),void 0;for(a=this.contentNode;(a=a.previousSibling)&&1!==a.nodeType;);this.contentNodeStates={parentNode:this.contentNode.parentNode,previousSibling:a,cssText:this.contentNode.style.cssText,loadingAnimation:!1},i={overlayAlpha:.5,isIFrame:!1,autoCenter:!0,tapable:!0,overlayAnimation:!0,hostNode:document.body},o.merge(t,i);for(r in t)l=t[r],this[r]=l;"iframe"===this.contentNode.tagName.toLowerCase()&&(this.isIFrame=!0),this.handles=[],this.cssRules=[],this.init()}return e.prototype.showLoading=function(){},e.prototype.show=function(){return this.positionContentNode()},e.prototype.init=function(){return this.autoCenter&&(this.contentNode.style.display="none"),this.createCSSRules(),this.createOverlay(),this.positionContentNode(),this.isIFrame&&this.setupCrossFrameMessaging(),this.autoCenter&&this.handles.push(i.on(window,"resize",o.throttled(this.positionContentNode.bind(this),100))),this.emit("lightbox:opened")},e.prototype.positionContentNode=function(){var e,t,n;if(this.autoCenter)return this.contentNode.style.display="block",this.contentNode.style.visibility="hidden",n=this.contentNode.getBoundingClientRect(),t=n.width,e=n.height,this.contentNode.style.display="none",this.contentNode.style.removeProperty("visibility"),this.contentNode.style.position="absolute",this.contentNode.style.top=Math.max(window.innerHeight/2-e/2,0)+"px",this.contentNode.style.left=Math.max(window.innerWidth/2-t/2,0)+"px",this.contentNode.style.display="block"},e.prototype.createCSSRules=function(){var e;return e=".lightbox-overlay {\n    position: absolute;\n    opacity: "+(this.overlayAnimation?0:1)+";\n    top:0;\n    left:0;\n    width: 100%;\n    height: 100%;\n    background-color:rgba(0, 0, 0, "+this.overlayAlpha+");\n    -webkit-transition: opacity 0.4s ease-out;\n       -moz-transition: opacity 0.4s ease-out;\n        -ms-transition: opacity 0.4s ease-out;\n            transition: opacity 0.4s ease-out;\n}",this.cssRules.push(n.createCSSRule(e)),e=".lightbox-wrapper {\n    position: fixed;\n    z-index: 10000;\n    top:0;\n    left:0;\n    width: 100%;\n    height: 100%;\n}",this.cssRules.push(n.createCSSRule(e))},e.prototype.createOverlay=function(){var e=this;return this.lightbox=n.create('<div class="lightbox-wrapper"></div>'),this.overlay=n.create('<div class="lightbox-overlay"></div>'),this.lightbox.appendChild(this.overlay),this.lightbox.appendChild(this.contentNode),this.hostNode.appendChild(this.lightbox),this.overlayAnimation&&setTimeout(function(){return e.overlay.style.opacity=1},0),this.tapable?this.handles.push(i.on(this.overlay,"tap",function(){return e.close()})):void 0},e.prototype.freeze=function(){return this.detach()},e.prototype.setupCrossFrameMessaging=function(){var e;return e=function(e){var t;switch(t=e.data.split("-"),t[0]){case"close":return this.close()}},this.handles.push(i.on(window,"message",e.bind(this)))},e.prototype.detach=function(){var e,t,n,i,r;for(i=this.handles,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(e.detach());return r},e.prototype.close=function(){var e,t,i,r;for(r=this.cssRules,t=0,i=r.length;i>t;t++)e=r[t],e.destroy();return this.detach(),this.contentNodeStates.previousSibling?this.contentNodeStates.previousSibling.parentNode.insertBefore(this.contentNode,this.contentNodeStates.previousSibling.nextSibling):this.contentNodeStates.parentNode&&this.contentNodeStates.parentNode.appendChild(this.contentNode),this.contentNode.style.cssText=this.contentNodeStates.cssText,this.contentNode.style.display=this.contentNodeStates.display,n.remove(this.lightbox),this.lightbox=null,this.emit("lightbox:closed")},e}(),o.mixin(t,i.Emitter),e.exports=t}),require.define("ui/message",function(e){var t,n;n=require("blend/dom"),t=function(){function e(e){var t,i,r,o;null==e&&(e={}),null==(t=e.showSpinny)&&(e.showSpinny=!1),null==(i=e.showText)&&(e.showText=!0),null==(r=e.text)&&(e.text=""),this.node=n.create('<div class="fl-modal-loading">\n    <div class="fl-modal-loading-inner">\n        <div class="fl-modal-loading-msg">'+(e.showText?"<span>"+e.text+"</span>":"")+"</div>\n    </div>\n</div>"),e.showSpinny||null!=(o=n.one(".fl-modal-loading-msg",this.node))&&o.classList.add("noSpinny")}return e.prototype.show=function(){return this.node.style.display="block",this},e.prototype.hide=function(){return this.node.style.display="none",this},e.prototype.fadeOut=function(e){var t=this;setTimeout(function(){return t.node.classList.add("fadeOut"),setTimeout(function(){return n.remove(t.node)},1e3)},e)},e.prototype.destroy=function(){return n.remove(this.node)},e}(),e.exports=t}),require.define("ui/loading",function(e){var t,n,i={}.hasOwnProperty,r=function(e,t){function n(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=require("ui/message"),t=function(e){function t(e){var n;null==e&&(e={}),e.showSpinny=!0,null==(n=e.text)&&(e.text="Loading..."),t.__super__.constructor.call(this,e)}return r(t,e),t}(n),e.exports=t}),require.define("blend/gestures/gesture",function(e){var t,n,i,r,o;o=require("blend/lang"),i=require("blend/events"),t=function(){function e(t,n){var i,r;null==n&&(n={}),"string"==typeof t&&(t=document.querySelector(t)),this.node=t,this.listeners=[],this.state=e.state.begin,this.enabled=!0,n=o.merge(n,this.defaults());for(i in n)r=n[i],this[i]=r;this.setup()}return e.prototype.destroy=function(){var e,t,n,i;for(i=this.listeners,t=0,n=i.length;n>t;t++)e=i[t],e.detach();return this.off("*")},e.types=[],e}(),o.mixin(t,i.Emitter),t.state={begin:1,change:2,end:3},t.prototype.cancel=function(){return this.state=t.state.begin},t.prototype.publish=function(e,t){return t.type=e,this.emit(e,t)},t.prototype.setup=function(){throw new Error("setup() not implemented")},t.prototype.defaults=function(){return{minPoints:1,maxPoints:1,mouseInput:!0,touchInput:!0,pointerInput:!0}},n=[],r=function(e,t){var i,r,o,s;for(r=0,o=n.length;o>r;r++)if(i=n[r],(null!=(s=i[e])?s.gesture.node:void 0)===t)return i;return void 0},t.prototype.listen=function(e,t,n,r){var o;return null==r&&(r=!0),null==e&&(e=this.node),o=i.on(e,t,n.bind(this),r),this.listeners.push(o)},t.register=function(e,t,o){var s,a,l,u,d,c;for(c=[],u=0,d=t.length;d>u;u++)l=t[u],s=function(t,i,s){var a;return a=r(e,t),void 0===a&&(a={},a[e]={gesture:new o(t),events:[]},n.push(a)),a[e].events.push(i),a[e].gesture.on(i,s)},a=function(t,i,o){var s;return s=r(e,t),void 0!==s&&s[e]?(s[e].events=s[e].events.filter(function(e){return e!==i}),s[e].gesture.off(i,o),0===s[e].events.length&&(s[e].gesture.destroy(),s[e]=null,0===Object.keys(s).length)?n.splice(n.indexOf(s),1):void 0):void 0},c.push(i.register(l,s,a));return c},e.exports=t}),require.define("blend/gestures/hold",function(e){var t,n,i,r,o,s,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("blend/lang"),i=require("blend/events"),r=require("blend/features"),t=require("blend/gestures/gesture"),n=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments)}return l(t,e),t}(t),n.prototype.defaults=function(){var e;return e={mouseInput:!1,delay:400},o.merge(e,n.__super__.defaults.apply(this,arguments))},n.prototype.setup=function(){return this.touchInput&&r.touch&&this.listen(this.node,"touchstart",this.touchstart),this.pointerInput&&r.pointer&&(this.capturedPointers=[],this.listen(this.node,r.pointerDown,this.pointerdown)),this.mouseInput?this.listen(this.node,"mousedown",this.mousedown):void 0},n.prototype.touchstart=function(e){var t;return this.usingTouch=!0,this.minPoints<=(t=e.touches.length)&&t<=this.maxPoints?this.begin(e.touches,e):void 0},n.prototype.pointerdown=function(e){var t;return this.usingPointer=!0,this.capturedPointers.push(e),this.minPoints<=(t=this.capturedPointers.length)&&t<=this.maxPoints?this.begin(this.capturedPointers,e):void 0},n.prototype.mousedown=function(e){return this.usingTouch||this.usingPointer?void 0:this.begin([e],e)},n.prototype.begin=function(e,t){var n,o,s,a,l,u,d=this;if(this.enabled){switch(l=[],a=function(){var e;return t.preventDefault(),t.stopPropagation(),e={srcEvent:t},d.publish("hold",e),s()},s=function(){var e,t,n;for(t=0,n=l.length;n>t;t++)e=l[t],e.detach();return d.end()},this.releaseTimer=setTimeout(a,this.delay),t.type){case"touchstart":u="touchmove",o="touchend";break;case"mousedown":u="mousemove",o="mouseup";break;case r.pointerDown:u=r.pointerMove,o=r.pointerUp}return n=function(){return clearTimeout(d.releaseTimer)},l.push(i.on(window,u,n,!0)),l.push(i.on(window,o,n,!0))}},n.prototype.end=function(){return this.usingTouch=!1,this.usingPointer=!1,this.capturedPointers=[]},t.register("hold",["hold"],n),e.exports=n}),require.define("prefs/prefs",function(e){e.exports={server:{settings:{defaultHost:{"default":""}}},ui:{settings:{showGuide:{"default":!0},openGuideToMagazines:{"default":!0}}},transition:{settings:{type:{"default":"flip"},axis:{"default":"x"},mouseInput:{"default":!1},pagingFlip:{"default":!0},wheel:{"default":!1},snapToGrid:{"default":!0},snap:{"default":!0},snapThreshold:{"default":"0.33"},wheelMultiplier:{"default":"0.5"}}}}}),require.define("prefs",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w;l=require("blend/http"),p=require("blend/lang"),s=require("blend/events"),m=require("prefs/prefs"),t={change:"prefs:change",clear:"prefs:clear"},u="fl-preferences",c="__version",d=1,v=null,w=l.parseQuery(window.location.search),window.localStorage||(g=function(){},window.localStorage={getItem:g,setItem:g,removeItem:g,clear:g}),h=function(){var e;return v=null!=(e=localStorage.getItem(u))?e:"{}",v=JSON.parse(v),v[c]!==d&&(v={}),v[c]=d,f()},f=function(){var e,t,n,i;n=function(e){var t,n,i,r,o,s,a;null==(r=v[e])&&(v[e]=p.deepCopy(m[e])),o=m[e],a=[];for(n in o)t=o[n],a.push(null!=(s=(i=v[e])[n])?s:i[n]=p.deepCopy(t));return a},i=[];for(e in m)t=m[e],i.push(n(e,m[e]));return i},y=function(e){var t,n,i;return i=e.split("."),t=i[0],n=i[1],null!=n?v[t].settings[n]:null},a=function(e){var t,n,i;return n=null,t=y(e),!t&&w[e]&&(t={urlParam:e}),t?(t.urlParam&&(n=w[t.urlParam]),null==n&&(n=null!=(i=null!=t?t.value:void 0)?i:null!=t?t["default"]:void 0),n):(console.warn("Couldn't find setting: "+e),null)},x=function(e,n){var i,r,o;return r=n,o=y(e),null!=o&&(o.value=n),b(),i={key:e,existingValue:r,value:n},this.emit(t.change,i)},n=function(){var e;return e=p.deepCopy(v),delete e[c],o(e,function(e){var t;return null!=(t=e.value)?t:e.value=e["default"]}),e},o=function(e,t){var n,i;n=function(e){var n,i;i=[];for(n in e.settings)i.push(t(e.settings[n]));return i};for(i in e)n(e[i]);return e},b=function(){var e;return e=JSON.stringify(v),localStorage.setItem(u,e)},r=function(){return localStorage.removeItem(u),h(),this.emit(t.clear)},h(),i={get:a,set:x,all:n,clear:r},p.mixin(i,s.Emitter),e.exports=i}),require.define("blend/gestures/pan",function(e){var t,n,i,r,o,s,a,l,u={}.hasOwnProperty,d=function(e,t){function n(){this.constructor=e}for(var i in t)u.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};s=require("blend/lang"),i=require("blend/events"),r=require("blend/features"),t=require("blend/gestures/gesture"),a=require("prefs"),n=function(e){function t(){return l=t.__super__.constructor.apply(this,arguments)}return d(t,e),t}(t),n.prototype.setup=function(){return this.translation={x:0,y:0},this.velocity={x:0,y:0},this.location={x:0,y:0},this.wheelMultiplier=a.get("transition.wheelMultiplier"),this.pointerInput&&r.pointer&&this.listen(this.node,r.pointerDown,this.pointerdown),this.touchInput&&this.listen(this.node,"touchstart",this.touchstart),this.mouseInput&&this.listen(this.node,"mousedown",this.mousedown),this.wheelInput?(this.listen(this.node,"wheel",this.mousewheel),this.listen(this.node,"mousewheel",this.mousewheel)):void 0},n.prototype.mousedown=function(e){return this.usingTouch||this.usingPointer?void 0:this.begin(e,e)},n.prototype.touchstart=function(e){var t;return this.usingTouch=!0,this.minPoints<=(t=e.touches.length)&&t<=this.maxPoints?this.begin(e.touches[0],e):void 0},n.prototype.pointerdown=function(e){return this.discardEvent(e)?void 0:(this.usingPointer=!0,this.begin(e,e))},o=-1===navigator.userAgent.toLowerCase().indexOf("webkit"),n.prototype.mousewheel=function(e){var n,i,r,a,l,u,d,c,p;if(this.enabled)return n=null!=(c=e.wheelDeltaX)?c:e.deltaX,i=null!=(p=e.wheelDeltaY)?p:e.deltaY,l=o?-1:1,n*=.25*l,i*=.25*l,-10>i&&(i*=this.wheelMultiplier),this.state===t.state.begin?(n=s.clamp(n,-1,1),i=s.clamp(i,-1,1),this.history=[],this.history.push([Date.now(),n,i]),this.state=t.state.change,r=this.eventData("pan:start",e),r.translation.x=n,r.translation.y=i,this.publish("pan:start",r)):this.state===t.state.change?(a=this.history[this.history.length-1],u=a[1]+n,d=a[2]+i,this.history.push([Date.now(),u,d]),r=this.eventData("pan:change",e),this.publish("pan:change",r)):void 0},n.prototype.eventData=function(e,t){var n,i,r,o,s,a,l,u;return s=this.history[this.history.length-1],n={srcEvent:t},n.type=e,n.translation={x:0,y:0},n.velocity={x:0,y:0},n.location={x:s[1],y:s[2]},this.history.length>1&&(a=this.history[0],l=this.history[this.history.length-2],u=this.history[this.history.length-1],i=u[0]-l[0],r=u[1]-l[1],o=u[2]-l[2],n.translation.x=u[1]-a[1],n.translation.y=u[2]-a[2],n.velocity.x=r/i,n.velocity.y=o/i),this.translation=n.translation,this.velocity=n.velocity,this.location=n.location,n},n.prototype.discardEvent=function(e){if(null!=e.pointerId){if(null!=this.activePointerId)return e.pointerId!==this.activePointerId;this.activePointerId=e.pointerId}return!1},n.prototype.relativePoint=function(e){var t,n,i;return t=this.node.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,{x:n,y:i}},n.prototype.begin=function(e,n){var o,s,a,l,u,d,c,p=this;if(this.enabled){switch(c=!1,e=this.relativePoint(e),this.history=[],this.history.push([Date.now(),e.x,e.y]),l=function(e){var i,r,o,s;if(!p.discardEvent(e)&&(c=!0,r=null!=(o=null!=(s=e.touches)?s[0]:void 0)?o:e,r=p.relativePoint(r),p.history.push([Date.now(),r.x,r.y]),p.history.length>1))switch(e.preventDefault(),p.state){case t.state.begin:if(i=p.eventData("pan:start",n),0!==i.translation.x||0!==i.translation.y)return p.publish("pan:start",i),p.state=t.state.change;
break;case t.state.change:return p.change(e)}},o=function(e){var t,n,i,r;if(!p.discardEvent(e)){for(c&&p.end(e),r=[u,s],n=0,i=r.length;i>n;n++)t=r[n],t.detach();return p.usingTouch=!1,p.usingPointer=!1,p.activePointerId=null}},n.type){case"touchstart":d="touchmove",a="touchend";break;case"mousedown":d="mousemove",a="mouseup";break;case r.pointerDown:d=r.pointerMove,a=r.pointerUp}return u=i.on(window,d,l,!0),s=i.on(window,a,o,!0)}},n.prototype.change=function(e){return this.publish("pan:change",this.eventData("pan:change",e))},n.prototype.end=function(e){return this.state=t.state.end,this.publish("pan:end",this.eventData("pan:end",e)),this.state=t.state.begin},t.register("pan",["pan:start","pan:change","pan:end"],n),e.exports=n}),require.define("blend/gestures/swipe",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I={}.hasOwnProperty,k=function(e,t){function n(){this.constructor=e}for(var i in t)I.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v=require("blend/lang"),d=require("blend/events"),c=require("blend/features"),t=require("blend/gestures/gesture"),n=require("blend/gestures/pan"),i=function(e){function t(){return q=t.__super__.constructor.apply(this,arguments)}return k(t,e),t}(t),l={up:1,down:2,left:3,right:4},i.direction=l,i.prototype.defaults=function(){return v.merge(i.__super__.defaults.apply(this,arguments),{wheelInput:!1,preventWheel:!0})},i.prototype.setup=function(){var e;return e={minPoints:this.points,maxPoints:this.points,wheelInput:this.wheelInput,mouseInput:this.mouseInput,touchInput:this.touchInput,pointerInput:this.pointerInput},this.panGesture=new n(this.node,e),this.panGesture.on("pan:start",this.panStart.bind(this)),this.panGesture.on("pan:end",this.panEnd.bind(this)),this.wheelInput?(this.listen(window,"wheel",this.mousewheel),this.listen(window,"mousewheel",this.mousewheel)):void 0},i.prototype.destroy=function(){return i.__super__.destroy.apply(this,arguments),this.panGesture.destroy()},i.prototype.panStart=function(e){return this.enabled?(this.state=t.state.begin,this.publish("swipe:start",{srcEvent:e.srcEvent})):void 0},i.prototype.panEnd=function(e){var n,i,r,o,s,a;return s=e.velocity.x,a=e.velocity.y,r=Math.abs(s),o=Math.abs(a),i=o>=r?a>=0?l.down:l.up:s>=0?l.right:l.left,n={velocity:e.velocity,srcEvent:e.srcEvent,direction:i},this.state=t.state.end,this.publish("swipe",n),this.state=t.state.begin},m=0,g=0,f=0,w=0,_=!1,b={x:0,y:0},x=0,o=void 0,a=null,p=[],i.prototype.mousewheel=function(e){if(this.enabled)switch(this.preventWheel&&(e.preventDefault(),e.stopPropagation()),w){case 0:return this.stationary(e);case 1:return this.accelerating(e);case 2:return this.decelerating(e)}},i.prototype.stationary=function(e){return w=1,b={x:0,y:0},x=0,o=void 0,_=!1,p=[],r(e),this.state=t.state.begin,this.publish("swipe:start",{srcEvent:e}),2===w?this.accelerating(e):void 0},i.prototype.accelerating=function(e){return r(e),_?void 0:(clearTimeout(a),a=setTimeout(this.decelerating.bind(this,e),100))},i.prototype.decelerating=function(e){return r(e),clearTimeout(a),_||(this.state=t.state.end,this.publish("swipe",u(e)),_=!0),a=setTimeout(function(){return w=0},60)},T=.5,h=-1===navigator.userAgent.toLowerCase().indexOf("webkit"),r=function(e){var t,n,i,r,s,a,u,d,c,v,_,q,I,k,P,C,S,E,N,L;if(i=null!=(S=e.wheelDeltaY)?S:e.deltaY,n=null!=(E=e.wheelDeltaX)?E:e.deltaX,h&&(i*=-1),h&&(n*=-1),void 0===o&&(o=Math.abs(i)>=Math.abs(n)?0>=i?l.up:l.down:0>=n?l.left:l.right),_=null!=(N=null!=(L=window.performance)?L.now():void 0)?N:Date.now(),b.x-=i,b.y-=i,o===l.up||o===l.down?p.push([_,b.y]):p.push([_,b.x]),1===p.length?(q=Math.abs(i)>0?i:n,v=q):(u=p[p.length-2],d=p[p.length-1],t=d[0]-u[0]||1,q=(d[1]-u[1])/t,v=u[3]+T*(u[2]-u[3])),Math.abs(v)>x&&(x=Math.abs(v)),1===w&&(Math.abs(v)>g||Math.abs(y())>=f)&&(w=2),p.length>8&&x>m){for(a=!0,c=p.slice(p.length-9,p.length-1),r=I=0,P=c.length;P>I;r=++I)if(d=c[r],0!==r&&(u=c[r-1],Math.abs(d[3])>Math.abs(u[3]))){a=!1;break}if(a&&(w=2),2===w){for(s=!0,r=k=0,C=c.length;C>k;r=++k)if(d=c[r],0!==r&&(u=c[r-1],Math.abs(d[3])<Math.abs(u[3]))){s=!1;break}s&&(w=0)}}return p[p.length-1].push(q),p[p.length-1].push(v),p.length>10?p.shift():void 0},s=function(){return p[p.length-1][3]},y=function(){var e,t,n;return e=0,p.length>1&&(t=p[p.length-2],n=p[p.length-1],e=n[1]-t[1]),e},u=function(e){var t;return t={srcEvent:e,translation:b,direction:o,velocity:s()}},t.register("swipe",["swipe:start","swipe"],i),e.exports=i}),require.define("blend/gestures/tap",function(e){var t,n,i,r,o,s,a,l,u={}.hasOwnProperty,d=function(e,t){function n(){this.constructor=e}for(var i in t)u.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};s=require("blend/lang"),r=require("blend/events"),o=require("blend/features"),a=require("blend/tick"),t=require("blend/gestures/gesture"),n=function(e){function t(){return l=t.__super__.constructor.apply(this,arguments)}return d(t,e),t}(t),n.prototype.setup=function(){return this.touchInput&&o.touch&&this.listen(this.node,"touchstart",this.touchstart),this.pointerInput&&o.pointer&&(this.capturedPointers=[],this.listen(this.node,o.pointerDown,this.pointerdown)),this.mouseInput?this.listen(this.node,"click",this.click):void 0},n.prototype.touchstart=function(e){var t;return this.usingTouch=!0,this.minPoints<=(t=e.touches.length)&&t<=this.maxPoints?this.begin(e.touches,e):void 0},n.prototype.pointerdown=function(e){var t;return this.usingPointer=!0,this.capturedPointers.push(e),this.minPoints<=(t=this.capturedPointers.length)&&t<=this.maxPoints?this.begin(this.capturedPointers,e):void 0},n.prototype.click=function(e){return this.usingTouch||this.usingPointer?void 0:(this.publish("tap",this.eventData(e)),this.end())},i=function(e){var t,n,i;t={};for(n in e)i=e[n],"function"!=typeof i&&(t[n]=i);return t},n.prototype.eventData=function(e){var t;return t=i(e),t.srcEvent=e,t.preventDefault=function(){return e.preventDefault()},t.stopPropagation=function(){return e.stopPropagation()},t},n.prototype.begin=function(e,t){var n,i,s,a,l,u,d,c=this;if(this.enabled){switch(t.preventDefault(),l=[],d=!1,a=function(){return d||c.publish("tap",c.eventData(t)),s()},s=function(){var e,t,n;for(t=0,n=l.length;n>t;t++)e=l[t],e.detach();return c.end()},t.type){case"touchstart":u="touchmove",i="touchend";break;case"mousedown":u="mousemove",i="mouseup";break;case o.pointerDown:u=o.pointerMove,i=o.pointerUp}return n=function(){return d=!0,s()},l.push(r.on(window,u,n,!0)),l.push(r.on(window,i,a,!0))}},n.prototype.end=function(){var e=this;return a(function(){return e.usingTouch=!1,e.usingPointer=!1,e.capturedPointers=[]})},t.register("tap",["tap"],n),e.exports=n}),require.define("blend/gestures",function(e,t){t.Base=require("blend/gestures/gesture"),t.Hold=require("blend/gestures/hold"),t.Pan=require("blend/gestures/pan"),t.Swipe=require("blend/gestures/swipe"),t.Tap=require("blend/gestures/tap")}),require.define("lib/template/helpers",function(e,t){var n=[].slice;t.eq=function(e,t,n){return e===t?n.fn(this):n.inverse(this)},t.notEq=function(e,t,n){return e!==t?n.fn(this):n.inverse(this)},t.gt=function(e,t,n){return e>t?n.fn(this):n.inverse(this)},t.gte=function(e,t,n){return e>=t?n.fn(this):n.inverse(this)},t.lt=function(e,t,n){return t>e?n.fn(this):n.inverse(this)},t.lte=function(e,t,n){return t>=e?n.fn(this):n.inverse(this)},t.urlEncode=function(e){return encodeURIComponent(e)},t.withIfExists=function(e,t){return e?t.fn(e):t.inverse(this)},t.eachIfExists=function(e,t){var n,i,r,o;if(e){for(i="",r=0,o=e.length;o>r;r++)n=e[r],i+=t.fn(n);return i}return t.inverse(this)},t.eachUntil=function(e,t,n){var i,r,o,s,a;for(o="",i=s=0,a=e.length;a>s&&(r=e[i],!(i>=t));i=++s)o+=n.fn(r);return o},t.choose=function(){var e,t,i,r,o,s,a;if(e=1<=arguments.length?n.call(arguments,0):[],e.length<2)throw new Error("Must pass at least 1 option to {{#choose}}");for(o=e.slice(0,e.length-1),i=e[e.length-1],t="function"==typeof i.fn&&"function"==typeof i.inverse,s=0,a=o.length;a>s;s++)if(r=o[s])return t?i.fn(this,{data:{chosen:r}}):r;return t?i.inverse(this):""},t.json=function(e){return JSON.stringify(e)},t.encodeURIComponent=function(e){return encodeURIComponent(e)},t.withDefaults=function(e,t){var n,i,r;null==e&&(e={}),r=t.hash;for(n in r)i=r[n],e.hasOwnProperty(n)||(e[n]=i);return t.fn(e)},t.eachWithArgs=function(e,t){var n,i,r,o,s,a,l,u;o="",u=t.hash;for(r in u)s=u[r],t.data[r]=s;if(null!=e.length)for(n=a=0,l=e.length;l>a;n=++a)i=e[n],t.data.index=n,o+=t.fn(s,t);else if("object"==typeof e)for(r in e)s=e[r],t.data.key=r,o+=t.fn(s,t);return o}}),require.define("ui/component",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g=[].slice;r=require("blend/dom"),o=require("blend/events"),u=require("blend/lang"),c=require("blend/tick"),s=require("blend/features"),l=require("blend/i18n"),p=require("lib/template/helpers"),n=function(){function e(e){var t,n;null==e&&(e={}),this.props={},this.events=[],this.node=null,this.parent=null,e=u.merge(e,this.defaults());for(t in e)n=e[t],this.set(t,n,!0)}return e.templateName=null,e.template=null,e.plugins=[],e.transition=!1,e.events={},e.prototype.destroy=function(){return this.unbindEvents(),this.off("*")},e}(),u.mixin(n,o.Emitter),n.prototype.defaults=function(){return{}},n.prototype.get=function(e){return this.props[e]},n.prototype.set=function(e,t,n){var i,r,o;return r=this.props[e],this.props[e]=t,n?void 0:(i={existingValue:r,value:t},this.emit("change:"+e,i),"function"==typeof this[o=""+e+"Changed"]?this[o](i):void 0)},n.prototype.bindEvents=function(){var e,t,n,i,r,s,a,l,u;this.events.length>0&&this.unbindEvents(),l=this.constructor.events,u=[];for(e in l)n=l[e],e=e.trim(),r=e.indexOf(" "),a=e.substr(0,r),s=e.substr(r+1).trim(),i=null,t=this[n].bind(this),i="window"===s?o.on(window,a,t):"document"===s?o.on(document,a,t):o.delegate(this.node,s,a,t),u.push(this.events.push(i));return u},n.prototype.unbindEvents=function(){var e,t,n,i;for(i=this.events,t=0,n=i.length;n>t;t++)e=i[t],e.detach();return this.events=[]},i={beforeRender:"ui:beforeRender",rendered:"ui:rendered",beforeAppear:"ui:beforeAppear",appeared:"ui:appeared",beforeDismiss:"ui:beforeDismiss",dismissed:"ui:dismissed"},n.EVENTS=i,n.prototype.rendered=function(){},n.prototype.beforeRender=function(){},n.prototype.beforeAppear=function(){},n.prototype.appeared=function(){},n.prototype.beforeDismiss=function(){},n.prototype.dismissed=function(){},n.prototype.render=function(e,t,n){var i,o,s,a;return this.parent=null!=e?e:document.body,null==t&&(t=!0),null==n&&(n={}),"string"==typeof this.parent&&(this.parent=r.one(this.parent)),i=this.templateHtml(),null!=i&&(this._beforeRender(),s=null!=(a=n.insert)?a:"end",this.node=r.create(i),o="begin"===s?r.prepend:r.append,o(this.node,this.parent),this._rendered(),this.appear(t)),this},n.prototype.refresh=function(){var e,t,n,i,o,s;if(null!=this.node){for(this._beforeRender(),t=this.templateHtml(),n=r.create(t),this.node.innerHTML=n.innerHTML,s=n.attributes,i=0,o=s.length;o>i;i++)e=s[i],this.node.setAttribute(e.name,e.value);return this._rendered(),this}},n.prototype.update=function(){return this.refresh(),this},n.prototype.setNeedsLayout=function(){var e=this;return this._needsLayout||c(function(){return e.update(),e._needsLayout=!1}),this._needsLayout=!0},n.prototype._beforeRender=function(){return this.emit(i.beforeRender),this.beforeRender()},n.prototype._rendered=function(){return this.bindEvents(),this.emit(i.rendered),this.rendered()},n.prototype.templateHtml=function(){var e,t,n,i,r,o,s=this;if(n=null,this.constructor.templateName){r={},r.helpers={},o=Handlebars.helpers;for(i in o)t=o[i],r.helpers[i]=t;r.helpers.helperMissing=function(){var e,t;return t=arguments[0],e=2<=arguments.length?g.call(arguments,1):[],"function"==typeof s[t]?s[t].apply(s,e):Handlebars.helpers.helperMissing},e=Handlebars.templates[this.constructor.templateName],n=e(this.props,r)}else this.constructor.template&&(n=this.constructor.template);return n},t={animating:"fl-animating",visible:"fl-visible",hidden:"fl-hidden",appearing:"fl-appearing",dismissing:"fl-dismissing"},n.CLASSES=t,n.prototype.appear=function(e){var n,i,r,a,l,u,d=this;return null==e&&(e=!0),null!=this.node?(s.transitions||(e=!1),a=function(){return d._appeared(e)},r=function(){return d._beforeAppear(e)},e?(u=f(this),i=h(this),this.addTransitionClass(t.hidden),s.forceAnimSetupLayout&&u.clientHeight,c(function(){return r(),d.addTransitionClass(t.animating),d.addTransitionClass(t.visible),d.addTransitionClass(t.appearing),d.removeTransitionClass(t.hidden)}),n=function(e){return e.target===i?(d.removeTransitionClass(t.animating),d.removeTransitionClass(t.appearing),l.detach(),a()):void 0},l=o.on(u,s.transitionEnd,n)):(r(),a())):void 0},n.prototype._beforeAppear=function(e){var t;return null==this.node.parentNode&&r.append(this.node,this.parent),t={animated:e},this.emit(i.beforeAppear,t),this.beforeAppear(e)},n.prototype._appeared=function(e){var n;return this.addTransitionClass(t.visible),n={animated:e},this.emit(i.appeared,n),this.appeared(e)},n.prototype.dismiss=function(e){var n,i,a,l,u,d,p=this;return null==e&&(e=!0),null!=this.node?(s.transitions||(e=!1),l=function(){return r.remove(p.node),p._dismissed(e)},a=function(){return p._beforeDismiss(e)},e?(d=f(this),i=h(this),this.addTransitionClass(t.animating),this.addTransitionClass(t.visible),c(function(){return a(),p.removeTransitionClass(t.visible),p.addTransitionClass(t.hidden),p.addTransitionClass(t.dismissing)}),n=function(e){return e.target===i?(p.removeTransitionClass(t.animating),p.removeTransitionClass(t.dismissing),u.detach(),l()):void 0},u=o.on(i,s.transitionEnd,n)):(a(),l())):void 0},n.prototype._beforeDismiss=function(e){var t;return t={animated:e},this.emit(i.beforeDismiss,t),this.beforeDismiss(e)},n.prototype._dismissed=function(e){var n;return this.removeTransitionClass(t.animating),this.removeTransitionClass(t.visible),this.removeTransitionClass(t.hidden),n={animated:e},this.emit(i.dismissed,n),this.dismissed(e)},f=function(e){var t;return r.one(null!=(t=e.constructor.transition.parentNode)?t:e.node)},h=function(e){var t;return r.one(null!=(t=e.constructor.transition.animatedNode)?t:e.node)},n.prototype.addTransitionClass=function(e){var t;return t=f(this,e),null!=this.constructor.transition.classSuffix&&(e+="-"+this.constructor.transition.classSuffix),t.classList.add(e)},n.prototype.removeTransitionClass=function(e){var t;return t=f(this,e),null!=this.constructor.transition.classSuffix&&(e+="-"+this.constructor.transition.classSuffix),t.classList.remove(e)};for(d in p)a=p[d],Handlebars.registerHelper(d,a);Handlebars.registerHelper("i18n",l.t),e.exports=n}),require.define("ui/plugins/modal",function(e){var t,n,i,r,o,s,a,l,u;s=require("blend/dom"),a=require("blend/events"),u=require("blend/lang"),l=require("blend/features"),i=require("ui/component"),t={overlay:"modal-overlay"},o={overlay:99998,content:99999},n={overlay:"position: fixed; left: 0; top: 0; bottom: 0; right: 0; background: #000; opacity: 0;"},r={defaults:function(){return{modal:!0,center:!0,overlayAlpha:.6,overlayDismiss:!1}},destroy:function(){var e,t;return i.prototype.destroy.call(this),s.remove(this.overlayNode),null!=(e=this.resizeHandle)&&e.detach(),null!=(t=this.overlayHandle)?t.detach():void 0},rendered:function(){var e,i;if(this.get("modal"))return null==this.overlayNode&&(this.overlayNode=document.createElement("div"),this.overlayNode.classList.add(t.overlay),this.overlayNode.style.cssText=n.overlay,this.overlayNode.style[l.transitionDuration]="0.35s",this.overlayNode.style[l.transitionProperty]="opacity",this.parent.appendChild(this.overlayNode),this.overlayNode.style[l.transform]="translate3d(0,0,-1000px)",this.overlayNode.style.zIndex=o.overlay,this.node.style.zIndex=o.content,this.get("overlayDismiss")&&(this.overlayHandle=a.once(this.overlayNode,"click",this.dismiss.bind(this),!0)),this.get("center"))?(this.center(),e=u.throttled(this.center.bind(this),100),null!=(i=this.resizeHandle)?i:this.resizeHandle=a.on(window,"resize",e)):void 0},beforeAppear:function(){return this.get("modal")?this.overlayNode.style.opacity=this.get("overlayAlpha"):void 0},beforeDismiss:function(){return this.get("modal")?this.overlayNode.style.opacity=0:void 0},center:function(){var e,t,n,i;if(this.get("center"))return this.node.style.display="block",this.node.style.visibility="hidden",i=this.node.getBoundingClientRect(),n=i.width,e=i.height,this.node.style.display="none",this.node.style.removeProperty("visibility"),t=this.parent.getBoundingClientRect(),this.node.style.position="absolute",this.node.style.top=Math.max(t.height/2-e/2,0)+"px",this.node.style.left=Math.max(t.width/2-n/2,0)+"px",this.node.style.display="block"}},e.exports=r}),require.define("ui/alert",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};a=require("blend/dom"),p=require("blend/lang"),l=require("blend/events"),u=require("blend/gestures"),d=require("blend/http"),c=require("blend/i18n"),o=require("blend/async"),n=require("ui/component"),r=require("ui/plugins/modal"),t=function(e){function t(){var e=this;t.__super__.constructor.apply(this,arguments),this.on(n.EVENTS.dismissed,this.destroy,this),this.on(i.close,function(t){return t.halted()?void 0:e.dismiss()})}return g(t,e),t.templateName="alert",t.events={"tap .close":"tappedClose","tap .cancel":"tappedCancel","tap .okay":"tappedOk"},t}(n),p.mixin(t.prototype,r),t.prototype.defaults=function(){return p.merge(r.defaults(),{message:"",closeButton:!0,okButton:!1,okText:c.t("ok_button"),cancelButton:!1,cancelText:c.t("cancel_button")})},i={close:"alert:close"},t.EVENTS=i,t.prototype.tappedClose=function(){return this.emit(i.close)},t.prototype.tappedCancel=function(){return this.emit(i.close,{ok:!1})},t.prototype.tappedOk=function(){return this.emit(i.close,{ok:!0})},h=function(e,n){var i;return 1===arguments.length&&(n=e,e=null),i={title:e,message:n,closeButton:!0},new t(i).render()},s=function(e,n,r,s){var a,l,u,d;return d=o.defer(),l=d.promise,u=d.resolve,1===arguments.length&&(n=e,e=null),a={title:e,message:n,closeButton:!1,cancelButton:!0,cancelText:r,okButton:!0,okText:s},new t(a).render().on(i.close,function(e){return u(e.ok)}),l},e.exports=t,e.exports.message=h,e.exports.confirm=s}),require.define("pageControllers/base",function(e){var t,n,i;i=require("blend/lang"),n=require("blend/events"),t=function(){function e(e,t){var n,r;if(this.node=e,null==t&&(t={}),"string"==typeof e&&(e=document.querySelector(e)),!(e instanceof HTMLElement))throw new Error("Invalid node argument supplied");if("function"!=typeof t.getPage)throw new Error("Must specify getPage() option");if("function"!=typeof t.getCount)throw new Error("Must specify getCount() option");this.node=e,this.page=t.getPage,this.count=t.getCount,t=i.merge(t,this.defaults());for(n in t)r=t[n],this[n]=r;this.selectedIndex=0,this.animating=!1,this.transitioning=!1,this.events=[]}return e.prototype.destroy=function(){var e,t,n,i,r;for(i=this.events,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(e.detach());return r},e}(),t.prototype.init=function(){throw new Error("init() not implemented")},t.prototype.select=function(){throw new Error("select() not implemented")},t.prototype.defaults=function(){return{maxAdjacentPages:1/0}},t.prototype.enableGestures=function(){},t.prototype.disableGestures=function(){},t.prototype.listen=function(e,t,i){return i=n.on(e,t,i),this.events.push(i)},t.prototype.page=function(){return void 0},t.prototype.count=function(){return 0},t.prototype.next=function(e){var t;return null==e&&(e=!0),t=this.selectedIndex+1,this.isValidIndex(t)?this.select(t,e):void 0},t.prototype.prev=function(e){var t;return null==e&&(e=!0),t=this.selectedIndex-1,this.isValidIndex(t)?this.select(t,e):void 0},t.prototype.isValidIndex=function(e){return e>=0&&e<=this.count()-1},t.prototype.updatePages=function(){var e,t,n,i,r;if(1/0!==this.maxAdjacentPages){for(r=[],e=n=0,i=this.count();i>=0?i>n:n>i;e=i>=0?++n:--n)t=this.page(e),Math.abs(e-this.selectedIndex)<=this.maxAdjacentPages?(this.attachPage(t,e),e===this.selectedIndex?r.push(this.showPage(t,e)):r.push(this.hidePage(t,e))):r.push(this.detachPage(t,e));return r}},t.prototype.attachPage=function(e){return e.parentNode!==this.node?this.node.appendChild(e):void 0},t.prototype.detachPage=function(e){return e.parentNode===this.node?this.node.removeChild(e):void 0},t.prototype.showPage=function(e,t){return this.attachPage(e,t),e.style.removeProperty("visibility"),e.style.removeProperty("position"),e.style.removeProperty("top"),e.style.removeProperty("left")},t.prototype.hidePage=function(e){return e.style.visibility="hidden",e.style.position="absolute",e.style.top="-"+window.innerWidth+"px",e.style.left="-"+window.innerHeight+"px"},t.prototype.onBeforeTrack=function(e,t){var n;return n={x:e,y:t},this.emit("page:beforeTrack",n)},t.prototype.onTrack=function(e,t){var n;return n={x:e,y:t},this.emit("page:track",n)},t.prototype.onBeforeChange=function(e,t){var n;return n={prevIndex:e,index:t},this.emit("page:beforeChange",n)},t.prototype.onChange=function(e,t){var n;return n={prevIndex:e,index:t},this.emit("page:change",n)},i.mixin(t,n.Emitter),e.exports=t}),require.define("transitions/base",function(e){var t,n,i,r;r=require("blend/lang"),n=require("blend/events"),i=350,t=function(){function e(e,t,n){var r;this.fromNode=e,this.toNode=t,this.options=null!=n?n:{},this.reverse=this.options.reverse,this.duration=null!=(r=this.options.duration)?r:i,this.setup()}return e.prototype.destroy=function(){},e.prototype.setup=function(){throw new Error("Transition#setup not implemented")},e.prototype.begin=function(){throw new Error("Transition#begin not implemented")},e.prototype.update=function(){throw new Error("Transition#update not implemented")},e.prototype.finish=function(){throw new Error("Transition#finish not implemented")},e.prototype.onBegin=function(e){return null==e&&(e={}),this.emit("transition:begin")},e.prototype.onFinish=function(e){return null==e&&(e={}),this.emit("transition:end",e)},e}(),r.mixin(t,n.Emitter),e.exports=t}),require.define("transitions/flip",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L,A,F,M,R,z,D,O={}.hasOwnProperty,B=function(e,t){function n(){this.constructor=e}for(var i in t)O.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};p=require("blend/dom"),S=require("blend/lang"),h=require("blend/events"),f=require("blend/features"),E=require("blend/tick"),l=require("transitions/base"),w=1800,_=30,x=25,T=36,d=w,b=f.ie,M=!0,F=!(b&&(null!=(z=navigator.cpuClass)?z.match(/arm/i):void 0)),R=b,n=function(e){return Math.PI*e/180},a=function(e){return 180*e/Math.PI},t=function(e){var t;return t=0===e?0:e>0?1:-1,t*Math.pow(Math.abs(e),1/3)},i=function(e,t,n,i){return n*(-Math.pow(2,-10*e/i)+1)+t},r=function(e,t,n,i){return e/=i,-n*e*(e-2)+t},g=function(e,t){var n,i;return i=0,n=-Math.PI/2,n>e&&t===k?i=(e-n)/n:e>n&&t===P&&(i=(n-e)/n),.7*i},y=function(e,t){var n,i;return n=.1,i=0,i=t===I?e/(-Math.PI/2):(-Math.PI-e)/(-Math.PI/2),i=S.clamp(i,0,1),i*n},L=function(e,t){return"x"===e?"perspective("+d+"px) rotateY("+t+"rad)":"perspective("+d+"px) rotateX("+-t+"rad)"},k="left",P="right",I="front",q="back",s=function(){function e(e,t,n,i,r){var o,s,a,l,u,d,c,h;if(this.reuseNode=r,this.node=e,this.node.classList.add("fl-visible"),h=i.width,a=i.height,R&&this.node.classList.add("backface-visible"),s="",d="flap-shadow","x"===n)switch(l="rect(0px, "+Math.ceil(h/2)+"px, "+a+"px, 0px)",u="rect(0px, "+h+"px, "+a+"px, "+Math.ceil(h/2)+"px)",t){case k:s=l,d+=" flat left";break;case P:s=u,d+=" flat right";break;case I:s=u,d+=" gradient front";break;case q:s=l,d+=" gradient back"}else switch(c="rect(0px, "+h+"px, "+a/2+"px, 0px)",o="rect("+a/2+"px, "+h+"px, "+a+"px, 0px)",d+=" vertical",t){case k:s=c,d+=" flat left";break;case P:s=o,d+=" flat right";break;case I:s=o,d+=" gradient front";break;case q:s=c,d+=" gradient back"}this.overrideStyle("clip",s),this.overrideStyle("zIndex",_),t===q&&("x"===n&&h%2>0?this.overrideStyle("width",""+(h+1)+"px"):"y"===n&&a%2>0&&this.overrideStyle("height",""+(a+1)+"px")),M&&(this.shadowNode=document.createElement("div"),this.shadowNode.className=d,this.node.appendChild(this.shadowNode)),p.setTextSelectable(this.node,!1),this.node.setAttribute("data-flap",t)}return e.prototype.destroyed=!1,e.prototype.shadowNode=null,e.prototype.restoreStyles=function(){var e,t,n;n=this.oldStyles;for(e in n)t=n[e],this.node.style[e]=t;return this.oldStyles=null},e.prototype.overrideStyle=function(e,t){var n;return null==(n=this.oldStyles)&&(this.oldStyles={}),this.oldStyles[e]=this.node.style[e],this.node.style[e]=t},e.prototype.destroy=function(){var e;if(!this.destroyed)return this.destroyed=!0,this.reuseNode?(this.node.classList.remove("fl-visible"),this.node.removeAttribute("data-flap"),this.restoreStyles(),null!=this.shadowNode&&this.node.removeChild(this.shadowNode),p.setTextSelectable(this.node,!0)):null!=(e=this.node.parentNode)?e.removeChild(this.node):void 0},e}(),o=function(e){function t(){return D=t.__super__.constructor.apply(this,arguments)}return B(t,e),t.prototype.destroy=function(){return this.leftFlap.destroy(),this.rightFlap.destroy(),this.frontFlap.destroy(),this.backFlap.destroy()},t.prototype.setup=function(){var e,t,i,r,o,a,l,u,c,p,h,f,g,m;return u=this.fromNode.parentNode,this.axis=null!=(m=this.options.axis)?m:"x",o=this.fromNode.style.left,g=this.fromNode.style.top,o&&(this.toNode.setAttribute("data-left",this.toNode.style.left),this.toNode.style.left=o),g&&(this.toNode.setAttribute("data-top",this.toNode.style.top),this.toNode.style.top=g),t=this.fromNode,i=t.cloneNode(!0),h=this.toNode,f=h.cloneNode(!0),l=this.fromNode.getBoundingClientRect(),d=w,l.width>=1024?d*=1.2:Math.max(l.width,l.height)<=640&&(d/=1.5),a=this.reverse?h:t,c=this.reverse?t:h,r=this.reverse?f:i,e=this.reverse?i:f,this.leftFlap=new s(a,k,this.axis,l,!0),this.rightFlap=new s(c,P,this.axis,l,!0),this.frontFlap=new s(r,I,this.axis,l,!1),this.backFlap=new s(e,q,this.axis,l,!1),u.appendChild(this.frontFlap.node),u.appendChild(this.backFlap.node),p=this.reverse?n(-180):0,this.rotate(p)},t.prototype.begin=function(){var e=this;return this.canAnimate=!1,E(function(){return e.canAnimate=!0}),this.onBegin({}),this},t.prototype.update=function(e){var t;return t=-Math.PI*e,this.rotate(t),this},t.prototype.finish=function(e,t){var n,i,r=this;return null==e&&(e=!0),this.canAnimate?(null==t&&(t=this.duration),n=t>0,i=function(){var t,n,i,o;for(o=["left","top"],n=0,i=o.length;i>n;n++)t=o[n],r.toNode.style.removeProperty(t),r.toNode.getAttribute("data-"+t)&&(r.toNode.style[t]=r.toNode.getAttribute("data-"+t)),r.toNode.removeAttribute("data-"+t);return r.onFinish({finished:e,fromPage:r.fromPage,toPage:r.toPage,reverse:r.reverse})},n?(R?this.finishWithKeyframes(e,t,i):this.finishWithTransitions(e,t,i),this):(i(),void 0)):(f.forceAnimSetupLayout&&this.fromNode.offsetHeight,E(this.finish.bind(this,e,t)),void 0)},t.prototype.finishWithKeyframes=function(e,t,i){var r,o,s,a=this;return r=function(e){return e.target===a.backFlap.node?(h.off(a.backFlap.node,f.animationEnd,r,!1),i()):void 0},o=this.reverse?0:n(-180),e||(o=this.reverse?n(-180):0),m(this.axis,this.currentAngle,o,t),s=v(this.axis,this.currentAngle,o),A(this.frontFlap.node,"flip-front-"+s,t),A(this.backFlap.node,"flip-back-"+s,t),M&&(F?(A(this.leftFlap.shadowNode,"shadow-left-"+s,t),A(this.rightFlap.shadowNode,"shadow-right-"+s,t),A(this.frontFlap.shadowNode,"shadow-front-"+s,t),A(this.backFlap.shadowNode,"shadow-back-"+s,t)):(this.leftFlap.shadowNode.style.display="none",this.rightFlap.shadowNode.style.display="none",this.frontFlap.shadowNode.style.display="none",this.backFlap.shadowNode.style.display="none")),this.rotate(o),h.on(this.backFlap.node,f.animationEnd,r,!1)},t.prototype.finishWithTransitions=function(e,t,n){var i,r,o,s,a,l,u,d,c,p,g,m,v,y,b=this;for(u=[this.frontFlap,this.backFlap,this.leftFlap,this.rightFlap],r=!1,a=function(){var e,t,r;for(h.off(b.backFlap.node,f.transitionEnd,i,!1),t=0,r=u.length;r>t;t++)e=u[t],e.node.style.removeProperty(f.jsToCss(f.transform)),e.node.style.removeProperty(f.jsToCss(f.transitionProperty)),e.node.style.removeProperty(f.jsToCss(f.transitionDuration));return n()},i=function(e){return e.target===b.backFlap.node?(r=!0,a()):void 0},y=[this.frontFlap.node,this.backFlap.node],p=0,m=y.length;m>p;p++)d=y[p],d.style[f.transitionProperty]=f.jsToCss(f.transform),d.style[f.transitionDuration]=""+t+"ms";for(g=0,v=u.length;v>g;g++)l=u[g],c=l.shadowNode,c.style[f.transitionProperty]="opacity",c.style[f.transitionDuration]=""+t+"ms";return this.reverse?(this.leftFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms",this.rightFlap.shadowNode.style[f.transitionTimingFunction]="ease-in",this.backFlap.shadowNode.style[f.transitionDuration]=""+t/6+"ms"):(this.leftFlap.shadowNode.style[f.transitionTimingFunction]="ease-in",this.rightFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms",this.frontFlap.shadowNode.style[f.transitionDuration]=""+t/2+"ms"),s=this.reverse?0:1,e||(s=1-s),this.update(s),h.on(this.backFlap.node,f.transitionEnd,i,!1),o=function(){return r?void 0:a()},setTimeout(o,t+100)},t.prototype.rotate=function(e){return null!=this.frontFlap?(this.currentAngle=e,this.frontFlap.node.style[f.transform]=L(this.axis,e),this.backFlap.node.style[f.transform]=L(this.axis,Math.PI+e),R&&(e<-Math.PI/2?(this.frontFlap.node.style.opacity=0,this.backFlap.node.style.opacity=1):(this.frontFlap.node.style.opacity=1,this.backFlap.node.style.opacity=0)),M?(this.leftFlap.shadowNode.style.opacity=g(e,k),this.rightFlap.shadowNode.style.opacity=g(e,P),this.frontFlap.shadowNode.style.opacity=y(e,I),this.backFlap.shadowNode.style.opacity=y(e,q)):void 0):void 0},t}(l),C={},u=[],A=function(e,t,n){return e.style[f.animation]=""+t+" "+n+"ms linear both"},v=function(e,t,n){var i,r;return r=t/-Math.PI*T,i=n/-Math.PI*T,r=r>i?Math.floor(r):Math.ceil(r),""+e+"-"+r+"-"+i},N=function(e,t){var n,i,r,o,s,a;if(R){for(n=0,r=-Math.PI/T,a=[],i=o=0,s=T+1;s>=0?s>=o:o>=s;i=s>=0?++o:--o)m(e,n,0,t),m(e,n,-Math.PI,t),a.push(n+=r);return a}},m=function(e,t,n,i){var o,s,a,l,d,c,h,m,b,w,_,T,S,E,N,A,F,M,R,z,D,O,B,U,H,G,j,X,W,Y,V;if(R=v(e,t,n),null==C[R]){for(C[R]=!0,S=[],s=[],D=[],U=[],N=[],l=[],S.push("@"+f.keyframesCSS+" flip-front-"+R+" {"),s.push("@"+f.keyframesCSS+" flip-back-"+R+" {"),D.push("@"+f.keyframesCSS+" shadow-left-"+R+" {"),U.push("@"+f.keyframesCSS+" shadow-right-"+R+" {"),N.push("@"+f.keyframesCSS+" shadow-front-"+R+" {"),l.push("@"+f.keyframesCSS+" shadow-back-"+R+" {"),j=f.jsToCss(f.transform),M=0,_=0;i>=_;)G=_,o=t,h=n-t,T=i,w=r(G,o,h,T),B=_/i,B=Math.min(1,B),B*=100,F=L(e,w),c=L(e,Math.PI+w),E=w<-Math.PI/2?0:1,a=w<-Math.PI/2?1:0,O=g(w,k),H=g(w,P),A=y(w,I),d=y(w,q),S.push(""+B+"% { "+j+": "+F+"; opacity: "+E+"; }"),s.push(""+B+"% { "+j+": "+c+"; opacity: "+a+"; }"),D.push(""+B+"% { opacity: "+O+"; }"),U.push(""+B+"% { opacity: "+H+"; }"),N.push(""+B+"% { opacity: "+A+"; }"),l.push(""+B+"% { opacity: "+d+"; }"),M+=1,_+=x;for(S.push("}"),s.push("}"),D.push("}"),U.push("}"),N.push("}"),l.push("}"),null==u&&(u=[]),Y=[S,s,D,U,N,l],V=[],X=0,W=Y.length;W>X;X++)z=Y[X],b=""+z.join(""),m=p.createCSSRule(b),V.push(u.push(m));return V}},c=function(){for(var e;(null!=u?u.length:void 0)>0;)null!=(e=u.pop())&&e.destroy();return u=null},e.exports=o,e.exports.pregenerateKeyframes=N}),require.define("pageControllers/panning",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v={}.hasOwnProperty,y=function(e,t){function n(){this.constructor=e}for(var i in t)v.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=require("blend/dom"),r=require("blend/events"),g=require("blend/lang"),o=require("blend/features"),s=require("blend/gestures"),m=require("blend/tick"),t=require("pageControllers/base"),p=10,h=20,a=.35,d=1.5,u=.88,c=.35,f=800,l=200,n=function(e){function t(e,n){var i=this;
this.node=e,null==n&&(n={}),t.__super__.constructor.apply(this,arguments),this.showBookends&&(this.page=function(e){return i.isValidIndex(e)?n.getPage(e):i.getBookendPage()})}return y(t,e),t}(t),n.prototype.defaults=function(){return{axis:"y",maxAdjacentPages:1,showBookends:!1,animDuration:a,autocompleteSpeed:d,autocompleteMultiplier:u,managePageZIndexes:!0,mouseInput:!1,wheelInput:!0,pointerInput:!0,touchInput:!0,autosnap:!1,snapThreshold:.33}},n.prototype.init=function(){var e,t,n;return e={wheelInput:!this.wheelInput,mouseInput:!1,pointerInput:!1,touchInput:!1,preventWheel:"x"===this.axis},this.swipeGesture=new s.Swipe(this.node,e),this.swipeGesture.on("swipe",this.swipe.bind(this)),t={mouseInput:this.mouseInput,touchInput:this.touchInput,pointerInput:this.pointerInput,wheelInput:this.wheelInput},this.panGesture=new s.Pan(this.node,t),this.panGesture.on("pan:start",this.panStart.bind(this)),this.panGesture.on("pan:change",this.panChange.bind(this)),this.panGesture.on("pan:end",this.panEnd.bind(this)),n=this.axis,this.axis=null,this.setAxis(n),this.updatePages()},n.prototype.destroy=function(){return this.swipeGesture.destroy(),this.panGesture.destroy()},n.prototype.enableGestures=function(){return this.panGesture.enabled=!0,this.swipeGesture.enabled=!0},n.prototype.disableGestures=function(){var e,t,n,i,r;for(i=[this.panGesture,this.swipeGesture],r=[],t=0,n=i.length;n>t;t++)e=i[t],e.cancel(),r.push(e.enabled=!1);return r},n.prototype.cancelGestures=function(){return this.panGesture.cancel(),this.swipeGesture.cancel()},n.prototype.select=function(e,t){var n,i;if(!this.animating&&this.isValidIndex(e)&&(this.transitioning||e!==this.selectedIndex))return this.onBeforeChange(this.selectedIndex,e),n=this.selectedIndex,i=e<this.selectedIndex,this.cancelGestures(),this.beginTransition(n,e,i),t?this.finishTransition(!0):this.finishTransition(!0,0)},n.prototype.showPage=function(e){return n.__super__.showPage.apply(this,arguments),e.style.position="absolute",e.style.top="0",e.style.left="0"},n.prototype.setAxis=function(e){return this.axis=e,"y"===this.axis?(this.pageSize=this.node.getBoundingClientRect().height,this.node.style.overflowY="hidden"):(this.pageSize=this.node.getBoundingClientRect().width,this.node.style.overflowX="hidden")},n.prototype.transitionProperties=function(){return[o.transform]},n.prototype.beginTransition=function(e,t,n){var i,r=this;if(!this.transitioning)return this.canAnimate=!1,m(function(){return r.canAnimate=!0}),this.transitioning=!0,this.fromIndex=e,this.toIndex=t,this.reverse=n,this.fromPage=this.page(e),this.toPage=this.page(t),i=this.fromPage.getBoundingClientRect(),this.pageSize="y"===this.axis?i.height:i.width,this.managePageZIndexes&&(this.reverse?(this.toPage.style.zIndex=h,this.fromPage.style.zIndex=p):(this.fromPage.style.zIndex=h,this.toPage.style.zIndex=p)),this.toPage.classList.add("transitioning"),this.fromPage.classList.add("transitioning"),this.showPage(this.toPage),this.updateTransition(0,0)},n.prototype.updateTransition=function(){throw new Error("updateTransition() not implemented")},n.prototype.finishTransition=function(e,t,n){var i,s,a,l,u,d,c,p,h,f,g=this;if(null==n&&(n="ease-in-out"),this.transitioning){if(null==t&&(t=this.animDuration),l=this.transitionProperties(),i=t>0,i&&(this.animating=!0),!this.canAnimate)return m(this.finishTransition.bind(this,e,t,n)),void 0;for(f=[this.fromPage,this.toPage],p=0,h=f.length;h>p;p++)a=f[p],a.style[o.transitionDuration]=""+t+"s",a.style[o.transitionTimingFunction]=n,a.style[o.transitionProperty]=l.join(",");return s=function(t){var n,u,d,c,p,h,f;if(!i||t.target===g.toPage){for(n=o.jsToCss,f=[g.fromPage,g.toPage],d=0,p=f.length;p>d;d++)for(a=f[d],a.style.removeProperty(n(o.transitionDuration)),a.style.removeProperty(n(o.transitionProperty)),a.style.removeProperty(n(o.transitionTimingFunction)),c=0,h=l.length;h>c;c++)u=l[c],a.style.removeProperty(n(u));return i&&r.off(g.toPage,o.transitionEnd,s,!1),e||(g.toIndex=g.selectedIndex),g.transitionFinished(g.fromIndex,g.toIndex)}},u=this.reverse?e?this.pageSize:-this.pageSize:e?-this.pageSize:0,d="y"===this.axis?0:u,c="y"===this.axis?u:0,this.updateTransition(d,c),i?r.on(this.toPage,o.transitionEnd,s,!1):s()}},n.prototype.transitionFinished=function(e,t){var n,i,r,o;return this.animating=!1,this.transitioning=!1,this.selectedIndex=t,null!=(n=this.toPage)&&n.classList.remove("transitioning"),null!=(i=this.fromPage)&&i.classList.remove("transitioning"),this.cancelGestures(),this.updatePages(),this.onChange(e,this.selectedIndex),this.fromPage=void 0,this.fromIndex=void 0,this.toPage=void 0,this.toIndex=void 0,this.reverse=void 0,this.panningBookend?(this.panningBookend=!1,null!=(r=this.bookendPage)?null!=(o=r.parentNode)?o.removeChild(this.bookendPage):void 0:void 0):void 0},n.prototype.getBookendPage=function(){return null==this.bookendPage&&(this.bookendPage=document.createElement("div"),this.bookendPage.className="page bookend"),this.bookendPage},n.prototype.swipe=function(e){var t,n;if(!this.transitioning)switch(n="y"===this.axis||!this.wheelInput,t=!1,e.direction){case s.Swipe.direction.up:if(n)return this.next(!0);break;case s.Swipe.direction.down:if(n)return this.prev(!0);break;case s.Swipe.direction.left:if(t)return this.next(!0);break;case s.Swipe.direction.right:if(t)return this.prev(!0)}},n.prototype.panStart=function(e){var t,n,i,r,o,s,a,l=this;if(!this.transitioning&&(this.panStartLocation=e.location,this.panning=!0,"y"===this.axis?(i=Math.abs(e.velocity.y)>Math.abs(e.velocity.x),o=e.translation.y,a=e.velocity.y):(i=Math.abs(e.velocity.x)>Math.abs(e.velocity.y),o=e.translation.x,a=e.velocity.x),i))if(n=o>0,r=n?this.selectedIndex-1:this.selectedIndex+1,s=this.isValidIndex(r),s||this.showBookends){if(this.panningBookend=!s,this.onBeforeTrack(e.translation.x,e.translation.y),this.beginTransition(this.selectedIndex,r,n),"mousedown"!==e.srcEvent.type&&Math.abs(a)>=this.autocompleteSpeed&&!this.panningBookend)return this.onBeforeChange(this.selectedIndex,r),this.animating=!0,this.panning=!1,t=function(){var e;return e=l.animDuration*l.autocompleteMultiplier,l.finishTransition(!0,e,"ease-out")},setTimeout(t,0)}else if(e.srcEvent.type.indexOf("wheel")>-1)return this.panGesture.cancel()},n.prototype.panChange=function(e){var t,n,i,r;if(this.transitioning&&!this.animating)return r=e.translation,n=r.x,i=r.y,this.panningBookend&&(n*=c,i*=c),this.updateTransition(n,i),e.srcEvent.type.indexOf("wheel")>-1&&(t="y"===this.axis?i:n,t<=-(this.pageSize+f)?(this.panEnd(e,!1),this.panGesture.cancel()):t>=this.pageSize&&(this.panEnd(e,!1),this.panGesture.cancel()),this.autosnap)?(clearTimeout(this.autosnapTimer),this.autosnapTimer=setTimeout(this.snap.bind(this,e),l)):void 0},n.prototype.panEnd=function(e,t){var n,i,r,o;return null==t&&(t=!1),this.transitioning&&!this.animating?(r=this.selectedIndex,!this.panningBookend&&this.shouldCompletePan(e)&&(r=this.reverse?this.selectedIndex-1:this.selectedIndex+1),i=r!==this.selectedIndex,this.panStartLocation=null,this.panning=!1,this.onBeforeChange(this.selectedIndex,r),n=this.animDuration*this.autocompleteMultiplier,e.srcEvent.type.indexOf("wheel")>0&&(o="y"===this.axis?e.translation.y:e.translation.x,(!t||Math.abs(o)>=this.pageSize)&&(n=0)),this.finishTransition(i,n,"ease-out")):void 0},n.prototype.shouldCompletePan=function(e){var t,n,i,r;return i="y"===this.axis?e.translation.y:e.translation.x,r="y"===this.axis?e.velocity.y:e.velocity.x,n=this.reverse?r>0:0>r,t=Math.abs(i)>=this.pageSize*this.snapThreshold,t&&n},n.prototype.snap=function(e){return this.panEnd(e,!0),this.panGesture.cancel()},e.exports=n}),require.define("pageControllers/flip",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=require("blend/dom"),o=require("blend/events"),p=require("blend/lang"),s=require("blend/features"),a=require("blend/gestures"),n=require("transitions/flip"),i=require("pageControllers/panning"),c=350,l=5,u=.5,d=.2,t=function(e){function t(){return h=t.__super__.constructor.apply(this,arguments)}return g(t,e),t}(i),t.prototype.init=function(){return t.__super__.init.apply(this,arguments),this.animDuration=c},t.prototype.defaults=function(){var e;return e={animDuration:c,autocompleteSpeed:l,managePageZIndexes:!1,showBookends:!0},p.merge(e,t.__super__.defaults.apply(this,arguments))},t.prototype.setAxis=function(e){return e!==this.axis?(t.__super__.setAxis.apply(this,arguments),n.pregenerateKeyframes(this.axis,this.animDuration)):void 0},t.prototype.transitionProperties=function(){return[]},t.prototype.shouldCompletePan=function(e){var t,n,i,r;return r="y"===this.axis?e.velocity.y:e.velocity.x,i=this.percentFlipped(),this.reverse?(n=r>=d,t=1-u>i):(n=-d>=r,t=i>u),n||t},t.prototype.beginTransition=function(e,i,r){var o;return t.__super__.beginTransition.apply(this,arguments),this.animDuration=c,this.pageSize>1024&&(this.animDuration*=1.3),o={reverse:r,axis:this.axis},this.flipTransition=new n(this.fromPage,this.toPage,o),this.flipTransition.on("transition:end",this.flipEnded.bind(this)),this.flipTransition.begin(),requestAnimationFrame(this.updateFlaps.bind(this))},t.prototype.updateTransition=function(e,t){return this.transitioning?(this.panningDelta="y"===this.axis?t:e,this.panning?requestAnimationFrame(this.updateFlaps.bind(this)):void 0):void 0},t.prototype.updateFlaps=function(){var e;if(this.panning)return e=this.percentFlipped(),this.flipTransition.update(e)},t.prototype.flipEnded=function(e){return e.finished||(this.toIndex=this.selectedIndex),this.transitionFinished(this.fromIndex,this.toIndex)},t.prototype.finishTransition=function(e,t,n){return null==n&&(n="ease-in-out"),this.transitioning?(null==t&&(t=this.animDuration),this.animating=!0,this.flipTransition.finish(e,t)):void 0},t.prototype.transitionFinished=function(){return this.flipTransition.destroy(),this.flipTransition=null,t.__super__.transitionFinished.apply(this,arguments)},t.prototype.percentFlipped=function(){var e,t;return e=0,this.panning?(t="x"===this.axis?this.panStartLocation.x:this.panStartLocation.y,e=this.reverse?1-Math.abs(this.panningDelta)/this.pageSize:Math.abs(this.panningDelta)/t,e=p.clamp(e,0,1)):e=this.reverse?1:0,e},e.exports=t}),require.define("blend/animator",function(e){var t,n,i,r,o,s,a;a=require("blend/features"),i=function(e){var t,n,i,r;return null==e&&(e={}),null==(t=e.duration)&&(e.duration=.3),null==(n=e.from)&&(e.from=0),null==(i=e.to)&&(e.to=1),null!=(r=e.step)?r:e.step=function(){}},s=function(e,t,n,i){return e/=i,-n*e*(e-2)+t},r=function(e,t,n,i){return e/=i,n*e*e+t},o=function(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)},t=function(){function e(e){if(i(e),this.from=e.from,this.to=e.to,this.duration=e.duration,this.step=e.step,this.startTime=0,this.value=this.from,this.timing=s,"string"==typeof e.timing)switch(e.timing){case"ease-in":this.timing=r;break;case"ease-in-out":this.timing=o;break;default:this.timing=s}this.callbacks=[]}return e.prototype.finished=function(){return this.currentTime>=this.duration},e.prototype.done=function(){var e,t,n,i;for(i=this.callbacks,t=0,n=i.length;n>t;t++)e=i[t],e();return this.callbacks=[]},e.prototype.then=function(e){return this.callbacks.push(e)},e}(),n=function(){function e(){this.pool=[]}return e.prototype.create=function(e){var n,i=this;return n=new t(e),n.run=function(){return i.add(n),n},n.cancel=function(){return i.remove(n),n},n},e.prototype.add=function(e){return this.pool.push(e),1===this.pool.length?this.run():void 0},e.prototype.remove=function(e){var t;return t=this.pool.indexOf(e),t>-1?this.pool.splice(t,1):void 0},e.prototype.run=function(){return requestAnimationFrame(this.step.bind(this))},e.prototype.step=function(e){var t,n,i,r,o;for(n=[],o=this.pool,i=0,r=o.length;r>i;i++)t=o[i],t.startTime||(t.startTime=e),t.currentTime=(e-t.startTime)/1e3,t.value=t.timing(t.currentTime,t.from,t.to-t.from,t.duration),t.step(t.value),t.finished()&&(n.push(t),t.done());return this.pool=this.pool.filter(function(e){return-1===n.indexOf(e)}),this.pool.length>0?this.run():void 0},e}(),e.exports=new n}),require.define("pageControllers/scroll",function(e){var t,n,i,r,o,s,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=require("blend/events"),i=require("blend/animator"),o=require("blend/features"),t=require("pageControllers/base"),s=200,n=function(e){function t(e,n){var i;null==n&&(n={}),t.__super__.constructor.apply(this,arguments),this.pageMargin=null!=(i=n.pageMargin)?i:0}return l(t,e),t}(t),n.prototype.init=function(){return this.decelTimer=void 0,this.listen(window,"scroll",this.scroll.bind(this)),this.listen(window,"resize",this.resize.bind(this))},n.prototype.defaults=function(){var e;return e=n.__super__.defaults.apply(this,arguments),e.autosnap=!1,e},n.prototype.select=function(e,t,n){var r,o,s,a=this;return null==n&&(n=!0),o=function(){var t;return t=a.selectedIndex,a.onChange(t,e),a.animating=!1,a.selectedIndex=e},s=window.innerHeight*e,s+=this.pageMargin*e,this.onBeforeChange(this.selectedIndex,e),n?t?(this.animating=!0,r=i.create({from:window.pageYOffset,to:s,duration:.3,timing:"ease-in-out",step:function(e){return scrollTo(0,e)}}),r.run().then(function(){return setTimeout(o,100)})):(scrollTo(0,s),o()):o()},n.prototype.snap=function(e){var t,n;return n=window.pageYOffset/window.innerHeight,t=Math.round(n),this.select(t,e,this.autosnap)},n.prototype.scroll=function(){return this.animating?void 0:(this.onTrack(window.pageXOffset,window.pageYOffset),clearTimeout(this.decelTimer),this.decelTimer=setTimeout(this.snap.bind(this,!0),s))},n.prototype.resize=function(){return this.snap(!1)},e.exports=n}),require.define("pageControllers/slide",function(e){var t,n,i,r,o,s,a,l,u={}.hasOwnProperty,d=function(e,t){function n(){this.constructor=e}for(var i in t)u.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=require("blend/dom"),r=require("blend/events"),a=require("blend/lang"),o=require("blend/features"),s=require("blend/gestures"),t=require("pageControllers/panning"),n=function(e){function t(){return l=t.__super__.constructor.apply(this,arguments)}return d(t,e),t}(t),n.prototype.hidePage=function(e,t){return n.__super__.hidePage.apply(this,arguments),t>this.selectedIndex?this.translatePage(e,this.pageSize):this.translatePage(e,-this.pageSize)},n.prototype.updateTransition=function(e,t){var n;return this.reverse?(n="y"===this.axis?t:e,n-=this.pageSize,n=a.clamp(n,-this.pageSize,0),this.translate(n)):(n="y"===this.axis?t:e,n=a.clamp(n,-this.pageSize,0),this.translate(n))},n.prototype.translate=function(e){var t,n;return t=this.reverse?this.pageSize+e:e,n=this.reverse?e:this.pageSize+e,this.translatePage(this.fromPage,t),this.translatePage(this.toPage,n)},n.prototype.translatePage=function(e,t){return e.style[o.transform]="y"===this.axis?"translate3d(0,"+t+"px,0)":"translate3d("+t+"px,0,0)"},e.exports=n}),require.define("pageControllers/snap",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h={}.hasOwnProperty,f=function(e,t){function n(){this.constructor=e}for(var i in t)h.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("blend/dom"),d=require("blend/lang"),r=require("blend/animator"),s=require("blend/features"),c=require("blend/tick"),n=require("transitions/flip"),t=require("pageControllers/base"),u=200,l=.3,a=.45,i=function(e){function t(){return p=t.__super__.constructor.apply(this,arguments)}return f(t,e),t}(t),i.prototype.defaults=function(){var e;return e=i.__super__.defaults.apply(this,arguments),e.snapSelector=null,e.snapDistance=1/0,e.flipOnSelect=!1,e},i.prototype.init=function(){var e,t,i;return e="x",this.animation=null,this.maxOffsetX=null,this.lastOffsetX=window.pageXOffset,this.lastFlipTime=0,i="onmousewheel"in window?"mousewheel":"wheel",this.listen(document,i,this.mousewheel.bind(this)),this.listen(window,"scroll",this.scroll.bind(this)),this.flipOnSelect?(t=1e3*a,n.pregenerateKeyframes("x",t)):void 0},i.prototype.updatePages=function(){var e,t,n,i,r,s;for(e=this.count(),this.pageSize=this.page(0).getBoundingClientRect().width,this.maxOffsetX=this.pageSize*e,i=r=0,s=e-1;s>=0?s>=r:r>=s;i=s>=0?++r:--r)t=this.pageSize*i,n=this.page(i),n.style.left=""+t+"px",n.style.position="absolute";return this.snapElements=o.all(this.snapSelector,this.node)},i.prototype.select=function(e,t){var n;return null==t&&(t=!0),this.isValidIndex(e)?(n=this.flipOnSelect&&t,n?0===window.pageXOffset%this.pageSize?this.flip(e):this.snap(t,this.selectedIndex):this.snap(t,e)):void 0},i.prototype.mousewheel=function(e){var t,n,i,r,o;return e.preventDefault(),e.stopPropagation(),this.animation&&(this.animation.cancel(),this.animation=null),n=e.wheelDeltaX,i=e.wheelDeltaY,0>n&&(n*=.5),0>i&&(i*=.5),t=n||i,o=e.wheelDeltaX||e.wheelDeltaY,r=window.pageXOffset,r-=i,r-=n,r=d.clamp(r,0,this.maxOffsetX),scrollTo(r,0),Math.abs(o)<=10&&!this.reverse?this.snap():void 0},i.prototype.scroll=function(){var e;return this.reverse=window.pageXOffset<this.lastOffsetX,this.lastOffsetX=window.pageXOffset,e=Date.now()-this.lastFlipTime,!this.animation&&e>100?(clearTimeout(this.scrollEndTimer),this.scrollEndTimer=setTimeout(this.scrollEnded.bind(this),u)):void 0},i.prototype.scrollEnded=function(){return this.reverse?void 0:this.snap()},i.prototype.snap=function(e,t){var n,i,o,s,a,u,c,p,h,f,g,m,v=this;if(null==e&&(e=!0),this.animation&&(this.animation.cancel(),this.animation=null),"number"==typeof t)p=this.page(t),h="ease-in-out";else{for(c=1/0,p=null,m=this.snapElements,f=0,g=m.length;g>f;f++)a=m[f],o=a.getBoundingClientRect().left,o>0&&c>o&&(c=Math.abs(o),p=a);h="ease-out"}return p?(o=p.getBoundingClientRect().left,u=o+window.pageXOffset,i=Math.round(u/this.pageSize),i!==this.selectedIndex&&this.onBeforeChange(this.selectedIndex,i),s=1,s=.7+Math.abs(o)/this.pageSize,s=d.clamp(s,.8,1.5),n=l*s,e||(n=0),this.animating=!0,this.animation=r.create({duration:n,from:window.pageXOffset,to:u,timing:h,step:function(e){return scrollTo(e,0),v.onTrack(e,0)}}),this.animation.run().then(function(){var e;return e=function(){var e;return v.animating=!1,v.animation=null,i!==v.selectedIndex?(e=v.selectedIndex,v.selectedIndex=i,v.onChange(e,v.selectedIndex)):void 0},scrollTo(u,0),setTimeout(e,0)})):void 0},i.prototype.flip=function(e){var t;if(!this.animating)return this.animating=!0,this.transitioning=!0,this.fromPage=this.page(this.selectedIndex),this.toPage=this.page(e),this.reverse=e<this.selectedIndex,t={reverse:this.reverse,duration:1e3*a},this.flipTransition=new n(this.fromPage,this.toPage,t),this.flipTransition.on("transition:end",this.flipEnded.bind(this)),this.flipTransition.begin().finish()},i.prototype.flipEnded=function(e){var t,n,i;return this.flipTransition.destroy(),this.flipTransition=null,this.lastFlipTime=Date.now(),this.animating=!1,this.transitioning=!1,n=e.reverse?this.selectedIndex-1:this.selectedIndex+1,scrollTo(n*this.pageSize,0),this.select(n,!1),t=this.fromPage,i=this.toPage,this.fromPage=null,this.toPage=null,t.style[s.transform]="translate3d(0,0,0)",i.style[s.transform]="translate3d(0,0,0)",c(function(){return t.style.removeProperty(s.jsToCss(s.transform)),i.style.removeProperty(s.jsToCss(s.transform))})},e.exports=i}),require.define("pageControllers/stack",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var i in t)f.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=require("blend/dom"),r=require("blend/events"),c=require("blend/lang"),o=require("blend/features"),s=require("blend/gestures"),t=require("pageControllers/panning"),d=.385,u=.98,l=.6,a=!1,n=function(e){function t(){return h=t.__super__.constructor.apply(this,arguments)}return g(t,e),t}(t),p=-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),n.prototype.defaults=function(){var e;return e={animDuration:d},c.merge(e,n.__super__.defaults.apply(this,arguments))},n.prototype.transitionProperties=function(){return[o.transform,"opacity"]},n.prototype.hidePage=function(e,t){return n.__super__.hidePage.apply(this,arguments),p?t>this.selectedIndex?(e.style[o.transform]="scale("+u+","+u+")",e.style.opacity=l):(this.translatePage(e,-this.pageSize),e.style.opacity=1):void 0},n.prototype.beginTransition=function(e,t,i){var r;return n.__super__.beginTransition.apply(this,arguments),!this.transitioning&&a?(r=i?this.toPage:this.fromPage,r.style.boxShadow="0 0 30px rgba(0,0,0,0.3)"):void 0},n.prototype.updateTransition=function(e,t){var n,i,r,s;return s="y"===this.axis?t:e,this.reverse?(s-=this.pageSize,s=c.clamp(s,-this.pageSize,0),i=s/-this.pageSize,r=u+(1-u)*i,n=l+(1-l)*i,this.translatePage(this.toPage,s),this.fromPage.style[o.transform]="translate3d(0,0,0) scale("+r+","+r+")",this.fromPage.style.opacity=n):(s=c.clamp(s,-this.pageSize,0),i=s/-this.pageSize,r=u+(1-u)*i,n=l+(1-l)*i,this.translatePage(this.fromPage,s),this.toPage.style[o.transform]="translate3d(0,0,0) scale("+r+","+r+")",this.toPage.style.opacity=n)},n.prototype.transitionFinished=function(){var e;return a&&(e=this.reverse?this.toPage:this.fromPage,e.style.removeProperty("box-shadow")),n.__super__.transitionFinished.apply(this,arguments)},n.prototype.translatePage=function(e,t){return e.style[o.transform]="y"===this.axis?"translate3d(0,"+t+"px,0)":"translate3d("+t+"px,0,0)"},e.exports=n}),require.define("pageControllers",function(e,t){t.Base=require("pageControllers/base"),t.Flip=require("pageControllers/flip"),t.Scroll=require("pageControllers/scroll"),t.Slide=require("pageControllers/slide"),t.Snap=require("pageControllers/snap"),t.Stack=require("pageControllers/stack")}),require.define("ui/flipui",function(e){var t,n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L,A,F,M,R,z,D,O,B,U,H,G,j,X,W,Y,V,J,K,Q,Z=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};y=require("blend/events"),F=require("blend/lang"),s=require("blend/async"),b=require("blend/features"),I=require("blend/i18n"),q=require("blend/http"),h=require("blend/dom"),n=require("ui/lightBox"),i=require("ui/loading"),r=require("ui/message"),t=require("ui/alert"),c=require("pageControllers"),o=["twitter","facebook","renren","linkedin","googleplus","tumblr","weibo","tcweibo","qzone"],C=!1,H=null,d=null,D=null,z=0,X=null,M=null,m=!1,v=[],T=null,B=null,a=null,A=null,Q=null,R=null,U=q.parseQuery(window.location.search),g=function(e,t){return h.one(e,t||H)},f=function(e,t){return h.all(e,t||H)},_=function(){return H},N=function(){return C},L=function(e){return"private"===e},k=function(e,t){return null==e&&(e="#main"),null==t&&(t={}),C?void 0:(H="string"==typeof e?g(e):e,m=t.embedded||!1,R=new i({showText:!1}),T=g("#header h1"),B=g("#image-preview"),a=g("#caption"),A=g("input[name=itemId]"),Q=g("input[name=url]"),Y(t.data||[]),p(),P(),J(),C=!0)},V=function(e){return h.setInnerHTML(T,e.title||""),B.style.cssText=e.image?"background-image:url("+e.image+");display:block;":"display:none",a.value="",A.value=e.id||"",Q.value=e.url||""},Y=function(e){var t,n,i,r,s,a,l,u,d,c,p,h,m;if(D||(D=f(".magazines .magazine")),e.magazines)for(u=e.magazines,r=0,a=u.length;a>r;r++)n=u[r],S(n);for(c=null!=(d=e.services)?d:[],s=0,l=c.length;l>s;s++)i=c[s],p=i.service,Z.call(o,p)>=0&&E(i);return t=D[1],X=g(".magazines div[data-fl-mag-preselected=true]")||t,X&&(null!=(h=g("span.selected",X))&&h.classList.add("show"),!L(null!=X?X.getAttribute("data-fl-mag-visibility"):void 0))?null!=(m=g("#services"))?m.classList.remove("hide"):void 0:void 0},P=function(){v.push(y.on(g("#cancel"),"tap",l)),v.push(y.on(g("#create-magazine"),"tap",K)),v.push(y.delegate(g(".content"),".magazine","tap",G)),v.push(y.on(g("#services"),"tap",j)),v.push(y.on(g("#flipui-form"),"submit",x)),v.push(y.on(window,"resize",F.throttled(J,200)))},S=function(e,t){var n,i,r,o;return null==t&&(t=!1),n=g("#mag-tmpl").cloneNode(!0),n.removeAttribute("id"),n.setAttribute("data-fl-mag-target",e.magazineTarget),n.setAttribute("data-fl-mag-remoteid",e.remoteid),n.setAttribute("data-fl-mag-target",e.magazineTarget),n.setAttribute("data-fl-mag-title",e.title),n.setAttribute("data-fl-mag-visibility",e.magazineVisibility),e.image&&(n.style.backgroundImage="url("+e.image.smallURL+")"),h.setInnerHTML(g("span.name",n),F.htmlEncode(null!=(i=e.title)?i:"")),L(e.magazineVisibility)?null!=(r=g("span.private",n))&&(r.style.display="block"):null!=(o=g("span.private",n))&&(o.style.display="none"),t?D.splice(1,0,n):D.push(n),n},E=function(e){var t,n;return n=g("#services"),t=h.create('<div class="service-wrp">\n    <input type="checkbox" name="services" value="'+e.service+'" />\n    <span class="service '+e.service+'" data-fl-service="'+e.service+'"></span>\n    <p class="name">'+e.service+"</p>\n</div>"),n.appendChild(t),t},O=function(){var e,t,n,i,r,o,s,a,l,u,d,c,p,m;for(t=H.style.display,H.style.display="block",H.style.visibility="hidden",e=g("#magazines-ctr"),l=e.getBoundingClientRect().width,n=g(".magazines .magazine"),n.style.display="block",a=getComputedStyle(n),o=n.getBoundingClientRect().width+parseInt(a.marginRight,10),n.style.removeProperty("display"),z=Math.floor(l/o),m=f(".magazines"),u=0,c=m.length;c>u;u++)s=m[u],h.remove(s);for(i=d=0,p=D.length;p>d;i=++d)r=D[i],0===i%z&&(s=document.createElement("div"),s.className="magazines",e.appendChild(s)),s.appendChild(r);return H.style.display=t,H.style.removeProperty("visibility")},J=function(){var e,t,n,i,r,o,s,a,l,u,p,h;if(d&&(d=null),O(),s=f(".magazines"),u=function(){var e,t,n,i,r,o;for(n=g("#pages ul");n.hasChildNodes();)n.removeChild(n.lastChild);if(!(s.length>17)){for(o=[],e=i=0,r=s.length-1;r>=i;e=i+=1)t=document.createElement("li"),t.className="page",o.push(n.appendChild(t));return o}}(),t=function(e){return s[e]},e=function(){return s.length},o=function(e){var t,n,i,r,o;return n=g("#prev"),t=g("#next"),t.style.display="block",n.style.display="block",e.index===d.getCount()-1&&(t.style.display="none"),0===e.index&&(n.style.display="none"),i=f("#pages .page"),null!=(r=i[e.prevIndex])&&r.classList.remove("active"),null!=(o=i[e.index])?o.classList.add("active"):void 0},l=function(){var e;return d.selectedIndex>0?(e=Math.max(d.selectedIndex-1,0),d.select(e,!0)):void 0},a=function(){var e;return d.selectedIndex<d.getCount()-1?(e=Math.min(d.selectedIndex+1,d.getCount()),d.select(e,!0)):void 0},r={getPage:t,getCount:e,pageMargin:20,axis:"x",mouseInput:!0},d=new c.Slide("#magazines-ctr",r),d.on("page:change",o.bind()),d.init(),n=0,X)for(n=p=0,h=D.length;h>p&&(i=D[n],(null!=X?X.getAttribute("data-fl-mag-target"):void 0)!==i.getAttribute("data-fl-mag-target"));n=++p);return d.select(Math.ceil((n+1)/z-1)),y.on("#prev","tap",l),y.on("#next","tap",a),m?void 0:y.on(document.body,"keydown",function(e){var t;if(-1===["textarea","input","select"].indexOf(e.target.tagName.toLowerCase()))return e.keyCode>=48&&e.keyCode<=57&&(t=e.keyCode-49,t=48===e.keyCode?9:t,d.select(t,!0)),37===e.keyCode&&l(),39===e.keyCode?a():void 0})},x=function(e){var n,i,o,s,a,u,d,c,p,h,g,m,v,y,b,x;if(e.preventDefault(),H.appendChild(R.node),n=!1,R.show(),null!==X){for(a={},a.target=null!=(y=null!=X?X.getAttribute("data-fl-mag-target"):void 0)?y:"",b=f("input[type=hidden], textarea",this),h=0,m=b.length;m>h;h++)o=b[h],a[o.getAttribute("name")]=o.value;for(d=[],x=f("input[name=services]"),g=0,v=x.length;v>g;g++)u=x[g],u.checked&&d.push(u.value);return a.services=d.join(","),c=function(e){var t,i;if(n=!0,R.hide(),clearTimeout(p),e.success)return i=I.t("flipped_into_format",'<em style="font-style:normal;text-decoration:underline;text-overflow:ellipsis">'+(F.htmlEncode(null!=X?X.getAttribute("data-fl-mag-title"):void 0)||"")+"</em>"),i=i.replace("$s",""),t=new r({text:i}),document.body.appendChild(t.node),l(),t.show().fadeOut(1e3);throw new Error("Can't flip ("+e.errorcode+")")},i=function(e){return R.hide(),n=!1,clearTimeout(p),l(),t.message(I.t("FLIP_ERROR_TITLE"),I.t("FLIP_ERROR_GENERIC"))},s={path:"/flip/share",params:a},p=setTimeout(function(){return n?void 0:i(new Error("request timeout."))},2e4),q.post(s).then(c,i)}},G=function(e){var t,n,i,r,o,s,a,l,u,d,c,p,m,v;if(s=e.target,r=s.classList.contains("magazine")?s:h.ancestorByClassName(s,"magazine"),r&&r.hasAttribute("data-fl-mag-target")){if(null!=(c=g(".selected",X))&&c.classList.remove("show"),null!=(p=g(".selected",r))&&p.classList.add("show"),X=r,o=g("#services"),L(r.getAttribute("data-fl-mag-visibility"))){for(o.classList.add("hide"),t=f(".service.active",o),a=0,u=t.length;u>a;a++)i=t[a],i.classList.remove("active");for(m=f("input[name=services]"),v=[],l=0,d=m.length;d>l;l++)n=m[l],v.push(n.checked=!1);return v}return o.classList.remove("hide")}},j=function(e){var t,n;return e.stopPropagation(),n=e.target,n.classList.contains("service")?(n.classList.toggle("active"),t=g("input[value="+n.getAttribute("data-fl-service")+"]"),t.checked=n.classList.contains("active")?!0:!1):void 0},W=function(e){return parent.postMessage?parent.postMessage(e,"*"):void 0},p=function(){var e,t,n;for(t=0,n=v.length;n>t;t++)e=v[t],e.detach();return v=[]},l=function(e){return e&&(e.preventDefault(),e.stopPropagation()),m?w.emit("flipui:done"):window.close()},K=function(){var e,t,i,r,o,s,a,l;return o=g(".fl-magazine-form"),r=g("#magazine-form",o),a=g("[name=title]",r),i=g("[name=description]",r),e=g("[name=category]",r),l=g("[name=visibility]",r),a.value="",i.value="",e[0].selected=!0,l.checked=!1,M=new n(o,{hostNode:H,overlayAlpha:.5}),M.on("lightbox:closed",function(){return"undefined"!=typeof t&&null!==t&&t.detach(),"undefined"!=typeof s&&null!==s?s.detach():void 0}),t=y.on(".fl-magazine-form #close","tap",M.close),s=y.on(r,"submit",u)},u=function(e){var n,i,r,o,s,a,l,u,d,c;return e.preventDefault(),r=!1,g(".fl-magazine-form").appendChild(R.node),R.show(),M.freeze(),s=g("#magazine-form",H),d=g("[name=title]",s),i=g("[name=description]",s),n=g("[name=category]",s),c=g("[name=visibility]",s),a={path:"/api/curator/createMagazine",params:{title:d.value,description:i.value,magazineCategory:n.value,magazineVisibility:c.checked?"private":"public"}},l=function(e){var t;if(r=!0,console.log(e),clearTimeout(u),R.hide(),e.success&&e.magazine)return t=S(e.magazine,!0),G({target:t}),J(),M.close();throw new Error("Can't create magazine")},o=function(e){return r=!0,clearTimeout(u),R.hide(),M.close(),a={overlayAlpha:.4,title:I.t("create_magazine_error_title"),message:I.t("create_magazine_error_message")},new t(a).render()},u=setTimeout(function(){return r?void 0:o(new Error("request timeout."))},2e4),q.post(a).then(l,o)},w={},w.init=k,w.isInitialized=N,w.getRootNode=_,w.setItem=V,w.detachEvents=p,F.mixin(w,y.Emitter),e.exports=w}),require.define("blend/date",function(e,t){var n,i,r,o,s,a,l,u,d;u=require("blend/i18n"),s=1,r=60*s,i=60*r,n=24*i,a=7*n,o=30*n,l=364.25*n,d=[[s,"TIME_AGO_FORMAT_JUST_NOW"],[r,"TIME_AGO_FORMAT_MINUTE"],[i,"TIME_AGO_FORMAT_HOUR"],[n,"TIME_AGO_FORMAT_DAY"],[a,"TIME_AGO_FORMAT_WEEK"],[o,"TIME_AGO_FORMAT_MONTH"],[l,"TIME_AGO_FORMAT_YEAR"]],t.timeAgoInWords=function(e){var t,n,i,r,o,s,a,l,c,p,h;for(s="number"==typeof e?e:e.getTime()/1e3,t=Date.now()/1e3-s,i=a=0,l=d.length;l>a;i=++a)if(c=d[i],o=c[0],r=c[1],n=null!=(p=null!=(h=d[i+1])?h[0]:void 0)?p:Number.MAX_VALUE,t>=o&&n>=t)return u.t(r,Math.floor(t/o))}}),require.define("duplo/utils",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h;l=require("blend/lang"),i=function(e){return!1},s=function(e){return"post"===e.type||"photo"===e.type||"status"===e.type||"album"===e.type||"video"===e.type||"magazine"===e.type},r=function(e){return"video"===e.type?e.posterImage:e.image||e.inlineImage||{}},o=function(e){return e?e.largeURL||e.mediumURL||e.smallURL||null:null},h=function(e,t){var n,i,r,o,s,a;if(null!=e.route)return h(e.route,t);if(i=t(e),!i&&null!=e.children){for(s=e.children,a=[],r=0,o=s.length;o>r;r++)n=s[r],a.push(h(n,t));
return a}},a=function(e){var t;return t=e.itemdict,t.image.length+t.post.length+t.status.length+t.video.length+t.magazine.length},p=function(e){var t,n,i,r;return n=e.pageFrame[2],t=e.pageFrame[3],n>=552&&t>400&&((null!=e?null!=(i=e.section)?i.title:void 0:void 0)||(null!=e?null!=(r=e.section)?r.authorDisplayName:void 0:void 0))},d=function(){return!1},c=function(e){return p(e)&&"normal"===(null!=e?e.pageStyle.style:void 0)},u=function(e){return d(e)&&"normal"===(null!=e?e.pageStyle.style:void 0)},n=function(e){var t,n,i,r;t={};for(r in e)if("itemdict"===r){i={};for(n in e.itemdict)e.itemdict.hasOwnProperty(n)&&(i[n]=l.arrayCopy(e.itemdict[n]));t.itemdict=i}else e.hasOwnProperty(r)&&(t[r]=e[r]);return t},t.walkTree=h,t.imageForItem=r,t.imageURLForImage=o,t.copyContext=n,t.isItem=s,t.itemsLeft=a,t.shouldShowHeaderForPage=c,t.shouldShowFooterForPage=u,t.hasTestFeature=i}),require.define("duplo/layouts",function(e,t){var n,i,r,o,s,a,l,u,d,c;c=require("duplo/utils"),a=c.hasTestFeature,n=20,u=400,l=function(e,t,n){var i;return i=o(t),1===i||2===i&&u>n?[12,10,12,10]:2===i||3===i?[24,59,24,40]:[32,72,32,64]},o=function(e){var t,n;return n=256,t=350,2*n>e?1:Math.max(Math.ceil(e/t),1)},i=function(e){var t;return t=o(e),30},r=function(e){return.5*i(e)},d=function(e,t){var n,i,r,o,s,a,l,u,d;for(r=t,o=0,a=0,u=e.length;u>a;a++)s=e[a],"string"==typeof s?(n=Number(s),r-=n):o+=s;for(i=[],l=0,d=e.length;d>l;l++)s=e[l],"string"==typeof s?(n=Number(s),i.push(n)):i.push(s*r/o);return i},s=function(e,t){var n,i,r,s,l,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L,A,F,M,R,z,D,O,B,U,H,G,j,X,W,Y,V,J,K,Q,Z,$,et,tt,nt,it,rt,ot,st,at,lt,ut,dt,ct,pt,ht,ft,gt,mt,vt,yt,bt,xt,wt,_t,Tt,qt,It,kt,Pt,Ct,St,Et,Nt,Lt,At,Ft,Mt,Rt,zt,Dt,Ot,Bt,Ut,Ht,Gt,jt,Xt,Wt,Yt,Vt,Jt,Kt,Qt,Zt,$t,en,tn,nn,rn,on,sn,an,ln,un,dn,cn,pn,hn;if(n=function(e,t,n,i,r){var o;return null==t&&(t=function(){var t,n,i;for(i=[],t=0,n=e.length;n>t;t++)o=e[t],i.push(1);return i}()),{flow:n,children:e,weights:t,type:i,styles:r}},y=function(e,t,i,r){return n(e,t,"hbox",i,r)},Ht=function(e,t,i,r){return n(e,t,"vbox",i,r)},b=function(e,t,n){return y(e,t,n,{rules:!0})},Gt=function(e,t,n){return Ht(e,t,n,{rules:!0})},G={style:"photo"},S={style:"normal"},i=function(e){return{routes:e}},wt={type:"title"},_t=function(e){return{type:"title",styles:{"no-padding":!0,headline:e}}},qt=_t(36),Tt=_t(48),kt={type:"title",styles:{headline:60}},mt={type:"excerpt"},x={type:"image-viewport"},j={type:"photo"},ft={type:"status"},T={type:"magazine"},Pt={type:"titletext"},Ft={type:"titletext",styles:{"no-padding":!0}},pt={type:"postattribution"},yt={type:"titleimage",attributionClasses:"nomargin"},zt={type:"titletext",styles:{"no-padding":!0,headline:24}},Dt={type:"titletext",styles:{"no-padding":!0,headline:24},excerptClasses:"nobreaks"},Ot={type:"titletext",styles:{headline:24},excerptClasses:"nobreaks"},Nt={type:"titletext",styles:{"no-padding":!0,headline:36}},Lt={type:"titletext",styles:{"no-padding":!0,headline:36},excerptClasses:"nobreaks"},At={type:"titletext",styles:{headline:36}},Ct={type:"titletext",styles:{"no-padding":!0,headline:48}},St={type:"titletext",styles:{"no-padding":!0,headline:48},excerptClasses:"nobreaks"},Et={type:"titletext",styles:{headline:48}},xt={type:"titleimage",styles:{"no-padding":!0,headline:24},attributionClasses:"nomargin"},It={type:"title",styles:{"no-padding":!0,headline:48,"no-attribution":!0}},Rt={type:"titletext",styles:{"no-attribution":!0,headline:24}},Mt={type:"titletext",styles:{"no-attribution":!0,"no-padding":!0,headline:24}},bt={type:"titleimage",styles:{"no-attribution":!0},bleed:"top left right"},Vt={type:"video"},w=function(e){return{type:"image-viewport",bleed:e}},q=function(e){return[].concat.apply([],e)},c=function(e,t){return t.name=e,t},l=e.contentFrame[3],X="40",U=[c("phonePostLayouts_a",Ht([w("top left right"),Mt,pt],d([1,1,X],l),"post")),c("phonePostLayouts_b",Ht([w("top left right"),It,pt],d([11,3,X],l),"post")),c("phonePostLayouts_c",Ht([bt,pt],d([1,X],l),"post")),c("phonePostLayouts_d",Ht([Rt,pt],d([1,X],l),"post"))],O=[c("phonePostLayouts_e",y([Ht([It,pt],d([1,X],l)),mt],[1,1],"post")),c("phonePostLayouts_f",y([w("top bottom left"),Ht([Mt,pt],d([1,X],l))],[5,6],"post"))],I=c("mixedphotos_twostack",Ht([Ht([xt],[1],"post"),Ht([xt],[1],"post")])),rt=c("post_onecolumn_vertical",i([Ht([x,Nt],[35,65],"post"),Ht([x,Nt],[65,35],"post"),Ht([At],[1],"post"),I,Gt([Ht([x,Dt],[1,1],"post"),Ht([x,Dt],[1,1],"post")]),Ht([Ht([xt],[1],"post"),Ht([xt],[1],"post"),Ht([xt],[1],"post")]),Gt([i([Ht([Dt],[1],"post"),Ht([x,Dt],[1,1],"post")]),Ht([Dt],[1],"post")]),Gt([Ht([Dt],[1],"post"),Ht([Ot],[1],"post"),Ht([Ot],[1],"post")])])),dt=c("post_twocolumn_tee",Ht([x,y([Tt,mt])],null,"post")),at=c("post_twocolumn_cee",y([x,Pt],[5,3],"post")),lt=c("post_twocolumn_cee_reverse",y([kt,x],[3,5],"post")),ut=c("post_twocolumn_imageonly",i([Ht([yt],[1],"post"),Ht([qt,x],[25,75],"post")])),ct=c("post_twocolumn_threestack",i([Gt([y([x,Dt],[16,10],"post"),y([x,Dt],[16,10],"post"),y([x,Dt],[16,10],"post")]),Gt([y([qt,mt],[2,2],"post"),y([qt,mt],[2,2],"post"),y([qt,mt],[2,2],"post")])])),ot=c("post_threecolumn_cee",y([x,Et],[2,1],"post")),st=c("post_threecolumn_tee",Ht([w("top"),y([Tt,mt],[1,1])],[3,1],"post")),k=c("multipost_onecolumn_wimages",Gt([Ht([x,Dt],[1,1],"post"),Ht([x,Dt],[1,1],"post")])),P=c("multipost_twocolumn_onetwo",b([rt,rt])),C=c("multipost_twocolumn_textonly",i([b([Ht([At],[1],"post"),i([Ht([At],[1],"post"),Gt([Ht([Dt],[1],"post"),Ht([Dt],[1],"post")])])]),Gt([y([At,mt],[2,2],"post"),y([At,mt],[2,2],"post")])])),Yt=c("video_twocolumn_twostack",Gt([Vt,Vt])),Xt=c("video_twocolumn",Gt([Vt,y([x,Pt],[1,1],"post")],[60,40])),Wt=c("video_twocolumn_tee",Gt([Vt,b([i([Ht([zt],null,"post"),Ht([x,Dt],[1,1],"post")]),i([Ht([zt],null,"post"),Ht([x,Dt],[1,1],"post")])])])),jt=c("video_threecolumn_two_one",Gt([Vt,i([b([y([x,Pt],null,"post"),Ht([Pt],null,"post")],[2,1]),y([x,Pt],[1,1],"post")])],[60,40])),N=[j,Vt,Ht([j,j])],Ut=[y([j,j])],gt=[y([j,Ht([j,j],[40,60])],[10,6]),y([Ht([j,j,j]),j],[4,12]),y([j,j],[7,9]),y([Ht([j,j]),j],[7,9]),y([Ht([j,j]),Ht([j,j])]),y([Ht([j,j]),Ht([j,j,j])],[10,6]),y([j,j,j]),y([j,j,Ht([j,j])])],g=[y([j,Ht([j,j]),Ht([j,j])],[2,1,1]),y([j,Ht([j,j])],[2,2]),y([Ht([j,j]),j],[2,2])],h=[y([j,Ht([j,j]),Ht([j,j,j])],[2,2,1])],L=[c("status_box",ft)],E=[rt],Bt=[ct,dt,P,Xt,Wt,Yt,I,C,c("post_four_magazines",b([Ht([T,T]),Ht([T,T])]))],vt=[st,ot,c("post_threecolumn_a",b([Ht([x,Ft],[55,45],"post"),Ht([x,y([Tt,mt])],[55,45],"post")],[1,2])),c("post_threecolumn_b",b([i([k,rt]),i([dt,ct])],[1,2])),c("post_threecolumn_c",b([i([I,dt]),i([k,rt])],[2,1])),jt,c("post_six_magazines",b([Ht([T,T]),Ht([T,T]),Ht([T,T])]))],Q=c("post_fourcolumn_a",b([i([st,ot]),i([rt,k])],[3,1])),Z=c("post_fourcolumn_a_reverse",b([i([rt,k]),i([st,ot])],[1,3])),$=c("post_fourcolumn_b",b([i([dt]),i([dt,I,Xt,Wt,Yt])])),et=c("post_fourcolumn_c",b([dt,i([ct,I,C])]),[2,2]),tt=c("post_fourcolumn_c_reverse",b([i([ct,I,C]),dt]),[2,2]),nt=c("post_fourcolumn_e",b([dt,i([Xt,Wt,Yt,ct,P])],[2,2])),it=c("post_fourcolumn_z",b([rt,rt,rt,rt],[1,1,1,1])),f=[Q,Z,$,et,tt,nt,c("post_eight_magazines",b([Ht([T,T]),Ht([T,T]),Ht([T,T]),Ht([T,T])]))],W=c("post_fivcol_a",b([dt,i([ct,dt,I,Xt,Wt,Yt,C]),i([rt])],[2,2,1])),Y=c("post_fivecol_a_reverse",b([i([rt]),i([ct,dt,I,Xt,Wt,Yt,C]),dt],[1,2,2])),V=c("post_fivecol_b",b([i([Q,Z]),i([rt,k])],[4,1])),J=c("post_fivecol_c",b([i([st,ot]),i([dt,P,Xt,Wt,Yt,C])],[3,2])),K=c("post_fivecol_c_reverse",b([i([dt,P,Xt,Wt,Yt,C]),i([st,ot])],[2,3])),p=[W,Y,V,J,K],ht=[c("post_sixxxxxxxxxxxxxxxxxxxxxxcol_b",b([i([ot,st]),i([dt,I,Xt,Wt,Yt,C]),rt],[3,2,1])),c("post_sixxxxxxxxxxxxxxxxxxxxxxcol_c",b([i([ot,st]),i([ot,st])],[3,3])),c("post_sixxxxxxxxxxxxxxxxxxxxxxcol_a",b([i([dt,I,Xt,Wt,Yt,C]),i([dt,I,Xt,Wt,Yt]),i([ct,dt,I,Xt,Wt,Yt,C])],[2,2,2])),c("post_sixxxxxxxxxxxxxxxxxxxxxxcol_a_reverse",b([i([dt,I,Xt,Wt,Yt]),i([ct,dt,I,Xt,Wt,Yt]),i([dt,I,Xt,Wt,Yt,C])],[2,2,2]))],r={1:E,2:Bt,3:vt,4:f,5:p,6:ht},H=q([N,Ut,g,h,gt]),B=q([N]),D=Ut,un=e.pageFrame,M=un[0],R=un[1],F=un[2],A=un[3],s=o(F),z=function(e,t,n){var i,r,o,s,a;if(t.length>0){for(i=t[0],a=[],o=0,s=i.length;s>o;o++)r=i[o],a.push(z(e.concat(r),t.slice(1),n));return a}return n(e)},m=function(e){var t,n,i,o,s,a;for(o=[],s=[],n=e;n>0;){for(i=!1,t=a=n;1>=n?1>=a:a>=1;t=1>=n?++a:--a)if(r[t]){o.push(r[t]),s.push(t),n-=t,i=!0;break}if(!i)break}return[o,s]},1===s||a("forcePhone")){for(Kt=0,en=B.length;en>Kt;Kt++)_=B[Kt],t(G,_);for(Qt=0,tn=U.length;tn>Qt;Qt++)_=U[Qt],t(S,_);for(pn=[],Zt=0,nn=L.length;nn>Zt;Zt++)_=L[Zt],pn.push(t(S,_));return pn}if(2===s&&u>=A||a("forcePhone")){for($t=0,rn=D.length;rn>$t;$t++)_=D[$t],t(G,_);for(hn=[],an=0,on=O.length;on>an;an++)_=O[an],hn.push(t(S,_));return hn}if(s>1){for(ln=0,sn=H.length;sn>ln;ln++)_=H[ln],t(G,_);return dn=m(s),v=dn[0],Jt=dn[1],z([],v,function(e){return t(S,b(e,Jt))}),cn=m(s-1),v=cn[0],Jt=cn[1],v.push(L),Jt.push(1),z([],v,function(e){return t(S,b(e,Jt))})}},t.insetsForPage=l,t.enumerateLayouts=s,t.columnHalfGap=r,t.columnsForPageWidth=o,t.baselineGap=n,t.baselineHalfGap=.5*n}),require.define("duplo/gridFitter",function(e,t){var n,i,r,o,s;i=require("blend/dom"),r=!1,n=function(e,t){var n,i,r;for(i=0,r=0,n=e.length;r!==n&&(i=(n+r)/2,i=0>i?Math.ceil(i):Math.floor(i),i!==r);)t(e[i])>0?n=i:r=i;return e[r]},o=function(e){var t,n,i,r,o,s,a;for(n=[],i=/(\s*[\S\u00ad]*)/g,t=0,o=e.split(i),s=0,a=o.length;a>s;s++)r=o[s],t+=r.length,i.test(r)&&n.push(t);return n},s=function(e){var t;for(t=[],e=e.firstChild;e;)3===e.nodeType?t.push(e):t=t.concat(s(e)),e=e.nextSibling;return t},t.gridFit=function(e){var t,n,r,o,s,a,l;for(null==e&&(e=document.body),n=i.all("[data-fl-grid-fit]",e),l=[],s=0,a=n.length;a>s;s++)e=n[s],e.setAttribute("data-fl-grid-fitted",""),o=Number(e.getAttribute("data-fl-grid-fit")),e.removeAttribute("data-fl-grid-fit"),r=e.getBoundingClientRect(),t=Math.ceil(r.height/o)*o,l.push(e.style.height=t+"px");return l},t.headlineFit=function(e){var t,r,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w;for(null==e&&(e=document.body),g=i.all("[data-fl-headline-fit]",e),w=[],b=0,x=g.length;x>b;b++){for(f=g[b],f.setAttribute("data-fl-headline-fitted",""),f.removeAttribute("data-fl-headline-fit"),m=f.parentNode.getBoundingClientRect(),c=["headline-60","headline-48","headline-36","headline-24"];c.length>0&&f.classList.contains(c[0]);)c.shift();for(p=f.nextSibling,h=p?p.getBoundingClientRect().height:0,u=function(e){var t,n,i,r;return i=e.getBoundingClientRect(),r=i.height+h>m.height,t=i.height/i.width>=1.6,n=e.scrollWidth>e.offsetWidth,r||t||n};c.length>0&&u(f);)d=c.shift(),f.className=d;u(f)&&f.firstChild?(t=s(f),t.length>0?(y=t[0],v=y.nodeValue,r=function(e){return y.nodeValue=v.substr(0,e)+"…",u(f)?1:-1},a=n(o(v),r),w.push(l=r(a))):w.push(void 0)):w.push(void 0)}return w}}),require.define("reporting",function(e,t){var n,i;n=require("blend/http"),i=function(e,t,i,r,o,s){var a;return a={url:"/report",headers:{"Content-Type":"application/json;charset=utf-8"},params:{email:e,summary:t,description:i,debugInfo:r,reproducibility:o,userAgent:s}},n.post(a).then(function(e){return console.log(e)})},t.reportBug=i}),require.define("duplo/bugReporter",function(e,t){var n,i,r,o,s,a,l,u,d;r=require("blend/dom"),o=require("blend/http"),s=require("blend/lang"),l=require("reporting"),d=require("duplo/utils"),n={},i=null,u=function(e,t,i){return n[i.pageNumber]={layout:s.deepCopy(e),contextBefore:t,contextAfter:d.copyContext(i)}},a=function(e){var t,o,s,u;return s=Number(e.getAttribute("data-fl-page-number")),t=function(){return i.parentNode.removeChild(i),i=null},a=function(){var e,r,o,a;return r=i.querySelector("input#reporter").value,o=i.querySelector("input#summary").value,e=i.querySelector("textarea#description").value,a=i.querySelector("select").value,l.reportBug(r,o,e,JSON.stringify(n[s]),a,navigator.userAgent),t()},i?(t(),void 0):(i=r.create('<div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;">\n    <div class="overlay" style="position: absolute; top: 0; left: 0; bottom: 0; right: 0; background-color: rgba(0, 0, 0, 0.8);"></div>\n    <div class="" style="position: absolute; right:25%; left:25%; top:15%; background-color: white; padding: 20px; border-radius: 15px;">\n        <h1>Report Bug</h1>\n            <span style="float: left; width:92px;">Reporter</span><input type="text" id="reporter" name="reporter" size="42" placeholder="JIRA account e-mail address"><br/>\n            <span style="float: left; width:92px;">Summary</span><input type="text" size="74" id="summary" name="summary" placeholder="Short summary of the problem"><br/>\n            <span style="float: left; width:92px;">Reproducibility</span>\n            <select>\n              <option value="10920">Don\'t know</option>\n              <option value="10921">Easy to reproduce</option>\n              <option value="10922">Sometimes able to reproduce</option>\n              <option value="10923">Difficult to reproduce</option>\n            </select><br/>\n            <span style="float: left; width:92px;">Description</span>\n            <textarea id="description" style="width: 100%; height: 60px;" placeholder="Enter a description"></textarea>\n        </p>\n        <textarea id="debugInfo" style="width: 100%; height: 200px;"></textarea><br/>\n        <p>\n            <input id="bugReportButton" style="float:right;" type="submit" value="Report Bug">\n        </p>\n\n    </div>\n</div>'),i.querySelector(".overlay").addEventListener("click",t,!1),i.querySelector("#bugReportButton").addEventListener("click",a,!1),u=i.querySelector("textarea#debugInfo"),document.body.appendChild(i),r.setInnerHTML(u,JSON.stringify(n[s])),o=function(){return u.select(),!1},u.addEventListener("click",o,!1))},t.reportBug=a,t.setDebugInfo=u}),require.define("blend/cookie",function(e,t){var n,i,r;r=function(e){return e.replace(/^\s+|\s+$/g,"")},n=function(e){var t,n,i,o;for(e+="=",o=document.cookie.split(";"),n=0,i=o.length;i>n;n++)if(t=o[n],t=r(t),0===t.indexOf(e))return t.substring(e.length,t.length);return null},i=function(e,t){return document.cookie=""+e+"="+t+"; path=/"},t.get=n,t.set=i}),require.define("models/user",function(e,t){var n,i,r,o,s,a;a=require("blend/lang"),o=require("blend/events"),s=require("blend/http"),i=require("blend/cookie"),r=null,n=function(){function e(){this.userId=0,this.name="",this.email="",this.loaded=!1,this.profileImage=null,this.description="",this.magazines=[],this.signintime=i.get("ts")}return e.prototype.isSignedIn=function(){return 0!==this.userId&&Number(this.userId)===Number(i.get("userid"))},e.prototype.isSignedOut=function(){return this.sigintime!==i.get("ts")||this.userId!==i.get("userid")},e.prototype.hasMagazines=function(){return this.magazines.length>0},e.prototype.loadUserInfo=function(){var e,t,n=this;return i.get("userid")?(e=function(e){return n.emit("loaduser:failed")},t={path:"/api/flipboard/userInfo"},s.get(t).then(function(t){var i,r,o,s,a,l;return n.loaded=!0,t.success?(s=null!=t?t.userInfo:void 0,s?(o=null!=(a=s.myServices)?a:{},(i=null!=(l=function(){var e,t,n;for(n=[],e=0,t=o.length;t>e;e++)r=o[e],"flipboard"===r.service&&n.push(r);return n}())?l[0]:void 0)?(n.description=i.description,n.name=i.name,n.profileImage=i.profileImage,n.email=i.email,n.contributorMagazines=s.contributorMagazines,n.userId=s.userid,n.magazines=s.magazines,n.services=o,n.emit("loaduser:done")):(e(new Error("server didn't return flipboard account info")),void 0)):e(new Error("server didn't return user info"))):(n.emit("loaduser:done"),void 0)},e),this):(this.emit("loaduser:done"),void 0)},e}(),a.mixin(n,o.Emitter),t.User=n,t.current=function(){return r||(r=new n),r}}),require.define("tracker",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g;l=require("blend/http"),i=require("blend/async"),r=require("blend/cookie"),d=!0,c="track.flipboard.com",h=void 0,o=void 0,s=void 0,n=1,p=function(e){var t,r,o,s,a;return r=i.defer(),o=document.createElement("script"),null==(a=e.params)&&(e.params={}),e.params.jsonp=1,t="jsonpcallback"+n,e.params.callback=t,window[t]=function(e){return r.resolve(e),r=void 0,document.getElementsByTagName("head")[0].removeChild(o),delete window[t]},n+=1,s=e.url+l.stringifyQuery(e.params),o.src=s,document.getElementsByTagName("head")[0].appendChild(o),r.promise},u=function(){var e,t,n;return o||(n=r.get("sessionCookie"),n?(h=JSON.parse(n),e=i.defer(),e.resolve(),o=e.promise):(t={url:""+window.location.protocol+"//"+c+"/setcookie"},o=p(t),o.then(function(e){return h=e,r.set("sessionCookie",JSON.stringify(h))}))),o},g=function(e,t){return null==t&&(t={}),u().then(function(){var n,i,o;return n={event_action:e,event_category:"section",prod_type:"webmag",event_data:t,properties:{time:Math.round(Date.now()/1e3),unique_id:r.unique_id,session_id:r.session_id}},i={params:{data:JSON.stringify(n)},url:""+window.location.protocol+"//"+c+"/usage"},d&&null!=i&&null!=(o=i.params)&&(o.test=1),p(i)})},a=function(e,t){var n,i;return null==t&&(t=void 0),n=null!=(i=window._gaq)?i:window._gaq=[],n.push(["_trackEvent",e,s,t])},f=function(e){var t,n,i;return t=Date.now(),s=e,i=0,n=function(){var r,o,s;return r=Date.now(),s=r-t,g("timer",{section_id:e,duration:s}).then(function(){},function(){return i+=1}),0===i?(o=6e4>s?5e3:15e3,setTimeout(n,o)):void 0},n()},t.trackEvent=g,t.gaTrackEvent=a,t.startHeartbeatTracking=f}),require.define("flipButton",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I;d=require("blend/dom"),c=require("blend/events"),f=require("blend/http"),g=require("blend/i18n"),I=require("models/user"),i=require("ui/lightBox"),q=require("tracker"),p=require("ui/flipui"),r=require("ui/loading"),n=require("ui/alert"),h=null,x=null,l=null,v=null,a=null,_=!1,w=f.parseQuery(window.location.search),T=function(){return n.message(g.t("ERROR"),g.t("SERVER_UNABLE_TO_SERVICE_YOUR_REQUEST"))},y=function(){var e,t,r,o,s;return x.hide(),l.off("loaduser:done",y),l.isSignedIn()?(p.isInitialized()||(r={embedded:!0,data:{magazines:l.contributorMagazines?null!=(s=l.magazines)?s.concat(l.contributorMagazines):void 0:l.magazines,services:l.services}},p.init(h,r)),(y=function(){var e,t;return p.setItem(v),t=new i(p.getRootNode()),t.on("lightbox:closed",function(){return t=null,p.off("flipui:done",e)}),e=function(){return t.close()},p.on("flipui:done",e)})()):(o=g.t("PLEASE_SIGN_IN"),e=g.t("SIGN_IN_PROMPT"),t=g.t("sign_in"),n.confirm(o,e,null,t).then(function(e){return e?window.location.href="/login?done="+encodeURIComponent(window.location.href+("#item:"+v.id)):void 0}),void 0)},b=function(){return x.hide(),T(),_=!0,l.off("loaduser:failed",b)},o=function(){return x||(x=new r,document.body.appendChild(x.node)),l=I.current(),!l.loaded||_?(x.show(),l.on("loaduser:done",y),l.on("loaduser:failed",b),l.loadUserInfo()):y()},s=function(e){var t;return t=e.relatedTarget,e.stopPropagation(),e.preventDefault(),v={id:t.getAttribute("data-fl-item-id"),image:t.getAttribute("data-fl-item-image"),title:t.getAttribute("data-fl-item-title"),url:t.getAttribute("data-fl-item-url")},v.id&&v.url&&(q.gaTrackEvent("flipButton",v.id),o()),!1},m=function(e,t){var n;return t?(a||(h=d.one(t),console.log("flipButton",h),n=document.documentElement,a=c.delegate(n,e,"tap",s)),void 0):(console.warn("need flipui selector"),void 0)},u=function(){return null!=a&&a.detach(),null!=p?p.detachEvents():void 0},t.init=m,t.destroy=u}),require.define("blend/cache",function(e,t){var n;t.create=function(e){return new n(e)},n=function(){function e(e){if(null==e&&(e={}),!e.key)throw new Error("Must provide a key when initializing a cache");this.key=e.key,localStorage.getItem(""+this.key+":last_modified")||localStorage.setItem(""+this.key+":last_modified","{}")}return e.prototype.get=function(e){return localStorage.getItem(""+this.key+":"+e)},e.prototype.set=function(e,t){return"undefined"==typeof t||null===t?this.del(e):("object"==typeof t&&(t=JSON.stringify(t)),localStorage.setItem(""+this.key+":"+e,t),this.updateLastModified(e))},e.prototype.del=function(e){return localStorage.removeItem(""+this.key+":"+e),this.updateLastModified(e)},e.prototype.updateLastModified=function(e){var t,n;try{n=JSON.parse(localStorage.getItem(""+this.key+":last_modified"))}catch(i){t=i,n={}}return n[e]=Date.now(),localStorage.setItem(""+this.key+":last_modified",JSON.stringify(n))},e}()}),require.define("getfbuiButton",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k;f=require("blend/dom"),g=require("blend/events"),y=require("blend/http"),b=require("blend/i18n"),r=require("blend/async"),o=require("blend/cache"),q=require("tracker"),n=require("ui/lightBox"),u=null,v=[],T=null,_=null,i="",x="",k=function(e){return/\b(?:iphone|ipad)\b/i.test(e)},I=function(e){return/\b(?:android)\b/i.test(e)},h=function(){var e;return e=null,k(navigator.userAgent)?(x="itms-apps://itunes.apple.com/us/app/flipboard/id358801284",e='<center>\n    <a target="_blank" href="'+x+'" class="app-store-icon">'+b.t("APP_STORE_ALT_TEXT")+"</a>\n</center>"):k(navigator.userAgent)?(i="market://details?id=flipboard.app&referrer=utm_source%3Dflipit%26utm_medium%3Dwebmag",e='<center>\n    <a target="_blank" href="'+i+'" class="google-play-icon">'+b.t("GOOGLE_PLAY_ALT_TEXT")+"</a>\n</center>"):(x="http://flip.it/downloadios?source=flipit&medium=webmag",i="http://flip.it/downloadandroid?source=flipit&medium=webmag",e='<center>\n    <a target="_blank" href="'+x+'" class="app-store-icon">'+b.t("APP_STORE_ALT_TEXT")+'</a>\n    <a target="_blank" href="'+i+'" class="google-play-icon">'+b.t("GOOGLE_PLAY_ALT_TEXT")+"</a>\n</center>")},m=function(){var e,t;return T=f.create('<div class="modal-window get-the-app">\n    <h2 class="head">'+b.t("DOWNLOAD_FLIPBOARD_TEXT")+'</h2>\n    <h2 class="subhead">'+b.t("DOWNLOAD_FLIPBOARD_DEVICES_TEXT")+"</h2>\n    \n    "+h()+'\n    \n    <p class="status-text" style="text-align: center">'+b.t("GET_LINK_SMS_EMAIL")+'</p>\n\n    <div class="email-form">\n        <form action="http://flipboard.com/request-download/" method="post" name="e-form" class="e-form" target="#redirect">\n            <div style="display:none">\n                <input type="hidden" name="csrfmiddlewaretoken" value="x4J0jF3SUmpT4IF5HrPKWLesm5BcItke">\n                <iframe hidden="true" id="#redirect" width="0px" height="0px"></iframe>\n            </div>\n            <input type="text" name="email_or_phone" placeholder="Enter phone number or email">\n            <input class="submit" type="submit" alt="Send" value="Send" href="#">\n        </form>\n    </div>\n\n    <a href="#" class="close-icon"></a>\n</div>'),e=function(){return q.gaTrackEvent("download","apple.com"),!1},t=function(){return q.gaTrackEvent("download","play.google.com"),!1},_=new n(T),_.on("lightbox:closed",p),v=[g.on(f.one(".close-icon",T),"tap",_.close),g.on(".e-form","submit",a),g.on(".app-store-icon","click",e),g.on(".google-play-icon","click",t)]},p=function(){var e,t,n,i;for(i=[],t=0,n=v.length;n>t;t++)e=v[t],i.push(e.detach);return i},a=function(e){var t,n,i;return null!=e&&e.preventDefault(),n=document.forms["e-form"],t=n.email_or_phone.value,i=document.querySelector(".status-text"),s(t)||l(t)?(f.setInnerHTML(i,""+b.t("Your submission was successful!")),q.gaTrackEvent("download","email"),n.submit(),setTimeout(_.close,1e3)):f.setInnerHTML(i,""+b.t("Your phone number or email is invalid"))},s=function(e){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(e)},l=function(e){return/^(1\s*[-\/\.]?)?(\((\d{3})\)|(\d{3}))\s*[-\/\.]?\s*(\d{3})\s*[-\/\.]?\s*(\d{4})\s*(([xX]|[eE][xX][tT])\.?\s*(\d+))*$/.test(e)},d=function(e){var t,n;return n=e.relatedTarget,t=n,e.stopPropagation(),e.preventDefault(),m()},w=function(){var e;if(!u)return e=document.documentElement,u=g.delegate(e,".get-flipboard-button, #get-app","tap",d)},c=function(){return null!=u?u.detach():void 0},t.init=w,t.destroy=c}),require.define("duplo/abuseReporter",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T;d=require("blend/dom"),c=require("blend/events"),m=require("blend/http"),v=require("blend/i18n"),i=require("blend/async"),o=require("blend/cache"),n=require("ui/lightBox"),s=null,g=[],T=null,b=null,w=null,h="inappropriate",p={},r=null,f=function(){var e,t;r||(r=o.create({key:"fl-flag-items"}));try{e=JSON.parse(r.get(h))}catch(n){t=n,console.log(t)}return e||(e={}),e},_=function(){return T=d.create('<div class="abuse-report-confirm">\n    <span class="abuse-report-header">'+v.t("flag_inappropriate_confirm_title")+"</span>\n    <p>"+v.t("flag_inappropriate_confirm_message")+'</p>\n    <div class="button-wrap">\n        <button id="abuse-report-cancel" class="fl-button">'+v.t("cancel_button")+'</button>\n        <button id="abuse-report-save" class="fl-button">'+v.t("flag_inappropriate_confirm_button")+"</button>\n    </div>\n</div>"),b=new n(T),b.on("lightbox:closed",u),g=[c.on(d.one("#abuse-report-cancel",T),"tap",b.close),c.on(d.one("#abuse-report-save",T),"tap",x)]},u=function(){var e,t,n,i;for(i=[],t=0,n=g.length;n>t;t++)e=g[t],i.push(e.detach);return i},x=function(){var e,t,n,i,o;return t=d.ancestor(w,function(e){return e.classList.contains("status-entry")?!0:e.classList.contains("item")?!0:!1}),t&&p.itemId&&p.section?(o=function(e){var n;if(console.log(e),e.success===!0)return t.style.backgroundColor="#eee",t.style.backgroundImage=null,d.setInnerHTML(t,'<p style="margin: 0 0;padding: 0 0;color:#ccc;height:100%;line-height:'+t.offsetHeight+'px;text-align:center">'+v.t("hidden_item_text_marked_inappropriate")+"</p>"),n=f(),n[p.itemId]=p,r.set(h,n),b.close();throw Error("flag item error.")},e=function(e){return console.log(e),b.close(),alert("Failed to report. Plese try again later.")},i=m.parseQuery(window.location.search),n={path:"/api/social/flagItem",params:{id:p.itemId,oid:p.itemId,url:p.url,section:p.section,type:h}},m.post(n).then(o,e)):void 0},a=function(e){var t;return t=e.relatedTarget,w=t,e.stopPropagation(),e.preventDefault(),p.itemId=t.getAttribute("data-fl-item-id"),p.section=t.getAttribute("data-fl-section"),p.url=t.getAttribute("data-fl-item-url"),_()},y=function(){var e;if(!s)return e=document.documentElement,s=c.delegate(e,".report-abuse-button","tap",a)},l=function(){return null!=s?s.detach():void 0},t.init=y,t.getFlagItems=f,t.destroy=l}),require.define("duplo/scorer",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T;T=require("duplo/utils"),g=require("duplo/layouts"),o=function(e,t,n){return Math.max(t,Math.min(e,n))},d=function(e,t){var n;return n=[],T.walkTree(e,function(e){var i;return i=t(e),i&&n.push(e),i}),n},c=function(e,t){return d(e,function(e){return e.type===t})},_=function(e){var t,n,i,r,o,s;for(n=0,r=0,o=e.length;o>r;r++)s=e[r],t=s[0],i=s[1],n+=i;return n},a=function(e){var t,n,i,r,o,s;for(t="",r=0,o=e.length;o>r;r++)s=e[r],n=s[0],i=s[1],t+=""+n+": "+i.toFixed(2)+",<br>";return t+="sum: "+Math.round(_(e))},h=function(e,t){var n,i,r,o,s,a,l,u,d,c,p;return c=e[0],p=e[1],d=e[2],u=e[3],s=t[0],o=t[1],r=Math.max(d/s,u/o),l=Math.round(s*r),a=Math.round(o*r),i=l-d,n=a-u,[i*u+n*d,r]},w=function(e,t){var n,i,r,s,a,l,u,d,c;return l=e[0],u=e[1],a=e[2],s=e[3],d=h(e,[t.original_width,t.original_height]),n=d[0],r=d[1],r>=1.1?["scale="+r.toFixed(2)+" too large ",2*-(r-1.1)]:s/a>1&&1!==(c=t.original_height/t.original_width)&&c>1?["aspect mismatch",0]:s/a>1.6||a/s>1.6?["aspect=("+a+"/"+s+") out of range",0]:(i=o(n/(t.original_width*t.original_height),0,1),["crop="+(100*i).toFixed(2)+"%, scale="+r.toFixed(2),1])},x=function(e,t){var n,i,r,s,a,l,u,d;return l=e[0],u=e[1],a=e[2],s=e[3],d=h(e,[t.original_width,t.original_height]),n=d[0],r=d[1],r>=1.1?["scale="+r.toFixed(2)+" too large ",2*-(r-1.1)]:(r=o(r+.5,0,1),s/a>1.6||a/s>1.6?["aspect=("+a+"/"+s+") out of range",0]:(i=o(n/(t.original_width*t.original_height),0,1),i>.4?["crop="+(100*i).toFixed(2)+"% too large",0]:["crop="+(100*i).toFixed(2)+"%, scale="+r.toFixed(2),(1-i)*r]))},u=function(e){var t,n;return n=30,t=Math.ceil(e.length/n)},l=function(e){var t,n;return n=42,t=Math.ceil(e.length/n)},n=function(e,t,n){return e.push([t,n])},i=function(e,t,i,r,o){var s,a,l;return null==o&&(o=w),l=o(t,i),s=l[0],a=l[1],n(e,""+r+"("+s+")",5e3*(a-.8))},v=function(e,t,r){var o,s,a,d,p,h,f,m,v,y,b,x,w,_,q,I,k,P;return v=[],n(v,"post item matched slot",1e3),w=r.title?2*u(r.title)*g.baselineGap:0,s=r.excerptText?l(r.excerptText):0,o=s*g.baselineGap,I=c(t,"title"),1===I.length&&(y=I[0].frame[3],x=w>y?-5e3:0,n(v,"post title fit(slotY="+y+", titleY="+w+")",x)),b=c(t,"excerpt"),1===b.length&&(r.excerptText?(y=b[0].frame[3],a=o>.5*y?-5e3:0,n(v,"post excerpt fit(slotY="+y+", excerptY="+o+")",a)):n(v,"post no excerpt but text slot",-1e4)),k=c(t,"titletext"),1===k.length&&(r.title&&r.excerptText?(y=k[0].frame[3],_=w+o>.5*y?-5e3:0,n(v,"titletext fit(slotY="+y+", excerptY="+o+")",_)):n(v,"no title or no excerpt",-1e4)),d=T.imageForItem(r),f=T.imageURLForImage(d),q=c(t,"titleimage"),1===q.length?r.title&&f?3>s?(P=q[0].frame,i(v,P,d,"post titleimage viewport")):n(v,"titleimage: excerpt too long",-1e4):n(v,"titleimage: no title or no image",-1e4):(m=c(t,"image-viewport"),h=m.length>0&&!f,p=0===m.length&&f,h?n(v,"image slot but no image",-1e5):p?n(v,"image but no image slot",-1e4):m.length>0&&d.original_width&&d.original_height&&e.columns>2&&(d.original_hints&&-1!==d.original_hints.indexOf("graphic")&&delete m[0].bleed,P=m[0].frame,i(v,P,d,"post image viewport"))),v},r=function(e,t,n){var i,r,o,s,a,l,u,d;for(o=void 0,i=void 0,r=0,a=u=0,d=e.length;d>u;a=++u)s=e[a],l=t(s),(0===a||n(o,l)>0)&&(o=l,r=a,i=s);return[i,r,o]},s=function(e,t){return _(t)-_(e)},m=function(e,t){var r,o,s;return o=[],r=T.imageForItem(t),r.original_width&&r.original_height?(s=e.frame,i(o,s,r,"photo viewport",x)):n(o,"no image original width/height",0),o},f=function(e,t){var i,o,a,l,u,d,c,p,h,f,g;switch(c=[],u=t.itemdict,e.type){case"post":0===u.post.length?n(c,"post: wrong item to slot type",-1e4):(p=function(n){return v(t,e,n)},f=r(u.post.slice(0,3),p,s),o=f[0],i=f[1],a=f[2],e.item=o,u.post.splice(i,1),c=c.concat(a));break;case"photo":0===u.image.length?n(c,"photo: wrong item to slot type",-1e4):(p=function(t){return m(e,t)},g=r(u.image.slice(0,5),p,s),o=g[0],i=g[1],a=g[2],e.item=o,u.image.splice(i,1),c=c.concat(a));break;case"magazine":l=u.magazine.shift(),l?(e.item=l,n(c,"magazine item match",1e5)):n(c,"magazine: wrong item to slot type",-1e4);break;case"video":l=u.video.shift(),l?(e.item=l,n(c,"video: item slot match",1e3)):n(c,"video: wrong item to slot type",-5e4);break;case"status":h=Math.floor(e.frame[3]/167),d=u.status.splice(0,h),d.length>0?(e.items=d,n(c,"status: items match status box",1e3*d.length)):(e.items=[],n(c,"status: wrong status items to slot match",-1e5))}return c},y=function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,g,m,v,b;if(t.routes){for(d=-1/0,u=null,l=null,a=e,v=t.routes,p=0,g=v.length;g>p;p++)r=v[p],i=T.copyContext(e),o=y(i,r),c=_(o),c>d&&(l=r,d=c,u=o,a=i);return e.itemdict=a.itemdict,t.route=l,delete t.routes,u}if(o=f(t,e),s=o,t.children)for(b=t.children,h=0,m=b.length;m>h;h++)n=b[h],s=s.concat(y(e,n));return("post"===t.type||"status"===t.type||"magazine"===t.type||"video"===t.type||"photo"===t.type)&&(t.score=s),s},p=function(e){var t;return t="",T.walkTree(e,function(e){return e.name&&(t+=""+e.name+"-"),t+=e.frame.join(","),t+="|",!1}),t},b=function(e,t){var n,i,r,o,s;return i=T.itemsLeft(e),o=y(e,t),n=T.itemsLeft(e),r=i-n,t.hashCode=p(t),1===r&&(s=3===e.pageNumber%4?5e3:-5e3,o.push(["single item layout",s])),e.lastHashCode&&e.lastHashCode===t.hashCode&&o.push(["identical to previous page",-5e3]),[o,r]},t.totalForScore=_,t.debugStringForScore=a,t.scorePage=b
}),require.define("lib/urls",function(e,t){var n,i;t.encodeNodeURIComponent=function(e){return encodeURIComponent(e).replace(/'/g,"%27")},t.section=function(e,n){var i;return i=t.encodeNodeURIComponent(e.toLowerCase().replace(/\s+/g,"-")),i.length>0?"/section/"+i+"-"+n:"/section/"+n},t.sectionFromData=function(e){var n,i,r,o,s,a;return t.section(null!=(n=null!=(i=null!=(r=e.section)?r.title:void 0)?i:null!=(o=e.sectionCover)?null!=(s=o.mainItem)?s.title:void 0:void 0)?n:"",null!=(a=e.webNonce)?a:t.temporaryWebNonceForSection(e))},t.temporaryWebNonceForSection=function(e){var i,r,o;return i=null!=(r=null!=(o=e.section)?o.remoteid:void 0)?r:e.remoteid,t.encodeNodeURIComponent("__"+n(i))},n=function(e){return"undefined"!=typeof Buffer?new Buffer(e).toString("base64"):"undefined"!=typeof("undefined"!=typeof window&&null!==window?window.btoa:void 0)?window.btoa(e):i(e)},t.sectionFromWebNonce=function(e){return 0===e.indexOf("__")?new Buffer(e.substring(2),"base64").toString("utf8"):"flipboard/webNonce%2F"+e},t.user=function(e,n){return n&&n.length>0?"/profile/"+t.encodeNodeURIComponent(n):"/profile/u/"+(null!=e?e:0)},t.userFromData=function(e){var n,i;return e.authorUsername||e.userid?t.user(e.userid,e.authorUsername):(null!=(n=e.profile)?n.authorUsername:void 0)||(null!=(i=e.profile)?i.userid:void 0)?t.user(e.profile.userid,e.profile.authorUsername):null},i=function(e){var t,n,i,r,o,s,a;for(r=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n="",i="",t=s=0,a=e.length-1;a>=0?a>=s:s>=a;t=a>=0?++s:--s){for(o=e.charCodeAt(t).toString(2);o.length<8;)o="0"+o;for(n+=o;n.length>=6;)i+=r[parseInt(n.substring(0,6),2)],n=n.substring(6)}return 4===n.length&&(o=n+"00",i+=r[parseInt(o,2)],i+="="),2===n.length&&(o=n+"0000",i+=r[parseInt(o,2)],i+="=="),i}}),require.define("duplo/render",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C;o=require("blend/dom"),r=require("blend/date"),d=require("blend/i18n"),h=require("blend/lang"),P=require("lib/urls"),C=require("duplo/utils"),u=require("blend/http"),f=require("duplo/layouts"),q=require("duplo/scorer"),p=!1,c={},v=function(e){var t,n,i,r;return i=e[0],r=e[1],n=e[2],t=e[3],"left:"+i+"px; top:"+r+"px; width:"+n+"px; height:"+t+"px;"},g=function(e){var t,n,i,r,s,a,l,d,p;for(null==e&&(e=document.body),p=[[],{}],i=p[0],t=p[1],r=o.all("[data-fl-likes-comments]",e),l=0,d=r.length;d>l;l++)e=r[l],n=e.getAttribute("data-fl-item-id"),c[n]||i.push(n),t[n]=e;return a=function(){var e,i,r,s,a,l,u,d,p,h,f;r={facebook:{like:"thumbsup"},youtube:{like:"thumbsup"},flickr:{like:"star"},twitter:{like:"star"},googleplus:{like:"plus"}},f=[];for(n in t)i=t[n],e=c[n],a=i.getAttribute("data-fl-item-service"),s=[],e.shareCount&&s.push('<div class="'+((null!=(l=r[a])?l.share:void 0)||"share")+'"><span>'+e.shareCount+"</span></div>"),e.likeCount&&s.push('<div class="'+((null!=(u=r[a])?u.like:void 0)||"like")+'"><span>'+e.likeCount+"</span></div>"),e.commentCount&&s.push('<div class="'+((null!=(d=r[a])?d.comment:void 0)||"comment")+'"><span>'+e.commentCount+"</span></div>"),e.genericCount&&(null!=(p=r[a])?p.generic:void 0)&&s.push('<div class="'+((null!=(h=r[a])?h.generic:void 0)||"notes")+'"><span>'+e.generic+"</span></div>"),f.push(o.setInnerHTML(i,s.join(" ")));return f},0===i.length?(a(),void 0):(s={path:"/api/social/activity",params:{oid:i}},u.post(s).then(function(e){var t,n,i,r;if(e.success===!0&&e.items){for(r=e.items,n=0,i=r.length;i>n;n++)t=r[n],c[t.id]=t;return a()}}))},T=function(e){var t,n,i,r,o,s,a;if(n=e.referredByItems?e.referredByItems[0]:e,n.original)for(;n.original;)n=n.original;else n=null!=(s=n.originalFlip)?s:n;return r=n.authorURL,null==r&&(r="flipboard"===n.service?P.userFromData(n):void 0),t={service:n.service,id:n.id,authorURL:r,imageURL:C.imageURLForImage(n.authorImage),displayName:n.authorDisplayName,showServiceIcon:!0},"status"===n.type&&(t.text=n.text),n.id!==e.id||e.referredByItems||(delete t.imageURL,delete t.displayName,t.showServiceIcon=!1,n.sectionLinks&&(i=function(){var e,t,i,r;for(i=n.sectionLinks,r=[],e=0,t=i.length;t>e;e++)o=i[e],"author"===o.type&&r.push(o);return r}()[0],i&&(t.displayName=null!=(a=i.title)?a:"",t.imageURL=C.imageURLForImage(i.image),t.authorURL=i.remoteid?P.sectionFromData(i):void 0))),t},b=function(e,t,n){var i,o,s,a,l,u,d,c,p;return null==n&&(n=!0),i=T(t),s=i.imageURL?'<div class="avatar" style="background-image:url(\''+i.imageURL+"');\"></div>":"",d=i.showServiceIcon&&-1!==["flipboard","tumblr","twitter","facebook","googleplus","instagram","flickr","soundcloud","youtube","weibo","renren"].indexOf(i.service)?'<span class="service '+i.service+'"></span>':"",l=null!=(c=i.displayName)?c:"",i.authorURL&&(s='<a href="'+i.authorURL+'" role="link">'+s+"</a>",l='<a href="'+i.authorURL+'" role="link">'+l+"</a>"),n?(a="<h6>"+d+'<span data-fl-likes-comments data-fl-item-id="'+i.id+'" data-fl-item-service="'+i.service+'"></span></h6>',d=""):a="",o=e.attributionClasses?e.attributionClasses:"",u='<div class="attribution '+o+" "+(i.imageURL?"":"noavatar")+'">\n    '+s+"\n    <h5>"+l+'<span class="dateCreated">'+d+" "+r.timeAgoInWords(t.dateCreated)+"</span></h5>\n    "+a+'\n    <div class="flip-button" data-fl-item-id="'+t.id+'" data-fl-item-title="'+(t.title||i.text||"")+'" data-fl-item-image="'+(null!=(p=C.imageURLForImage(C.imageForItem(t)))?p:"")+'" data-fl-item-url="'+t.sourceURL+'"></div>\n</div>'},i=function(e,t,n){var i,r,o,s,a,l,u;if(e/=255,t/=255,n/=255,s=Math.max(e,t,n),a=Math.min(e,t,n),o=(s+a)/2,s===a)r=l=0;else{switch(i=s-a,l=o>.5?i/(2-s-a):i/(s+a),s){case e:r=(t-n)/i+(null!=(u=n>t)?u:{6:0});break;case t:r=(n-e)/i+2;break;case n:r=(e-t)/i+4}r/=6}return[r,l,o]},x=function(e,t){var n,r,o,s,a,l,u,d,c,h,f,g,m,v,y,b,x,w,_,T;return null==t&&(t=!1),_=["","",{},""],l=_[0],w=_[1],n=_[2],g=_[3],h=C.imageForItem(e),o="",h.original_hints&&(-1!==h.original_hints.indexOf("light")&&(l+=" light"),(v=/focus\-(\d+)\-(\d+)/.exec(h.original_hints))&&(s=Math.round(100*Number(v[1])/h.original_width),a=Math.round(100*Number(v[2])/h.original_height),o="background-position: "+s+"% "+a+"%;"),(v=/rgb\-(\d+)\-(\d+)\-(\d+)/.exec(h.original_hints))&&(b=Number(v[1]),u=Number(v[2]),r=Number(v[3]),T=i(b,u,r),c=T[0],x=T[1],m=T[2],x=Math.min(.15,x),w+=" background-color: hsl("+100*c+", "+100*x+"%, 88%);")),f=C.imageURLForImage(h),f&&(d=t?"<div class='gradient lower'></div>":"",y=!h.attribution||"image"!==e.type&&"post"!==e.type?"":'<span class="photo-attribution">'+h.attribution+"</span>",g+='<div data-fl-image-appear class="main-image" data-fl-image-src="'+f+'" '+o+'">'+d+y+"</div>",p&&(g+='<p style="background-color: #933; color: white;">image size '+h.original_width+"x"+h.original_height+"</p>")),n.role="link",n.href=e.sourceURL,[l,w,n,g]},n=function(e){return e.styles&&e.styles["no-padding"]?" no-padding":" top-padding"},l=function(e,t){var n,i;return i="36",n=e.headlineClasses?e.headlineClasses:"",e.styles&&e.styles.headline&&(i=e.styles.headline),'<h4 class="headline headline-'+i+" "+n+"\" data-fl-headline-fit><a role='link' href='"+t.sourceURL+"'>"+t.title+"</a></h4>"},k=function(e){return e.indexOf("&lt;")<0?e:e.replace(/&lt;(\/?(?:b|i|em|strong|p|br))&gt;/g,"<$1>")},m=function(e){var t,n,i,r;return t=e,i=new RegExp("://(.[^/]+)"),n=null!=(r=e.match(i))?r:[],n.length>1&&(t=n[1]),t.replace("www.","")},I=function(e){var t;return t=e.hostDisplayName,!t&&e.sourceURL&&(t=m(e.sourceURL)),t},s=function(e){var t,n,i,r,o,s,a,l,u;return r=50,o=200,s="nytimes"===e.contentService?o:r,a=null!=(l=I(e))?l:"",n="",e.authorDisplayName&&e.authorDisplayName.length<s&&e.authorDisplayName!==(null!=(u=e.referredByItems)?u[0].authorDisplayName:void 0)&&(n=e.authorDisplayName),t=""+a+(a&&n?" / ":"")+n,e.sourceURL&&t&&(t='<a href="'+e.sourceURL+'" role="link">'+t+"</a>"),t&&(i='<span class="excerpt-attribution">'+t+" &bull;</span>"),i},a=function(){return C.hasTestFeature("snapHalfBaseline")?.5*f.baselineGap:f.baselineGap},y=function(e,t,i,r,o,u){var d,c,p,f,g,m,y,w,_,T,I,S,E,N,L,A,F,M,R,z,D,O,B,U,H,G,j,X,W,Y;if(I="",F="",m="",c={},e)switch(e.type){case"post":"title"===t.type&&e.title&&(I=l(t,e),d=(null!=t?null!=(D=t.styles)?D["no-attribution"]:void 0:void 0)?"":b(t,e),I+=d,m+=n(t)),"image-viewport"===t.type&&(O=x(e),m=O[0],F=O[1],T=O[2],I=O[3],h.merge(c,T)),"excerpt"===t.type&&e.excerptText&&(I=" "+s(e)+" "+k(e.excerptText)),"titleimage"===t.type&&e.title&&(B=x(e,!0),m=B[0],F=B[1],T=B[2],I=B[3],h.merge(c,T),d=(null!=t?null!=(U=t.styles)?U["no-attribution"]:void 0:void 0)?'<div class="no-attribution"></div>':b(t,e),I+='<div data-fl-grid-fit="'+a()+'" class="title-inline">'+l(t,e)+d+"</div>"),"postattribution"===t.type&&(I=b(t,e)),"titletext"===t.type&&e.title&&(d=(null!=t?null!=(H=t.styles)?H["no-attribution"]:void 0:void 0)?"":b(t,e),I='<div data-fl-grid-fit="'+a()+'" class="title-inline">'+l(t,e)+d+"</div>",m+=n(t),e.excerptText&&(w=t.excerptClasses?t.excerptClasses:"",I+='<div class="excerpt '+w+'">'+s(e)+" "+k(e.excerptText)+"</div>"));break;case"image":G=x(e,!0),m=G[0],F=G[1],T=G[2],I=G[3],h.merge(c,T),I+=b(t,e);break;case"magazine":j=x(e),m=j[0],F=j[1],T=j[2],I=j[3],h.merge(c,T),c.role="link",c.href=P.sectionFromData(e),f=C.imageURLForImage(e.authorImage),d='<div class="magazine-attribution"><div class="avatar" style="background-image:url(\''+f+"');\"></div><h4>"+e.authorDisplayName+"</h4></div>",I+='<div class="title-magazine">'+l(t,e)+"</div>",I+=d;break;case"video":X=x(e),m=X[0],F=X[1],T=X[2],I=X[3],h.merge(c,T),I+=b(t,e),I+='<div role="link" href="'+e.sourceURL+'" class="video-play-button"></div>'}else if("status"===t.type&&t.items&&!o.debug)for(W=t.items,_=R=0,z=W.length;z>R;_=++R){for(L=W[_],E=L;L.original&&"status"===L.original.type;)L=L.original;A=L.text,I+='<div role="link" href="'+(null!=L?L.sourceURL:void 0)+'" class="status-entry"><div class="status-text">'+A+"</div>"+b(t,E,!1)+" </div>",_<t.items.length-1&&(I+='<div class="status-hrule"></div>')}else if(o.debug)switch(t.type){case"title":F="background-color: orange;",I="POST HEADLINE + ATTRIBUTION";break;case"image-viewport":F="background-color: lightblue;",I="POST IMAGE";break;case"excerpt":F="background-color: green;",I="POST TEXT EXCERPT";break;case"photo":F="background-color: brown;",I="PHOTO";break;case"status":F="background-color: thistle;",I="STATUS UPDATE";break;case"titletext":F="background-color: yellow;",I="POST HEADLINE + ATTRIBUTION + EXCERPT";break;case"titleimage":F="background-color: pink;",I="POST HEADLINE + ATTRIBUTION + IMAGE";break;case"video":F="background-color: purple;",I="VIDEO";break;case"magazine":F="background-color: red;",I="MAGAZINE"}g=null!=t.type?t.type:"",C.isItem(t)&&(g+=" item"),o.showScores&&t.score&&(y=q.debugStringForScore(t.score),I+='<div style="position: absolute; top: 0; left: 0; bottom: 0; right: 0; border: 1px solid green; z-index: 500; text-align: left; font-size: 14px;"><span style="background-color: green; color: white;">'+y+"</span></div>",c["data-fl-score-total"]=Math.round(q.totalForScore(t.score))),o.showLayouts&&u&&(I+='<div style="position: absolute; top: 0; left: 0; bottom: 0; right: 0; border: 1px solid green; z-index: 500; text-align: center;"><span style="margin: 0 auto; background-color: green; color: white; padding: 0 20px 0 20px;">'+u+"</span></div>"),c["class"]=""+g+m,(null!=t?null!=(Y=t.item)?Y.id:void 0:void 0)&&(c["data-fl-item-id"]=t.item.id),p="";for(S in c)M=c[S],""!==M&&(p+=" "+S+'="'+M+'"');return N='<div style="position: absolute; '+v(i)+F+'"'+p+">"+I+r+"</div>"},w=function(e,t,n,i,r,o,s){var a,l,u,d,c,p,h,g;if(null==o&&(o={}),null==s&&(s=null),null!=t.route)return null!=t.name&&(s=t.name),w(e,t.route,n,i,r,o,s);if(t.item&&(n=t.item),u="",null!=t.children)for(g=t.children,c=p=0,h=g.length;h>p;c=++p)a=g[c],l=a.frame,l=[l[0]-r[0],l[1]-r[1],l[2],l[3]],u+=w(e,a,n,l,[r[0]+l[0],r[1]+l[1]],o,a.name),t.styles&&t.styles.rules&&c+1<t.children.length&&("hbox"===t.flow?(d=[l[0]+l[2]+Math.floor(f.columnHalfGap(e.pageFrame[2])),0,1,l[3]],u+='<div class="gridline vertical" style="'+v(d)+'"></div>'):"vbox"===t.flow&&(d=[0,l[1]+l[3]+Math.floor(f.baselineHalfGap),l[2],1],u+='<div class="gridline" style="'+v(d)+'"></div>'));return null!=t.name&&(s=t.name),y(n,t,i,u,o,s)},_=function(e,t,n){var i,r,s,a,l,u,c,p,h,g,m,y;if(null==n&&(n={}),g=t.contentFrame,p=g[0],h=g[1],c=g[2],a=g[3],u=[p,h],r=w(t,e,null,e.frame,u,n),C.shouldShowHeaderForPage(t)&&(l=(null!=t?null!=(m=t.section)?m.title:void 0:void 0)||(null!=t?null!=(y=t.section)?y.authorDisplayName:void 0:void 0),r+='<div class="header"><button class="guide-button"></button><span class="tagline">'+l+'</span><button class="fl-button share-button">'+d.t("share_button")+"</button></div>"),C.shouldShowFooterForPage(t)&&(r+='<div class="footer"><span class="tagline">'+t.section.title+' &ndash;\n<a class="author-name" role="link" href="'+P.userFromData(t.section.author)+'">'+t.section.author.authorDisplayName+'</a></span>\n<div class="get-flipboard-button">Get Flipboard</div></div>'),C.hasTestFeature("showGrid"))for(s=h-5;h+a>s;)r+='<div style="position: absolute; top: '+s+"px; left: "+p+"px; width: "+c+"px; height: "+f.baselineGap+'px; background-color: rgba(50,255,50,0.3);"></div>',s+=2*f.baselineGap;return i="page "+t.pageStyle.style+" columns-"+t.columns,o.create('<div class="'+i+'" style="position: relative; '+v(t.pageFrame)+'">'+r+"</div>")},t.renderPage=_,t.loadLikesAndComments=g}),require.define("duplo",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L,A,F,M,R,z,D,O;u=require("blend/date"),d=require("blend/dom"),w=require("blend/i18n"),T=require("blend/lang"),p=require("blend/events"),x=require("blend/http"),k=require("duplo/layouts"),m=require("duplo/gridFitter"),a=require("duplo/bugReporter"),h=require("flipButton"),g=require("getfbuiButton"),n=require("duplo/abuseReporter"),O=require("duplo/utils"),A=require("duplo/scorer"),N=require("duplo/render"),b=O.hasTestFeature,C=function(e,t,n,i){return{x:e,y:t,width:n,height:i}},D=function(e,t){return e*t},z=function(e,t){var n,i,r,o,s,a,l,u;return o=t[0],s=t[1],r=t[2],i=t[3],l=e[0],u=e[1],a=e[2],n=e[3],[Math.round(o+D(l,r)),Math.round(s+D(u,i)),Math.round(D(a,r)),Math.round(D(n,i))]},_=function(e,t){var n,i,r,o,s,a,l,u;return l=e[0],u=e[1],a=e[2],i=e[3],r=t[0],s=t[1],o=t[2],n=t[3],[l+r,u+s,a-r-o,i-s-n]},f={hbox:function(e,t){return[e,0,t,1]},vbox:function(e,t){return[0,e,1,t]}},R={hbox:function(e,t,n){return _(e,[t,0,n,0])},vbox:function(e,t,n){return _(e,[0,t,0,n])}},M=function(e,t){var n;return n=e.pageInset[1],Math.round((t-n)/k.baselineGap)*k.baselineGap+n},s=function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b;return n="photo"===t.type||"video"===t.type?"top left right bottom":t.bleed,v=t.frame,g=v[0],m=v[1],p=v[2],i=v[3],y=e.contentFrame,d=y[0],c=y[1],u=y[2],l=y[3],b=e.pageFrame,s=b[0],a=b[1],o=b[2],r=b[3],f=!O.shouldShowHeaderForPage(e),h=!O.shouldShowFooterForPage(e),d>=g&&-1!==n.indexOf("left")&&(p+=g-s,g=s),g+p>=d+u&&-1!==n.indexOf("right")&&(p=o-g),f&&c>=m&&-1!==n.indexOf("top")&&(i+=m-a,m=a),h&&m+i>=c+l&&-1!==n.indexOf("bottom")&&(i=r-m),[g,m,p,i]},I=function(e,t,n){var i,r,o,s,a,l,u,d,c,p,h,g,m,v,y,b,x,w,_,T,q,P,C,S,E,N,L,A,F,D;if(t.frame=n,t.routes){for(N=t.routes,F=[],T=0,C=N.length;C>T;T++)h=N[T],F.push(I(e,h,n));return F}if(null!=t.children){for(v=0,L=t.weights,q=0,S=L.length;S>q;q++)b=L[q],v+=b;for(s=f[t.flow],g=R[t.flow],d=0,A=t.children,D=[],u=P=0,E=A.length;E>P;u=++P)r=A[u],a="photo"===e.pageStyle.style?1.5:"hbox"===t.flow?k.columnHalfGap(e.pageFrame[2]):k.baselineHalfGap,p=0===u?0:Math.floor(a),c=u===t.children.length-1?0:Math.ceil(a),y=s(d/v,t.weights[u]/v),o=z(y,n),"vbox"===t.flow&&(w=o[0],_=o[1],x=o[2],l=o[3],m=_,i=_+l,"normal"===e.pageStyle.style&&(u>0&&(m=M(e,m)-k.baselineHalfGap),u<t.children.length-1&&(i=M(e,i)-k.baselineHalfGap)),_=m,l=i-m,o=[w,_,x,l]),o=g(o,p,c),I(e,r,o),D.push(d+=t.weights[u]);return D}},c=function(e){var t;return t=0,e&&O.walkTree(e,function(e){return!O.isItem(e)||e.item||e.items?void 0:(console.log("duplo: empty node found",e),t+=1)}),t},S=function(e,t){var n;return n=function(t){return"photo"===t.type||t.bleed?t.frame=s(e,t,t.frame):void 0},O.walkTree(t,function(e){return n(e)})},o=function(e,t){var n,i,r,o,s,a,l,u,d,c;return d=e[0],c=e[1],u=e[2],l=e[3],a=l*t,s=u/t,u>a?(o=a,r=l):(o=u,r=s),n=d+.5*(u-o),i=c+.5*(l-r),[n,i,o,r]},l=function(e){var t,n,i,r,o,s,a,l,u,d,c;if(i=[],k.enumerateLayouts(e,function(t,n){var r,o,s,a,l,u;return s=T.deepCopy(n),o=O.copyContext(e),o.pageStyle=t,I(o,s,e.contentFrame),u=A.scorePage(o,s),l=u[0],a=u[1],a>0?(r={score:l,total:A.totalForScore(l),layout:s,context:o},i.push(r)):void 0}),0===i.length)return null;if(i.sort(function(e,t){return t.total-e.total}),t=i[0],e.pageStyle=t.context.pageStyle,e.itemdict=t.context.itemdict,S(e,t.layout),b("showScores"))for(console.log("page "+t.context.pageNumber+" candidates"),d=i.slice(0,4),o=s=0,l=d.length;l>s;o=++s)for(n=d[o],console.log("	candidate "+o+": total "+Math.round(n.total)),c=n.score,a=0,u=c.length;u>a;a++)r=c[a],console.log("		"+r[0]+": "+Math.round(r[1]));return t.layout},F=function(e,t,n){var i,r,o,s,a;return e.pageFrame=[0,0,t,n],e.pageInset=k.insetsForPage(e,t,n),e.columns=k.columnsForPageWidth(t),r=_(e.pageFrame,e.pageInset),s=r[0],a=r[1],o=r[2],i=r[3],i=Math.floor(i/k.baselineGap)*k.baselineGap,e.contentFrame=[s,a,o,i]},P=function(e,t){var n,i,r,o,s;return null==t&&(t=!0),r=O.itemsLeft(e),o=l(e),!o||!t&&c(o)>0?null:(e.lastHashCode=o.hashCode,a.setDebugInfo(o,n,e),i=O.itemsLeft(e),i>=r?(console.warn("No items matched to page:",r,i),console.warn(e),null):(s={debug:!1},b("showLayouts")&&(s.showLayouts=!0),b("showScores")&&(s.showScores=!0),o?N.renderPage(o,e,s):null))},i=function(e,t){var n;return n=T.deepCopy(t),delete n.excerptText,delete n.rssText,e.setAttribute("data-json-item",JSON.stringify(n))},y=[],v=function(e){var t,n,i;return i=e.relatedTarget,i?(e.preventDefault(),n=i.getAttribute("href"),t=p.create("navigate",{url:n,srcEvent:e}),document.dispatchEvent(t)):void 0},r=function(e,t){var n,i,r,o;for(o=[],i=0,r=t.length;r>i;i++)n=t[i],e[n.type]?o.push(e[n.type].push(n)):o.push(console.warning("No group for item",n));return o},q=function(e,t,i,o,s,a,l,u){var c,f,m,x,w,_,q,I,k,C,S,E;for(null==l&&(l=null),null==u&&(u=!0),t=T.arrayCopy(t),c=n.getFlagItems(),t=t.filter(function(e){return!(null!=c?c[e.id]:void 0)}),q=0,C=t.length;C>q;q++)x=t[q],"post"!==x.type||""!==x.title||""!==x.excerptText&&"Photo"!==x.excerptText||(x.type="image");for(I=0,S=i.length;S>I;I++)w=i[I],w.type="magazine";for(null==l&&(l={itemdict:{image:[],post:[],status:[],video:[],album:[],magazine:[]}}),r(l.itemdict,t),l.itemdict.magazine=l.itemdict.magazine.concat(i),l.section=e,l.pageNumber=d.all(".page",o).length,b("showEthanVariant")&&(l.showEthanVariant=!0),F(l,s,a),f=document.createDocumentFragment();O.itemsLeft(l)>0&&(_=P(l,u));)_.setAttribute("data-fl-page-number",l.pageNumber),l.pageNumber+=1,f.appendChild(_);for(o.appendChild(f),h.init(".flip-button","#flipui-main"),g.init(),k=0,E=y.length;E>k;k++)m=y[k],m.detach();return y=[p.delegate(o,"[role=link]","tap",v)],N.loadLikesAndComments(o),l},E=function(e){return m.headlineFit(e),m.gridFit(e)},L=function(e,t){var n,i,r,o,s,a,l,u,c;switch(console.log("Rendering all layouts"),t.page){case"phone":a=[320,416],o=a[0],r=a[1];break;case"portrait":l=[768,1024],o=l[0],r=l[1];break;case"windows":u=[1356,768],o=u[0],r=u[1];break;default:c=[1024,768],o=c[0],r=c[1]}return n={},F(n,o,r),i=function(e){var t,n,r,o,s,a,l,u,d;if(n=[],e.routes)for(n.push(e),u=e.routes,o=0,a=u.length;a>o;o++)r=u[o],n=n.concat(i(r));if(e.children)for(d=e.children,s=0,l=d.length;l>s;s++)t=d[s],n=n.concat(i(t));return n},s=function(e,t){var n,i,r,o,a;if(e.length>0){for(n=e[0],a=n.routes,r=0,o=a.length;o>r;r++)i=a[r],n.route=i,s(e.slice(1),t);return delete n.route}return t()},k.enumerateLayouts(n,function(t,r){var o,a;return a=T.deepCopy(r),o=O.copyContext(n),o.pageStyle=t,I(o,a,n.contentFrame),S(n,a),console.debug(a),e.appendChild(d.create(""+JSON.stringify(a))),s(i(a),function(){var t;return t=N.renderPage(a,o,{debug:!0,showLayouts:!0}),e.appendChild(t)})})},t.layoutItems=q,t.renderAllLayouts=L,t.refinePage=E}),require.define("fit",function(e,t){var n,i,r,o,s,a,l;i=require("blend/dom"),s="&hellip;",a=function(e,t){var n,r,o,a,u;for(l(e),e.setAttribute("data-fl-lines-text",e.innerHTML),null==t&&(t=e.getAttribute("data-fl-lines")),o=getComputedStyle(e,null).lineHeight,o=parseInt(o,10)*t,n=e.getBoundingClientRect().height,r=e.textContent,u=[];n>o;)a=r.lastIndexOf(" "),r=r.substr(0,a),i.setInnerHTML(e,r+s),u.push(n=e.getBoundingClientRect().height);return u},o=function(e){var t,n,i,r;if(l(e),n=e.getAttribute("data-fl-fit"),null!==n){for(n=n.split(","),i=void 0,r=e.getBoundingClientRect().height;e.scrollHeight>r&&n.length;)t=n.shift(),""!==t&&(void 0!==i&&e.classList.remove(i),e.classList.add(t),i=t);return i?e.setAttribute("data-fl-fit-class",i):void 0}},n={"data-fl-lines":a,"data-fl-fit":o},r=function(e){var t,i,r,o;if(null==e&&(e=document.body),"string"==typeof e&&(e=document.querySelector(e)),e){o=[];for(t in n)i=n[t],o.push(function(){var n,o,s,a;for(s=e.querySelectorAll("["+t+"]"),a=[],n=0,o=s.length;o>n;n++)r=s[n],a.push(i(r));return a}());return o}},l=function(e){return e.hasAttribute("data-fl-lines-text")&&i.setInnerHTML(e,e.getAttribute("data-fl-lines-text")),e.hasAttribute("data-fl-fit-class")?e.classList.remove(e.getAttribute("data-fl-fit-class")):void 0},t.truncate=a,t.sizeToFit=o,t.process=r}),require.define("feed",function(e,t){var n,i,r,o,s,a;i=require("blend/async"),s=require("blend/http"),r=!1,n={},a=function(e){var t,i,r,o;for(t=i=r=e.length-1;i>=0;t=i+=-1){if(e[t].endOfFeed)return n;if(e[t].id)return null!=(o=e[t].nextPageKey)?o:e[t].id}},o=function(e,t){return console.error("Error while loading feed with params",e,":",t)},t.process=function(e){var t;return{items:function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],t.endOfFeed||r.push(t);return r}(),pageKey:a(e)}},t.load=function(e,n,o){var a;return null==o&&(o=30),e&&"string"==typeof n?(console.log("loading "+o+" more in",e,"from",n),r=!0,a={path:"/section/items",params:{id:e,limit:o}},null!=n&&(a.params.pageKey=n),s.get(a).then(function(e){return r=!1,t.process(e.items)})):i.resolve([])},t.isFetching=function(){return r}}),require.define("imageLoader",function(e){var t,n,i,r,o;n=require("blend/dom"),i=require("blend/events"),o=require("blend/lang"),r=require("blend/features"),e.exports=t=function(){function e(e){this.node=null!=e?e:document.body,this.pending={}}return e.prototype.process=function(){var e,t,i,r,o,s;for(t=n.all("[data-fl-image]",this.node),t=t.concat(n.all("[data-fl-image-appear]",this.node)),s=[],r=0,o=t.length;o>r;r++)e=t[r],i=this.extractSource(e),i?s.push(this.beginListening(e,i)):s.push(void 0);return s},e.prototype.extractSource=function(e){var t,n,i,r,o;if(r=null!=(o=e.tagName)?o.toLowerCase():void 0,n=e.getAttribute("data-fl-image-src"),!n)switch(r){case"img":n=e.getAttribute("src");break;default:i=getComputedStyle(e),t=i.backgroundImage.match(/url\(\s*(['"]?)(.*?)\1\s*\)/),3===(null!=t?t.length:void 0)&&(n=t[2])}return n||console.warn("Unable to parse image source:",e),n},e.prototype.beginListening=function(e,t){var r,o;return this.pending[t]?(this.pending[t].nodes.push(e),void 0):(r=document.createElement("img"),r.src=t,r.setAttribute("data-original-src",t),r.style.visibility="hidden",o=r.naturalHeight>0,this.pending[t]={},this.pending[t].nodes=[e],this.pending[t].loadHandle=i.on(r,"load",this.imageLoaded.bind(this)),this.pending[t].loaded=o,o?this.imageLoaded({target:r}):n.append(r))},e.prototype.imageLoaded=function(e){var t,i,r,o,s,a,l,u,d;if(r=e.target.getAttribute("data-original-src"),t=this.pending[r]){for(u=t.nodes,o=0,a=u.length;a>o;o++)i=u[o],i.getAttribute("data-fl-image-src")&&("img"===i.tagName.toLowerCase()?i.setAttribute("src",r):i.style.backgroundImage="url("+r+")",i.removeAttribute("data-fl-image-src")),this.emit("image:loaded",{node:i,src:r}),i.hasAttribute("data-fl-image-appear")?this.appearAnimated(i,r,t.loaded):this.emit("image:appeared",{node:i,src:r,animated:!1});for(d=t.nodes,s=0,l=d.length;l>s;s++)i=d[s],i.removeAttribute("data-fl-image");return t.loadHandle.detach(),n.remove(e.target),delete this.pending[r]}},e.prototype.appearAnimated=function(e,t,n){var o,s,a,l=this;return null==n&&(n=!1),a=r.animations&&!n,o=function(){return l.emit("image:appeared",{node:e,src:t,animated:a}),e.removeAttribute("data-fl-image-appear"),e.removeAttribute("data-fl-image-appearing"),"undefined"!=typeof s&&null!==s?s.detach():void 0},a?(e.setAttribute("data-fl-image-appearing",""),s=i.on(e,r.animationEnd,o,!0)):o()},e}(),o.mixin(t,i.Emitter)}),require.define("scrubber",function(e){var t,n,i,r,o,s,a,l;n=require("blend/dom"),l=require("blend/lang"),i=require("blend/events"),r=require("blend/gestures"),a=4,s=22,o=a+2*s,t=function(){function e(e,t){this.parent=null!=e?e:document.body,this.horizontal=null!=t?t:!1,"string"==typeof this.parent&&(this.parent=document.querySelector(this.parent)),this.pages=[],this.selectedIndex=0,this.setup()}return e}(),l.mixin(t,i.Emitter),t.prototype.setup=function(){return this.node=document.createElement("div"),this.node.className="scrubber",this.parent.appendChild(this.node),this.panGesture=new r.Pan(this.node),this.panGesture.on("pan:start",this.panStart.bind(this)),this.panGesture.on("pan:change",this.panChange.bind(this)),this.panGesture.on("pan:end",this.panEnd.bind(this)),this.clickHandle=i.on(this.node,"click",this.click.bind(this))},t.prototype.destroy=function(){return this.panGesture.destroy(),this.clickHandle.detach()},t.prototype.setPages=function(e){var t,i,r,o,s,a;for(this.pages=null!=e?e:[],n.setInnerHTML(this.node,""),a=this.pages,i=o=0,s=a.length;s>o;i=++o)r=a[i],t=document.createElement("span"),t.className="dot",n.setInnerHTML(t,"<b></b>"),this.node.appendChild(t);return this.resize(),this.select(this.selectedIndex)},t.prototype.select=function(e){var t,i;return this.selectedIndex=e,t=n.one(".selected",this.node),null!=t&&t.classList.remove("selected"),t=null!=(i=n.all(".dot",this.node))?i[e]:void 0,null!=t?t.classList.add("selected"):void 0},t.prototype.resize=function(){var e,t,n,i;if(this.horizontal){for(t=this.parent.getBoundingClientRect().width,t-=60,i=this.node.scrollWidth;(i>t||this.node.scrollHeight>o)&&null!=this.node.lastChild;)this.node.removeChild(this.node.lastChild),i=this.node.scrollWidth;return this.node.style.left="50%",this.node.style.marginLeft="-"+i/2+"px",this.node.style.top=""+(window.innerHeight-36)+"px"}for(e=this.parent.getBoundingClientRect().height,e-=60,n=this.node.scrollHeight;n>e&&null!=this.node.lastChild;)this.node.removeChild(this.node.lastChild),n=this.node.scrollHeight;return this.node.style.top="50%",this.node.style.marginTop="-"+n/2+"px"},t.prototype.show=function(){return this.node.classList.add("showing")},t.prototype.hide=function(){return this.node.classList.remove("showing")},t.prototype.panStart=function(){return this.emit("scrub:start",{index:this.selectedIndex})},t.prototype.panChange=function(e){var t;return t=this.horizontal?e.location.x:e.location.y,this.selectByOffset(t)},t.prototype.panEnd=function(){return this.emit("scrub:end",{index:this.selectedIndex})},t.prototype.click=function(e){var t;return t=this.horizontal?e.clientX-this.node.getBoundingClientRect().left:e.clientY-this.node.getBoundingClientRect().top,this.selectByOffset(t)},t.prototype.selectByOffset=function(e){var t,n;return n=this.horizontal?e/this.node.offsetWidth:e/this.node.offsetHeight,n=l.clamp(n,0,1),t=Math.floor(n*this.pages.length),this.select(t),this.emit("scrub:change",{index:this.selectedIndex})},e.exports=t}),require.define("lib/feed",function(e,t){var n,i;t.getCoverItems=function(e,n){var r,o,s,a,l,u,d,c;if(a=void 0,r=[],(null!=e?e.mainItem:void 0)&&(a=i(e.mainItem)),void 0===a&&n.length)for(l=0,d=n.length;d>l;l++)if(s=n[l],o=t.getItemImage(s),void 0!==o){a=i(s);break}for("post"!==(null!=a?a.type:void 0)&&null!=a&&(a.title=null),u=0,c=n.length;c>u;u++)s=n[u],r.length>=2||s.title&&"post"===s.type&&s.id&&s.id!==(null!=a?a.id:void 0)&&r.push(i(s));return[a,r]},t.getItemImage=function(e){var t;return t=function(){var t,n;switch(e.type){case"image":return e.image;case"post":return e.inlineImage;case"video":return e.posterImage;case"audio":return e.albumArtImage;case"section":return null!=(t=e.section)?t.tileImage:void 0;case"album":return null!=(n=e[0])?n.image:void 0;default:return void 0}}()},t.largestAvailableImage=function(e){var t;return null==e&&(e={}),t=void 0,t=e.largeURL,null==t&&(t=e.mediumURL),null==t&&(t=e.smallURL),t},t.siteAttributionText=function(e){var t;return t=e.hostDisplayName,!t&&e.sourceURL&&(t=n(e.sourceURL)),t},t.getPhotoAttribution=function(e){var n,i;return i=t.getItemImage(e),i&&(n=i.attribution||t.siteAttributionText(e)),n},n=function(e){var t,n,i,r;return t=e,i=new RegExp("://(.[^/]+)"),n=null!=(r=e.match(i))?r:[],n.length>1&&(t=n[1]),t.replace("www.","")},i=function(e){var n,i;return n=t.getItemImage(e),i={},i.id=e.id,i.type=e.type,i.title=e.title,i.sourceURL=e.sourceURL,i.image=t.largestAvailableImage(n),i.attribution=t.siteAttributionText(e),i.image&&(i.imageAttribution=t.getPhotoAttribution(e)),i}}),require.define("shareButton",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E;p=require("blend/dom"),x=require("blend/lang"),h=require("blend/events"),v=require("blend/http"),y=require("blend/i18n"),E=require("models/user"),i=require("ui/lightBox"),C=require("tracker"),r=require("ui/loading"),f=require("lib/feed"),n=require("ui/alert"),g=null,_=null,d=null,l=null,q=v.parseQuery(window.location.search),I=null,_=null,m=[],w=null,S=null,a=function(){var e,t,n,i,r;return n={t:I.title,u:S},r=500,e=400,i=(window.screenTop||window.screenY)+200,t=(window.screenX||window.screenLeft)+(window.innerWidth||document.documentElement.offsetWidth||0)/2-r/2,window.open("https://www.facebook.com/sharer/sharer.php"+v.stringifyQuery(n),void 0,"width="+r+",height="+e+",top="+i+",left="+t)},s=function(){var e;return e={subject:y.t("SHARE_EMAILTO_SUBJECT",I.title),body:" "+y.t("SHARE_EMAILTO_BODY",I.title,I.resolvedAuthorUsername)+" "+S+" "},window.location.href="mailto:"+v.stringifyQuery(e)},u=function(){var e,t,n,i,r;return n={original_referer:window.location.href,text:I.title,url:S,via:"flipboard"},r=500,e=450,i=(window.screenTop||window.screenY)+200,t=(window.screenX||window.screenLeft)+(window.innerWidth||document.documentElement.offsetWidth||0)/2-r/2,window.open("https://twitter.com/intent/tweet"+v.stringifyQuery(n),void 0,"width="+r+",height="+e+",top="+i+",left="+t)},T=function(){var e,t,n,r,o;return e=I.resolvedImageURL?'<img class="author-image" src="'+I.resolvedImageURL+'"/>':"",t=I.resolvedAuthorUsername?'<span class="author-name">By '+I.resolvedAuthorUsername+"</span>":"",r=p.create('<div class="share-ui">\n    <div class="column-left" style="'+((null!=(o=I.coverItem)?o.image:void 0)?"background-image:url("+I.coverItem.image+")":"")+'">\n        <div class="gradient upper"></div>\n        <div class="gradient lower"></div>\n        <h1>'+(I.title||"")+"</h1>\n        "+e+"\n        "+t+'\n    </div>\n    <div class="column-right">\n        <h2>Share on:</h2>\n        <div class="services">\n            <div class="service email"></div>\n            <div class="service facebook"></div>\n            <div class="service twitter"></div>\n        </div>\n        <h2>Link:</h2>\n        <input type="text" class="fl-field"  value="'+S+'"></input>\n    </div>\n</div>'),n=function(e){var t,n;return n=e.target,t=function(e){return n.classList.contains(e)},t("email")?s():t("facebook")?a():t("twitter")&&u(),w.close()},m.push(h.on(p.one(".services",r),"tap",n)),w=new i(r),w.on("lightbox:closed",function(){var e,t,n;for(m=[],t=0,n=m.length;n>t;t++)e=m[t],e.detach;return _.hide(),_.destroy(),w=null
})},P=function(e){if(S=e.result,!S)throw new Error("Generate shorten url error");return _.hide(),T()},k=function(e){return _.hide(),_.destroy(),n.message(y.t("ERROR"),y.t("SERVER_UNABLE_TO_SERVICE_YOUR_REQUEST"))},o=function(e){var t,n;return n=e.relatedTarget,e.stopPropagation(),e.preventDefault(),_=new r,document.body.appendChild(_.node),_.show(),t={path:"/api/social/shortenSection",params:{sectionid:I.remoteid,title:I.title||"",imageURL:I.imageURL||""}},v.get(t).then(P,k),!1},b=function(e,t,n,i){var r,s,a,u,d,c;return null==i&&(i=!1),t&&(t.remoteid||t.sectionID)?l?void 0:(I=x.deepCopy(t),null==(s=I.remoteid)&&(I.remoteid=I.sectionID),I.coverItem=n||{},I.resolvedImageURL=(null!=(a=I.author)?null!=(u=a.authorImage)?u.smallURL:void 0:void 0)||(null!=(d=I.authorImage)?d.smallURL:void 0),I.resolvedAuthorUsername=I.authorDisplayName||(null!=(c=I.author)?c.authorDisplayName:void 0),r=document.documentElement,l=h.delegate(r,e,"tap",o)):(console.warn("missing section data"),void 0)},c=function(){return null!=l&&l.detach(),"undefined"!=typeof flipui&&null!==flipui?flipui.detachEvents():void 0},t.init=b,t.destroy=c}),require.define("landingPage",function(e,t){var n,i,r,o,s,a,l,u,d,c,p,h,f,g,m,v,y,b,x,w,_,T,q,I,k,P,C,S,E,N,L,A,F,M,R,z,D,O,B,U,H,G,j,X,W,Y,V,J,K,Q,Z,$,et,tt,nt,it,rt,ot,st,at,lt,ut,dt,ct,pt,ht,ft,gt,mt,vt,yt,bt,xt,wt,_t,Tt,qt,It,kt;u=require("blend/dom"),p=require("blend/events"),U=require("blend/lang"),f=require("blend/features"),N=require("blend/i18n"),E=require("blend/http"),d=require("duplo"),k=require("duplo/gridFitter"),a=require("duplo/bugReporter"),y=require("fit"),Q=require("pageControllers"),g=require("feed"),bt=require("tracker"),nt=require("prefs"),I=require("getfbuiButton"),n=require("imageLoader"),i=require("scrubber"),ht=require("shareButton"),m=require("lib/feed"),ct=void 0,D=[],Y=void 0,Z=void 0,l=void 0,st=void 0,A=void 0,K=void 0,dt=void 0,S=!1,P=!1,_=!1,vt="onorientationchange"in window,pt={},O=null,F=function(){var e,t,n,i;return E.setDefaultLocation(nt.get("server.defaultHost"),{user:nt.get("server.defaultUser"),password:nt.get("server.defaultPassword")}),pt=u.parseDataNode("section-cover-data"),O=u.parseDataNode("items-data"),ct=null!=(n=null!=pt?pt.section:void 0)?n:{},i=m.getCoverItems(pt,O),t=i[0],e=i[1],M(ct),W(),ht.init(".share-button",ct,t)},M=function(e,t){var i,r,o;return null==t&&(t=[]),ct=e,l=null!=(o=null!=ct?ct.remoteid:void 0)?o:null!=ct?ct.sectionID:void 0,st=u.one("#main"),O||(O=u.parseDataNode("items-data")),I.init(),bt.startHeartbeatTracking(l),yt("enter"),bt.gaTrackEvent("pageLoad","pageLoad"),R(),z(),p.on(window,"mousemove",It),p.on(".flip-hint.upper","click",x),p.on(".flip-hint.lower","click",x),A=new n(st),A.on("image:loaded",L),A.process(),i=g.process(O),r=i.items,Z=i.pageKey,Y=t,_t(r,Y),xt(),h()},z=function(){return document.documentElement.classList.add(f.ua),vt?(p.on(window,"orientationchange",function(){return qt(),v()}),qt()):p.on(window,"resize",kt)},qt=function(){return vt?(document.documentElement.style.height=""+2*window.innerHeight+"px",scrollTo(0,0),document.documentElement.style.height=""+window.innerHeight+"px",Tt()):void 0},yt=function(e,t){return null==t&&(t={}),t.section_id=l,bt.trackEvent(e,t)},R=function(){var e,t,n,i,s,a,l,u,d,c;switch(c=nt.get("transition.type"),d=nt.get("transition.wheel"),s=nt.get("transition.mouseInput"),t=nt.get("transition.snap"),u=nt.get("transition.snapThreshold"),i=nt.get("transition.pagingFlip"),n=S?"x":void 0,l=".gridline.vertical, .page, .photo",nt.get("transition.snapToGrid")||(l=".page"),e=void 0,f.transitions||(c="scroll"),c){case"stack":e=Q.Stack;break;case"slide":e=Q.Slide;break;case"snap":e=Q.Snap;break;case"flip":e=Q.Flip;break;default:e=Q.Scroll}return P="snap"===c,_="flip"===c,a={getPage:T,getCount:q,pageMargin:20,axis:n,wheelInput:d,mouseInput:s,autosnap:t,flipOnSelect:i,snapThreshold:u,snapSelector:l},K=new e(st,a),K.on("page:beforeChange",r),K.on("page:change",J),K.on("page:beforeTrack",o),K.on("page:track",et),K.init(),K.disableGestures(),Tt(),document.documentElement.classList.add(c),p.on(window,"keydown",B),p.on(document,"navigate",$)},Tt=function(){var e;return S="x"===nt.get("transition.axis"),S||(S="snap"===nt.get("transition.type")),e={width:window.innerWidth,height:window.innerHeight},vt&&Math.max(e.width,e.height)<640&&(S=e.width>e.height),S?("function"==typeof K.setAxis&&K.setAxis("x"),st.classList.add("horizontal")):("function"==typeof K.setAxis&&K.setAxis("y"),st.classList.remove("horizontal"))},$=function(e){var t;return yt("navigate",{url:e.url}),t=function(){var t,n;return n=document.createElement("a"),n.href=e.url,n.setAttribute("target","_blank"),t=p.create("click"),u.append(n),n.dispatchEvent(t),u.remove(n)},setTimeout(t,100)},r=function(e){return st.classList.add("transitioning"),0===e.index?dt.hide():0!==e.prevIndex&&(dt.show(),dt.select(e.index)),C()},J=function(e){return bt.gaTrackEvent("pageFlip","pageFlip"),yt("pageflip",{page_number:e.index}),st.classList.remove("transitioning"),0===e.index?st.classList.add("showing-cover"):st.classList.remove("showing-cover"),0===e.prevIndex&&e.index>0&&(dt.select(e.index),dt.show()),xt(),it()},o=function(){return _?scrollTo(0,0):void 0},et=function(e){return P?e.x<=window.innerWidth?st.classList.add("cover-reveal"):st.classList.remove("cover-reveal"):void 0},_t=function(e,t){return null==e&&(e=[]),null==t&&(t=[]),G(e,t,!0),D=D.concat(e),Y=Y.concat(t),X()},gt=function(){var e;return e=!g.isFetching(),e=e&&D.length<100,e=e&&K.selectedIndex>=q()-5},xt=function(){var e;if(gt())return e=function(e){var t,n,i;return Z=e.pageKey,t=null!=(i=e.items)?i:[],t.length>0?(n=[],_t(t,n)):void 0},g.load(l,Z,30).then(function(t){return K.transitioning?K.once("page:change",e.bind(null,t)):e(t)})},W=function(){var e,t;return(t=null!=ct?ct.socialId:void 0)?(e={path:"/api/social/activity",params:{oid:t,defaultUser:!0}},E.get(e).then(V)):(console.warn("Couldn't find social ID in feed",g),void 0)},tt=[],T=function(e){return tt[e]},q=function(){return tt.length},c=null,G=function(e,t,n){var i,r,o,s,a,l,p;if(null==n&&(n=!0),p=st.getBoundingClientRect(),l=p.width,r=p.height,K.disableGestures(),i=U.arrayCopy(tt),!n){for(i=[tt.shift()];tt.length>0;)u.remove(tt[0]),tt.shift();c=null}return P&&(ct.title=null),c=d.layoutItems(ct,e,t,st,l,r,c,!gt()),A.process(),s=u.all(".page",st).filter(function(e){return-1===i.indexOf(e)}),tt=i.concat(s),o=U.clamp(K.selectedIndex,0,tt.length-1),K.selectedIndex=o,K.updatePages(),a=!0,a&&K.enableGestures(),it()},j=function(e){var t,n;return t=document.querySelector("ul.metrics"),n=e.map(function(e){return"<li>"+e+"</li>"}),u.setInnerHTML(t,n.join("")+t.innerHTML),t.classList.remove("loading")},b=function(){var e,t;return t=T(0),t.parentNode||(st.appendChild(t),e=!0),y.process(t),t.classList.remove("fitting"),e?u.remove(t):void 0},it=function(){var e,t,n,i,r,o,s;for(i=K.selectedIndex,e=q(),t=[T(i)],e-1>i&&t.push(T(i+1)),i>0&&t.push(T(i-1)),s=[],r=0,o=t.length;o>r;r++)n=t[r],s.push(d.refinePage(n));return s},X=function(){var e;return void 0===dt&&(dt=new i(st,S),dt.on("scrub:start",ut),dt.on("scrub:change",at),dt.on("scrub:end",lt)),dt.selectedIndex=K.selectedIndex,e=tt.map(function(){return{date:Date.now()}}),dt.setPages(e)},ut=function(){return st.classList.add("scrubbing")},at=function(e){var t;return t=e.index,t!==K.selectedIndex?K.select(t,!1):void 0},lt=function(){return st.classList.remove("scrubbing")},mt=!1,w=void 0,wt=function(){return mt||K.transitioning?void 0:(clearTimeout(w),w=void 0,st.classList.add("showing-arrows"))},C=function(){return st.classList.remove("showing-arrows")},L=function(e){var t,n;return e.node.classList.contains("cover-image")?(t=null!=(n=u.one(".page.cover"))?n:tt[0],t.classList.remove("loading"),st.classList.remove("loading")):void 0},h=function(){var e;return e=function(){var e,t,n;return(e=T(0))?(null!=(t=u.one(".featured",e))&&t.classList.remove("loading"),null!=(n=u.one(".also",e))&&n.classList.remove("loading"),b()):void 0},setTimeout(e,100)},V=function(e){var t,n;return t=null!=(n=e.items)?n[0].metrics:void 0,t?j(t):void 0},It=function(e){return S&&(e.clientX<=150||e.clientX>=window.innerWidth-150)?wt():!S&&(e.clientY<=150||e.clientY>=window.innerHeight-150)?wt():void 0===w?w=setTimeout(C,1e3):void 0},ft=function(e){var t,n;return n=e.target.tagName.toLowerCase(),t=-1===["input","textarea","select"].indexOf(n)},B=function(e){var t,n;if(ft(e))switch(e.keyCode){case 32:return P&&e.preventDefault(),e.shiftKey?K.prev():K.next();case 40:if(!S)return K.next(!e.shiftKey);break;case 38:if(!S)return K.prev(!e.shiftKey);break;case 37:if(P&&e.preventDefault(),S)return K.prev(!e.shiftKey);break;case 39:if(P&&e.preventDefault(),S)return K.next(!e.shiftKey);break;case 74:return K.next(!1);case 75:return K.prev(!1);case 33:return K.prev(!e.shiftKey);case 34:return K.next(!e.shiftKey);default:if(48<=(n=e.keyCode)&&57>=n)return t=e.keyCode-49,48===e.keyCode&&(t=9),K.select(t,!0)}},x=function(e){return e.target.classList.contains("lower")?K.next():K.prev()},ot=void 0,rt=void 0,H=void 0,s=function(){var e,t;return t=T(K.selectedIndex),t.classList.contains("cover")?void 0:(e=t.getBoundingClientRect(),H=t.querySelector("[data-fl-item-id]").getAttribute("data-fl-item-id"),t.style.top="50%",t.style.left="50%",t.style.marginTop="-"+e.height/2+"px",t.style.marginLeft="-"+e.width/2+"px",rt=t,st.classList.add("resizing"))},v=function(){var e,t,n,i,r,o,s,a,l,u;if(rt){for(u=["top","left","margin-top","margin-bottom"],o=0,a=u.length;a>o;o++)r=u[o],rt.style.removeProperty(r);st.classList.remove("resizing"),rt=void 0,b()}if(G(D,Y,!1),H){for(e=s=0,l=tt.length;l>s;e=++s)n=tt[e],t='[data-fl-item-id="'+H+'"]',n.querySelector(t)&&e!==K.selectedIndex&&(i=e,K.selectedIndex=i,K.updatePages());H=void 0}return it(),X()},kt=function(){return clearTimeout(ot),ot=setTimeout(v,150),void 0===rt?(s(),b()):void 0},t.initFeed=M,t.init=F}),require.define("models/page",function(e,t){var n,i;i=require("blend/dom"),n=function(){function e(e,t,n){var r,o;this.itemClass="."+n,this.container="string"==typeof e?i.one(e):e,this.tray="string"==typeof t?i.one(t):t,this.pageClass=this.tray.className.replace(/^\./,""),this.pages=[],r=i.one(this.itemClass,this.tray),o=getComputedStyle(r),this.magazineWidth=r.getBoundingClientRect().width+parseInt(o.marginRight,10)}return e}(),n.prototype.paginate=function(){var e,t,n,r,o,s,a,l,u;for(s=this.container.getBoundingClientRect().width,r=Math.floor(s/this.magazineWidth),n=i.all(this.itemClass,this.container),i.setInnerHTML(this.container,""),this.pages=[],u=[],e=a=0,l=n.length;l>a;e=++a)t=n[e],0===e%r&&(o=document.createElement("div"),o.className=this.pageClass,this.container.appendChild(o),this.pages.push(o)),u.push(o.appendChild(t));return u},n.prototype.getPage=function(e){return this.pages[e]},n.prototype.getCount=function(){return this.pages.length},t.HorizontalTrayPage=n}),require.define("profile",function(e,t){var n,i,r,o,s,a,l,u,d,c,p;n=require("blend/animator"),i=require("blend/dom"),r=require("blend/events"),s=require("landingPage"),a=require("blend/lang"),u=require("pageControllers"),l=require("models/page"),p=require("lib/urls"),c=require("shareButton"),o=function(){var e;return d(i.parseDataNode("magazine-data")),e=i.parseDataNode("profile-data"),s.initFeed(e),c.init(".share-button",e,i.parseDataNode("section-cover-data"),!0)},d=function(e){var t,n,o,s,a,d,c,h,f,g,m,v,y,b,x,w,_,T,q,I;for(T=[i.one(".magazines-container"),i.one(".magazines")],n=T[0],b=T[1],v="magazine",a=[],d=w=0,_=e.length;_>w;d=++w)c=e[d],(null!=(q=c.image)?q.smallURL:void 0)&&a.push('<div class="'+v+'" style="background-image:url('+c.image.smallURL+');">\n    <h1>'+c.title+'</h1>\n    <a href="'+p.sectionFromData(c)+'" target="_blank" class="click-fill"> </a>\n</div>');return i.setInnerHTML(b,a.join(" ")),f=new l.HorizontalTrayPage(n,b,v),r.on(window,"resize",function(){return f.paginate(),x()}),f.paginate(),o=new u.Slide(n,{getPage:function(e){return f.getPage(e)},getCount:function(){return f.getCount()},pageMargin:20,axis:"x",mouseInput:!0}),o.init(),I=function(){var e,n,r,o;for(r=[".magnav-prev",".magnav-next",".magazines-section h1"],o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(i.one(t));return o}(),g=I[0],h=I[1],y=I[2],m=function(e){return e.style.visibility="visible"},s=function(e){return e.style.visibility="hidden"},x=function(){var e,t,n;return n=[o.selectedIndex,o.count()-1],e=n[0],t=n[1],0===e?(s(g),m(y)):(m(g),s(y)),e===t?s(h):m(h)},o.on("page:change",x),x(),r.on(".magnav-prev","tap",function(){return o.prev()}),r.on(".magnav-next","tap",function(){return o.next()})},t.init=o}),require.define("landingPageTabs",function(e,t){var n,i,r;i=require("blend/events"),r=function(e){var t,n,i,r,o;for(r=document.querySelectorAll(e),o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(t.style.display="none");return o},n=function(e){var t,n;return r(".section, .users"),t=e.getAttribute("href"),t=t.split("#")[1],null!=(n=document.getElementById(t))?n.style.display="block":void 0},t.init=function(){var e,t,i,o,s;for(r(".section"),t=document.querySelectorAll(".nav ul li a"),s=[],i=0,o=t.length;o>i;i++)e=t[i],s.push(e.onclick=function(){return n(this)});return s}}),require.define("landingPageLoader",function(){var e,t,n,i,r,o;e=require("blend/dom"),n=require("ui/flipui"),i=require("blend/i18n"),r=require("landingPage"),o=require("profile"),i.load(),t=document.getElementById("main"),t&&(/landing-page/.test(t.className)?r.init():/profile/.test(t.className)?o.init():/flip/.test(t.className)?n.init():/lists/.test(t.className)&&require("landingPageTabs").init())});